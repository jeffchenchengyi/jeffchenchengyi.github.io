
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HW 9 &#8212; ΨΦ</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/default.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://jeffchenchengyi.github.io/course-work/ise-530/hw9.html" />
    <link rel="shortcut icon" href="../../_static/jeffchenchengyi2019.jpg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Midterm" href="midterm.html" />
    <link rel="prev" title="HW 8" href="hw8.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://jeffchenchengyi.github.io/course-work/ise-530/hw9.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="HW 9" />
<meta property="og:description" content="HW 9  ISE 530 Optimization for Analytics Homework IX: Integer Programming. Due 11:59 PM Tuesday November 24, 2020  You, as the leader of an oil exploration dril" />
<meta property="og:image"       content="https://jeffchenchengyi.github.io/_static/jeffchenchengyi2019.jpg" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/jeffchenchengyi2019.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">ΨΦ</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Machine-Learning
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../machine-learning/00-intro.html">
   Machine Learning
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/01-linear-algebra.html">
     1. Linear Algebra [In Progress]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/02-probability-distributions.html">
     2. Probability Distributions [Empty]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/03-linear-models-for-regression.html">
     3. Linear Models for Regression [Empty]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/04-linear-models-for-classification.html">
     4. Linear Models for Classification [Empty]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/05-neural-networks.html">
     5. Neural Networks [Empty]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/06-kernel-methods.html">
     6. Kernel Methods [Empty]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/07-sparse-kernel-machines.html">
     7. Sparse Kernel Machines [Empty]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/08-graphical-models.html">
     8. Graphical Models [Empty]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/09-mixture-models-and-em.html">
     9. Mixture Models and EM [In Progress]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/10-approximate-inference.html">
     10. Approximate Inference [In Progress]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/11-sampling-methods.html">
     11. Sampling Methods [Empty]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/12-continuous-latent-variables.html">
     12. Continuous Latent Variables [In Progress]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/13-sequential-data.html">
     13. Sequential Data [Empty]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/14-combining-models.html">
     14. Combining Models [Empty]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../machine-learning/15-bandits.html">
     15. Bandits [In Progress]
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Featured Course Work &amp; Extra-curriculars
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../ise-562/intro.html">
   ISE-562 Decision Analysis
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-562/lab_assignment.html">
     Certain Equivalents and Sensitivity Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-562/midterm.html">
     Mid Term Part (2): Individual Assignment: Tornado Diagrams and Bidding
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../ise-533/intro.html">
   ISE-533 Integrative Analytics
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-533/hw1.html">
     HW 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-533/hw2.html">
     HW 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-533/project1.html">
     Project 1: Group Restaurants Choice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-533/project2.html">
     Project 2: Multi-location Transshipment Problem
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../ise-537/intro.html">
   ISE-537 Financial Analytics
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-537/hw1.html">
     HW 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-537/hw2_part1.html">
     HW 2 Part 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-537/hw2_part2.html">
     HW 2 Part 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-537/hw3.html">
     HW 3
    </a>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../ise-537/market-observations.html">
     Market Observations
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/market-observations-week-1.html">
       MO 1: TSLA Absurd P/E Ratio
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/market-observations-week-2.html">
       MO 2: The NASDAQ Whale
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/market-observations-week-3.html">
       MO 4: Dovish till 2024
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/market-observations-week-4.html">
       MO 4: The Future of EV batteries
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/market-observations-week-5.html">
       MO 5: Palantir
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../ise-537/paper-reviews.html">
     Paper Reviews
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/paper-review-1.html">
       Paper Review 1: Value and Momentum Everywhere
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/paper-review-2.html">
       Paper Review 2: Carry
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/paper-review-3.html">
       Paper Review 3: Quality Minus Junk
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/paper-review-4.html">
       Paper Review 4: Size Matters, if You Control Your Junk
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/paper-review-5.html">
       Paper Review 5: The Low-Risk Anomaly: A Decomposition into Micro and Macro Effects
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-537/project1.html">
     Project 1: Momentum Strategies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-537/project2.html">
     Project 2: Carry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-537/notes.html">
     Notes
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="intro.html">
   ISE-530 Optimization Analytics
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="hw1.html">
     HW 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw2.html">
     HW 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw3.html">
     HW 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw4.html">
     HW 4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw5.html">
     HW 5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw6.html">
     HW 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw7.html">
     HW 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw8.html">
     HW 8
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     HW 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="midterm.html">
     Midterm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="final.html">
     Final
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="notes.html">
     Summary
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../csci-499/intro.html">
   CSCI-499 AI for Social Good
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../csci-499/paper-reviews.html">
     Paper Reviews
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-1.html">
       Paper Review 1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-2.html">
       Paper Review 2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-3.html">
       Paper Review 3
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-4.html">
       Paper Review 4
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-5.html">
       Paper Review 5
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-6.html">
       Paper Review 6
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-7.html">
       Paper Review 7
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-8.html">
       Paper Review 8
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://docs.google.com/presentation/d/1MqA1jPrUw2UUTnQBGHqH-_Y3FCcOgsUGoCG1LNnCvZY/edit?usp=sharing">
     Paper Review Presentation
     <i class="fas fa-external-link-alt">
     </i>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://github.com/lucashu1/education-deserts">
     Education Deserts Research
     <i class="fas fa-external-link-alt">
     </i>
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../cais%2B%2B/intro.html">
   CAIS++
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference external" href="https://github.com/pelillian/varro">
     Evolving FPGAs for Accelerated MachineLearning on Bare Metal
     <i class="fas fa-external-link-alt">
     </i>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://github.com/usc-caisplusplus/SLAB">
     OCR Research on Google Street View Panoramics
     <i class="fas fa-external-link-alt">
     </i>
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../udacity/exploring-house-prices-singapore-part-3-crispdm.html">
   Udacity Data Scientist Nanodegree - Exploring House Prices in Singapore
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://graduation.udacity.com/confirm/2LGCCKNA">
   Udacity Data Scientist Nanodegree Certificate
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://drive.google.com/file/d/13GaYnn520MGQtO4PfYjP4W6KFqyyI10T/view?usp=sharing">
   Chengyi (Jeff) Chen's Resume
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/jeffchenchengyi/jeffchenchengyi.github.io">
   GitHub Repo
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/course-work/ise-530/hw9.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/jeffchenchengyi/jeffchenchengyi.github.io"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="hw-9">
<h1>HW 9<a class="headerlink" href="#hw-9" title="Permalink to this headline">¶</a></h1>
<p>ISE 530 Optimization for Analytics Homework IX: Integer Programming. Due 11:59 PM Tuesday November 24, 2020</p>
<ul class="simple">
<li><p>You, as the leader of an oil exploration drilling venture, must determine the best selection of five out of ten possible sites. Label the sites as <span class="math notranslate nohighlight">\(s_1, s_2, \cdots , s_{10}\)</span> and the expected profits associated with each as <span class="math notranslate nohighlight">\(p_1, p_2, \cdots , p_{10}\)</span>.</p>
<ul>
<li><p>If site <span class="math notranslate nohighlight">\(s_2\)</span> is explored, then site <span class="math notranslate nohighlight">\(s_3\)</span> must also be explored.</p></li>
<li><p>Exploring sites <span class="math notranslate nohighlight">\(s_1\)</span> and <span class="math notranslate nohighlight">\(s_7\)</span> will disallow the exploration of site s8.</p></li>
<li><p>Exploring sites <span class="math notranslate nohighlight">\(s_3\)</span> or <span class="math notranslate nohighlight">\(s_4\)</span> will disallow the exploration of site <span class="math notranslate nohighlight">\(s_5\)</span>.</p></li>
</ul>
</li>
<li><p>You have \<span class="math notranslate nohighlight">\(14,000 to invest among four different investment opportunities. Investment 1 requires an investment of \\\)</span>7,000 and has a net present value of \<span class="math notranslate nohighlight">\(11,000; investment 2 requires an investment
of \\\)</span>5,000 and has a net present value of \<span class="math notranslate nohighlight">\(8,000; investment 3 requires an investment of \\\)</span>4,000 and 4 has a net present value of \<span class="math notranslate nohighlight">\(6,000; investment 4 requires an investment of \\\)</span>3,000 and has a net
present value of \$4,000. These are all “take it or leave it” opportunities and you are not allowed to invest partially in any of the projects. The objective is to maximize the total value given
the budget constraint. Formulate this problem as a binary integer program and solve it by the branch-and-bound technique.</p></li>
<li><p>Solve the following two integer programs by the branch-and-bound algorithm:</p></li>
</ul>
<ol class="simple">
<li></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-2c1f03fa-8fa0-4d83-b12d-32e6698bd97f">
<span class="eqno">(421)<a class="headerlink" href="#equation-2c1f03fa-8fa0-4d83-b12d-32e6698bd97f" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \underset{x \geq 0 \text{ integer }}{\text{maximize }}\qquad&amp;2x_1 + x_2 \\
    \text{subject to }\qquad&amp;x_1 + x_2 \leq 5 \\
    &amp;x_2 - x_1 \leq 0 \\
    \text{and }\qquad&amp;6x_1 + 2x_2 \leq 21. \\
\end{align}\]</div>
<ol class="simple">
<li></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-92dcc140-05c7-4af7-9912-e051304334d4">
<span class="eqno">(422)<a class="headerlink" href="#equation-92dcc140-05c7-4af7-9912-e051304334d4" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \underset{x \geq 0 \text{ integer }}{\text{maximize }}\qquad&amp;2x_1 + x_2 + 4x_3 + 5x_4 \\
    \text{subject to }\qquad&amp;x_1 + 3x_2 + 2x_3 + 5x_4 \leq 10 \\
    \text{and }\qquad&amp;3x_1 - x_2 - 5x_3 + 10x_4 \leq -4. \\
\end{align}\]</div>
<ul class="simple">
<li><p>Consider the integer programming problem:</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-58ba915b-4caf-4ee3-af9a-22cd93de9f7c">
<span class="eqno">(423)<a class="headerlink" href="#equation-58ba915b-4caf-4ee3-af9a-22cd93de9f7c" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \underset{x}{\text{maximize }}\qquad&amp;x_1 + x_2 \\
    \text{subject to }\qquad&amp;-3x_1 + 4x_2 \leq 4 \\
    &amp;3x_1 + 2x_2 \leq 11 \\
    &amp;2x_1 - x_2 \leq 5 \\
    \text{and }\qquad&amp;x_1, x_2 \geq 0 \text{ and integer}. \\
\end{align}\]</div>
<p>Use a figure to answer the following questions.</p>
<p>(a) What is the optimal objective value of the linear programming relaxation? What is the optimal objective value of the integer program?</p>
<p>(b) What is the convex hull of the set of all feasible solution to the integer program?</p>
<p>(c) Construct a Gomory cutting plane using the optimal linear programming solution.</p>
<p>(d) Starting with the optimal linear programming solution, solve the integer program using the branch-and-bound method.</p>
<p>(e) Suppose you relax the first constraint. What is the optimal value <span class="math notranslate nohighlight">\(Z_{\text{dual}}\)</span> of the Lagrangian dual?</p>
<p>(f) Repeat part (e) by relaxing the third constraint.</p>
<ul class="simple">
<li><p>Consider the integer program:</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-edb92322-596c-46c1-a966-fdaa5499e0c5">
<span class="eqno">(424)<a class="headerlink" href="#equation-edb92322-596c-46c1-a966-fdaa5499e0c5" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \underset{x}{\text{maximize }}\qquad&amp;x_1 + 2x_2 \\
    \text{subject to }\qquad&amp;x_1 + x_2 \leq 5 \\
    &amp;x_1 - 3x_2 \leq -4 \\
    &amp;x_1 \geq 1 \\
    &amp;x_1 - x_2 \leq 0 \\
    \text{and }\qquad&amp;x_1, x_2 \geq 0 \text{ and integer}. \\
\end{align}\]</div>
<p>(a) Construct the convex hull of the feasible integer solutions and derive an optimal solution graphically.</p>
<p>(b) Solve the linear program relaxation.</p>
<p>(c) Solve by Lagrangian relaxation of the first constraint.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autotime
<span class="o">%</span><span class="k">load_ext</span> nb_black
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">from</span> <span class="nn">graphviz</span> <span class="kn">import</span> <span class="n">Digraph</span>
<span class="kn">import</span> <span class="nn">dot2tex</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Latex</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">re</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 1;
                var nbb_unformatted_code = "%load_ext autotime\n%load_ext nb_black\n%matplotlib inline\n\nimport matplotlib.pyplot as plt\nfrom mpl_toolkits.mplot3d import Axes3D\n\nplt.rcParams[\"figure.dpi\"] = 300\nplt.rcParams[\"figure.figsize\"] = (16, 12)\n\nimport operator\nimport pandas as pd\nimport numpy as np\nimport cvxpy as cp\nimport scipy as sp\nfrom graphviz import Digraph\nimport dot2tex\nfrom IPython.display import Latex\nfrom sympy import *\nimport re";
                var nbb_formatted_code = "%load_ext autotime\n%load_ext nb_black\n%matplotlib inline\n\nimport matplotlib.pyplot as plt\nfrom mpl_toolkits.mplot3d import Axes3D\n\nplt.rcParams[\"figure.dpi\"] = 300\nplt.rcParams[\"figure.figsize\"] = (16, 12)\n\nimport operator\nimport pandas as pd\nimport numpy as np\nimport cvxpy as cp\nimport scipy as sp\nfrom graphviz import Digraph\nimport dot2tex\nfrom IPython.display import Latex\nfrom sympy import *\nimport re";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<hr class="docutils" />
<ul class="simple">
<li><p>You, as the leader of an oil exploration drilling venture, must determine the best selection of five out of ten possible sites. Label the sites as <span class="math notranslate nohighlight">\(s_1, s_2, \cdots , s_{10}\)</span> and the expected profits associated with each as <span class="math notranslate nohighlight">\(p_1, p_2, \cdots , p_{10}\)</span>.</p>
<ul>
<li><p>If site <span class="math notranslate nohighlight">\(s_2\)</span> is explored, then site <span class="math notranslate nohighlight">\(s_3\)</span> must also be explored.</p></li>
<li><p>Exploring sites <span class="math notranslate nohighlight">\(s_1\)</span> and <span class="math notranslate nohighlight">\(s_7\)</span> will disallow the exploration of site <span class="math notranslate nohighlight">\(s_8\)</span>.</p></li>
<li><p>Exploring sites <span class="math notranslate nohighlight">\(s_3\)</span> or <span class="math notranslate nohighlight">\(s_4\)</span> will disallow the exploration of site <span class="math notranslate nohighlight">\(s_5\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-7341461d-2e5b-400f-b0b7-8df841b897d2">
<span class="eqno">(425)<a class="headerlink" href="#equation-7341461d-2e5b-400f-b0b7-8df841b897d2" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \underset{s_i \in \{0, 1\}\,\,\forall\,\,i \in 1,\cdots,10}{\text{maximize }}\qquad&amp;p_{1}s_{1} + p_{2}s_{2} + p_{3}s_{3} + p_{4}s_{4} + p_{5}s_{5} + p_{6}s_{6} + p_{7}s_{7} + p_{8}s_{8} + p_{9}s_{9} + p_{10}s_{10} \\
    \text{subject to }\qquad
    &amp;s_{1} + s_{2} + s_{3} + s_{4} + s_{5} + s_{6} + s_{7} + s_{8} + s_{9} + s_{10} \leq 5 \\
    &amp;s_{2} - s_{3} \leq 0 \\
    &amp;s_{1} + s_{7} +s_{8} \leq 2 \\
    &amp;s_{3} + s_{5} \leq 1 \\
    &amp;s_{4} + s_{5} \leq 1 \\
\end{align}\]</div>
<ul class="simple">
<li><p>You have \<span class="math notranslate nohighlight">\(14,000 to invest among four different investment opportunities. Investment 1 requires an investment of \\\)</span>7,000 and has a net present value of \<span class="math notranslate nohighlight">\(11,000; investment 2 requires an investment
of \\\)</span>5,000 and has a net present value of \<span class="math notranslate nohighlight">\(8,000; investment 3 requires an investment of \\\)</span>4,000 and has a net present value of \<span class="math notranslate nohighlight">\(6,000; investment 4 requires an investment of \\\)</span>3,000 and has a net
present value of \$4,000. These are all “take it or leave it” opportunities and you are not allowed to invest partially in any of the projects. The objective is to maximize the total value given
the budget constraint. Formulate this problem as a binary integer program and solve it by the branch-and-bound technique.</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-33dce23a-743b-4ba9-b5ee-15b62dbd2ed9">
<span class="eqno">(426)<a class="headerlink" href="#equation-33dce23a-743b-4ba9-b5ee-15b62dbd2ed9" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \underset{x_i \in \{0, 1\}\,\,\forall\,\,i \in 1,\cdots,4}{\text{maximize }}\qquad&amp;11x_{1} + 8x_{2} + 6x_{3} + 4x_{4} \\
    \text{subject to }\qquad
    &amp;7x_{1} + 5x_{2} + 4x_{3} + 3x_{4} \leq 14 \\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Converts the optimization problem parameters into the mathematical representation</span>
<span class="k">def</span> <span class="nf">solve_lp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">constraints</span><span class="p">,</span> <span class="n">obj_coeff</span><span class="p">,</span> <span class="n">problem_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Solves the standard LP maximization problem and creates the </span>
<span class="sd">    mathematical formulation of optimization label for graphviz</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">obj_coeff</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

    <span class="n">label</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">problem_type</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;x&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obj_coeff</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))])</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">subject to: </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
                        <span class="sa">r</span><span class="s2">&quot;x\[([0-9]*)\]&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;x&quot;</span>
                        <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
                            <span class="nb">int</span><span class="p">(</span>
                                <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                                    <span class="sa">r</span><span class="s2">&quot;\[[0-9]*\]&quot;</span><span class="p">,</span>
                                    <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;var[0-9]*&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">constraint</span><span class="p">)),</span>
                                <span class="p">)</span>
                                <span class="o">.</span><span class="n">group</span><span class="p">()</span>
                                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                            <span class="p">)</span>
                            <span class="o">+</span> <span class="mi">1</span>
                        <span class="p">),</span>
                        <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;var[0-9]*&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">constraint</span><span class="p">)),</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                        <span class="sa">r</span><span class="s2">&quot;x\[([0-9]*)\]&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;var[0-9]*&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">constraint</span><span class="p">))</span>
                    <span class="p">)</span>
                    <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="k">else</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;var[0-9]*&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">constraint</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">constraint</span> <span class="ow">in</span> <span class="n">constraints</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="o">+</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Objective Value: &quot;</span>
            <span class="o">+</span> <span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">prob</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;optimal&quot;</span>
                <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Solution: &quot;</span>
            <span class="o">+</span> <span class="p">(</span>
                <span class="nb">str</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">prob</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;optimal&quot;</span>
                <span class="k">else</span> <span class="n">prob</span><span class="o">.</span><span class="n">status</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">label</span><span class="p">,</span> <span class="n">prob</span>


<span class="c1"># Checks if the number is an integer within specified decimal rounding</span>
<span class="n">is_integer</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">decimals</span><span class="p">)</span><span class="o">.</span><span class="n">is_integer</span><span class="p">()</span>

<span class="c1"># Checks if all elements in array are integers</span>
<span class="n">is_integer_solution</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">([</span><span class="n">is_integer</span><span class="p">(</span><span class="n">x_i</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">branch_and_bound_dfs</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">constraints</span><span class="p">,</span> <span class="n">obj_coeff</span><span class="p">,</span> <span class="n">problem_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Iterative DFS traversal of branch and bound tree&quot;&quot;&quot;</span>

    <span class="n">node_id</span> <span class="o">=</span> <span class="s2">&quot;root&quot;</span>  <span class="c1"># ID to map the node of branch and bound tree to the constraints</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">[]</span>
    <span class="p">)</span>  <span class="c1"># To simulate depth first traversal by appending onto stack the node&#39;s children</span>
    <span class="n">node_constraints</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">{}</span>
    <span class="p">)</span>  <span class="c1"># A map of the node_id to constraints associated with the node</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># A list to keep the nodes already visited</span>

    <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">node_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="n">node_constraints</span><span class="p">[</span><span class="n">node_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">constraints</span>

    <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>  <span class="c1"># Lower bound and upper bound of ILP</span>

    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

        <span class="c1"># Visit node</span>
        <span class="n">node_id</span><span class="p">,</span> <span class="n">parent_node_id</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">visited</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span>

        <span class="c1"># Process Root</span>
        <span class="n">label</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">solve_lp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">node_constraints</span><span class="p">[</span><span class="n">node_id</span><span class="p">],</span> <span class="n">obj_coeff</span><span class="p">,</span> <span class="n">problem_type</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">node_id</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

        <span class="c1"># Add Edge</span>
        <span class="k">if</span> <span class="n">node_id</span> <span class="o">!=</span> <span class="s2">&quot;root&quot;</span><span class="p">:</span>
            <span class="n">root</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span>
                <span class="n">tail_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">parent_node_id</span><span class="p">),</span>
                <span class="n">head_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">node_id</span><span class="p">),</span>
                <span class="n">label</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
                    <span class="sa">r</span><span class="s2">&quot;x\[([0-9]*)\]&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;x&quot;</span>
                    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
                        <span class="nb">int</span><span class="p">(</span>
                            <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
                                <span class="sa">r</span><span class="s2">&quot;\[[0-9]*\]&quot;</span><span class="p">,</span>
                                <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
                                    <span class="sa">r</span><span class="s2">&quot;var[0-9]*&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;x&quot;</span><span class="p">,</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="n">node_constraints</span><span class="p">[</span><span class="n">node_id</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                                <span class="p">),</span>
                            <span class="p">)</span>
                            <span class="o">.</span><span class="n">group</span><span class="p">()</span>
                            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="p">)</span>
                        <span class="o">+</span> <span class="mi">1</span>
                    <span class="p">),</span>
                    <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;var[0-9]*&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">node_constraints</span><span class="p">[</span><span class="n">node_id</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])),</span>
                <span class="p">),</span>
                <span class="nb">len</span><span class="o">=</span><span class="s2">&quot;5&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">prob</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;optimal&quot;</span><span class="p">:</span>

            <span class="c1"># If current solution is integer</span>
            <span class="n">is_integer_current_solution</span> <span class="o">=</span> <span class="n">is_integer_solution</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">primal_vars</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="p">)</span>

            <span class="c1"># Break Conditions</span>
            <span class="k">if</span> <span class="n">is_integer_current_solution</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">ub</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">ub</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
            <span class="p">):</span>  <span class="c1"># Optimal Integer solution found</span>
                <span class="k">return</span> <span class="n">root</span><span class="p">,</span> <span class="n">prob</span>

            <span class="c1"># Set lower bound of the ilp</span>
            <span class="k">if</span> <span class="n">is_integer_current_solution</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">lb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="n">lb</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">lb</span> <span class="o">=</span> <span class="n">prob</span>

            <span class="c1"># Set upper bound of the ilp</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ub</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="n">ub</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
                <span class="n">ub</span> <span class="o">=</span> <span class="n">prob</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">prob</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="n">lb</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="n">lb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">True</span>
            <span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_integer_current_solution</span><span class="p">:</span>

                <span class="c1"># Find non-integer value of solution</span>
                <span class="n">largest_nonint_idx</span><span class="p">,</span> <span class="n">largest_nonint_val</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">x_i</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">variables</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">x_i</span><span class="p">)</span>
                    <span class="p">],</span>
                    <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

                <span class="c1"># Add left and right children nodes for processing</span>
                <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">node_id</span> <span class="o">+</span> <span class="s2">&quot; -&gt; left&quot;</span><span class="p">,</span> <span class="n">node_id</span><span class="p">))</span>
                <span class="n">node_constraints</span><span class="p">[</span><span class="n">node_id</span> <span class="o">+</span> <span class="s2">&quot; -&gt; left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">node_constraints</span><span class="p">[</span><span class="n">node_id</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
                    <span class="n">x</span><span class="p">[</span><span class="n">largest_nonint_idx</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">largest_nonint_val</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">node_id</span> <span class="o">+</span> <span class="s2">&quot; -&gt; right&quot;</span><span class="p">,</span> <span class="n">node_id</span><span class="p">))</span>
                <span class="n">node_constraints</span><span class="p">[</span><span class="n">node_id</span> <span class="o">+</span> <span class="s2">&quot; -&gt; right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">node_constraints</span><span class="p">[</span><span class="n">node_id</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
                    <span class="n">x</span><span class="p">[</span><span class="n">largest_nonint_idx</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">largest_nonint_val</span><span class="p">)</span>
                <span class="p">]</span>

    <span class="k">return</span> <span class="n">root</span><span class="p">,</span> <span class="n">lb</span>


<span class="k">def</span> <span class="nf">branch_and_bound_ilp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">constraints</span><span class="p">,</span> <span class="n">obj_coeff</span><span class="p">,</span> <span class="n">problem_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Solves Pure Integer Linear Program using</span>
<span class="sd">    Branch and Bound method.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        x (cvxpy.Variable): The integer variables in our problem</span>
<span class="sd">        constraints (List[Inequality]): List of inequality constraints to impose on problem</span>
<span class="sd">        obj_coeff (numpy.array): The objective coefficients for a linear program</span>
<span class="sd">        problem_type (str): Either min, or max (default - min)</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">problem_type</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">problem_type</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">),</span> <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;problem_type must be either `min` or `max`.&quot;</span>
    <span class="p">)</span>
    <span class="c1"># Standardize the optimization problem to be maximization</span>
    <span class="k">if</span> <span class="n">problem_type</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
        <span class="n">obj_coeff</span> <span class="o">=</span> <span class="o">-</span><span class="n">obj_coeff</span>

    <span class="c1"># Run the recursive depth-first branch and bound algo</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Branch and Bound Tree&quot;</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;btree.gv&quot;</span><span class="p">,</span>
        <span class="n">node_attr</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="s2">&quot;record&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="s2">&quot;.1&quot;</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="n">root</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="s2">&quot;node&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">branch_and_bound_dfs</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">constraints</span><span class="p">,</span> <span class="n">obj_coeff</span><span class="p">,</span> <span class="n">problem_type</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Optimal Objective Value: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2"> | Integer Solution: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">primal_vars</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">root</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\n\nBranch and Bound Tree&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;20&quot;</span><span class="p">)</span>

    <span class="n">display</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 8.97 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 2;
                var nbb_unformatted_code = "# Converts the optimization problem parameters into the mathematical representation\ndef solve_lp(x, constraints, obj_coeff, problem_type):\n    \"\"\"Solves the standard LP maximization problem and creates the \n    mathematical formulation of optimization label for graphviz\n    \"\"\"\n    obj = cp.Maximize(obj_coeff @ x)\n    prob = cp.Problem(obj, constraints)\n    prob.solve()\n\n    label = (\n        f\"{problem_type} {' + '.join([str(coeff) + 'x' + str(i+1) for coeff, i in zip(obj_coeff, range(x.shape[0]))])} \"\n        + \"\\nsubject to: \\n\"\n        + \"{}\".format(\n            \"\\n\".join(\n                [\n                    re.sub(\n                        r\"x\\[([0-9]*)\\]\",\n                        \"x\"\n                        + str(\n                            int(\n                                re.search(\n                                    r\"\\[[0-9]*\\]\",\n                                    re.sub(r\"var[0-9]*\", \"x\", str(constraint)),\n                                )\n                                .group()\n                                .replace(\"]\", \"\")\n                                .replace(\"[\", \"\")\n                            )\n                            + 1\n                        ),\n                        re.sub(r\"var[0-9]*\", \"x\", str(constraint)),\n                    )\n                    if re.search(\n                        r\"x\\[([0-9]*)\\]\", re.sub(r\"var[0-9]*\", \"x\", str(constraint))\n                    )\n                    is not None\n                    else re.sub(r\"var[0-9]*\", \"x\", str(constraint))\n                    for constraint in constraints\n                ]\n            )\n        )\n        + (\n            \"\\n\\nObjective Value: \"\n            + (\n                str(np.round(prob.value, 2))\n                if prob.status == \"optimal\"\n                else str(prob.value)\n            )\n            + \"\\nSolution: \"\n            + (\n                str([np.round(x_i, 2) for x_i in x.value])\n                if prob.status == \"optimal\"\n                else prob.status\n            )\n        )\n    )\n    return label, prob\n\n\n# Checks if the number is an integer within specified decimal rounding\nis_integer = lambda x, decimals=3: np.round(x, decimals).is_integer()\n\n# Checks if all elements in array are integers\nis_integer_solution = lambda x: np.alltrue([is_integer(x_i) for x_i in x])\n\n\ndef branch_and_bound_dfs(root, x, constraints, obj_coeff, problem_type):\n    \"\"\"Iterative DFS traversal of branch and bound tree\"\"\"\n\n    node_id = \"root\"  # ID to map the node of branch and bound tree to the constraints\n    stack = (\n        []\n    )  # To simulate depth first traversal by appending onto stack the node's children\n    node_constraints = (\n        {}\n    )  # A map of the node_id to constraints associated with the node\n    visited = []  # A list to keep the nodes already visited\n\n    stack.append((node_id, None))\n    node_constraints[node_id] = constraints\n\n    lb, ub = None, None  # Lower bound and upper bound of ILP\n\n    while len(stack) > 0:\n\n        # Visit node\n        node_id, parent_node_id = stack.pop()\n        visited.append(node_id)\n\n        # Process Root\n        label, prob = solve_lp(x, node_constraints[node_id], obj_coeff, problem_type)\n        root.node(name=str(node_id), label=label)\n\n        # Add Edge\n        if node_id != \"root\":\n            root.edge(\n                tail_name=str(parent_node_id),\n                head_name=str(node_id),\n                label=re.sub(\n                    r\"x\\[([0-9]*)\\]\",\n                    \"x\"\n                    + str(\n                        int(\n                            re.search(\n                                r\"\\[[0-9]*\\]\",\n                                re.sub(\n                                    r\"var[0-9]*\",\n                                    \"x\",\n                                    str(node_constraints[node_id][-1]),\n                                ),\n                            )\n                            .group()\n                            .replace(\"]\", \"\")\n                            .replace(\"[\", \"\")\n                        )\n                        + 1\n                    ),\n                    re.sub(r\"var[0-9]*\", \"x\", str(node_constraints[node_id][-1])),\n                ),\n                len=\"5\",\n            )\n\n        if prob.status == \"optimal\":\n\n            # If current solution is integer\n            is_integer_current_solution = is_integer_solution(\n                np.array(list(prob.solution.primal_vars.values())).flatten()\n            )\n\n            # Break Conditions\n            if is_integer_current_solution and (\n                (ub is None) or (prob.value == np.floor(ub.value))\n            ):  # Optimal Integer solution found\n                return root, prob\n\n            # Set lower bound of the ilp\n            if is_integer_current_solution and (\n                (lb is None) or (prob.value > lb.value)\n            ):\n                lb = prob\n\n            # Set upper bound of the ilp\n            if (ub is None) or (prob.value > ub.value):\n                ub = prob\n\n            if (\n                prob.value > lb.value if lb is not None else True\n            ) and not is_integer_current_solution:\n\n                # Find non-integer value of solution\n                largest_nonint_idx, largest_nonint_val = sorted(\n                    [\n                        (idx, x_i)\n                        for idx, x_i in enumerate(prob.variables()[0].value)\n                        if not is_integer(x_i)\n                    ],\n                    key=lambda x: x[1],\n                    reverse=True,\n                )[0]\n\n                # Add left and right children nodes for processing\n                stack.append((node_id + \" -> left\", node_id))\n                node_constraints[node_id + \" -> left\"] = node_constraints[node_id] + [\n                    x[largest_nonint_idx] >= np.ceil(largest_nonint_val)\n                ]\n                stack.append((node_id + \" -> right\", node_id))\n                node_constraints[node_id + \" -> right\"] = node_constraints[node_id] + [\n                    x[largest_nonint_idx] <= np.floor(largest_nonint_val)\n                ]\n\n    return root, lb\n\n\ndef branch_and_bound_ilp(x, constraints, obj_coeff, problem_type):\n    \"\"\"Solves Pure Integer Linear Program using\n    Branch and Bound method.\n    \n    Args:\n        x (cvxpy.Variable): The integer variables in our problem\n        constraints (List[Inequality]): List of inequality constraints to impose on problem\n        obj_coeff (numpy.array): The objective coefficients for a linear program\n        problem_type (str): Either min, or max (default - min)\n        \n    Returns:\n        \n    \n    \"\"\"\n    assert (problem_type == \"min\") or (problem_type == \"max\"), print(\n        \"problem_type must be either `min` or `max`.\"\n    )\n    # Standardize the optimization problem to be maximization\n    if problem_type == \"min\":\n        obj_coeff = -obj_coeff\n\n    # Run the recursive depth-first branch and bound algo\n    root = Digraph(\n        name=\"Branch and Bound Tree\",\n        filename=\"btree.gv\",\n        node_attr={\"shape\": \"record\", \"height\": \".1\"},\n    )\n    root.attr(\"node\", shape=\"box\")\n    root, prob = branch_and_bound_dfs(root, x, constraints, obj_coeff, problem_type)\n    print(\n        f\"Optimal Objective Value: {np.round(prob.value, 3)} | Integer Solution: {np.round(np.array(list(prob.solution.primal_vars.values())).flatten(), 3)}\"\n    )\n    root.attr(label=r\"\\n\\nBranch and Bound Tree\")\n    root.attr(fontsize=\"20\")\n\n    display(root)";
                var nbb_formatted_code = "# Converts the optimization problem parameters into the mathematical representation\ndef solve_lp(x, constraints, obj_coeff, problem_type):\n    \"\"\"Solves the standard LP maximization problem and creates the \n    mathematical formulation of optimization label for graphviz\n    \"\"\"\n    obj = cp.Maximize(obj_coeff @ x)\n    prob = cp.Problem(obj, constraints)\n    prob.solve()\n\n    label = (\n        f\"{problem_type} {' + '.join([str(coeff) + 'x' + str(i+1) for coeff, i in zip(obj_coeff, range(x.shape[0]))])} \"\n        + \"\\nsubject to: \\n\"\n        + \"{}\".format(\n            \"\\n\".join(\n                [\n                    re.sub(\n                        r\"x\\[([0-9]*)\\]\",\n                        \"x\"\n                        + str(\n                            int(\n                                re.search(\n                                    r\"\\[[0-9]*\\]\",\n                                    re.sub(r\"var[0-9]*\", \"x\", str(constraint)),\n                                )\n                                .group()\n                                .replace(\"]\", \"\")\n                                .replace(\"[\", \"\")\n                            )\n                            + 1\n                        ),\n                        re.sub(r\"var[0-9]*\", \"x\", str(constraint)),\n                    )\n                    if re.search(\n                        r\"x\\[([0-9]*)\\]\", re.sub(r\"var[0-9]*\", \"x\", str(constraint))\n                    )\n                    is not None\n                    else re.sub(r\"var[0-9]*\", \"x\", str(constraint))\n                    for constraint in constraints\n                ]\n            )\n        )\n        + (\n            \"\\n\\nObjective Value: \"\n            + (\n                str(np.round(prob.value, 2))\n                if prob.status == \"optimal\"\n                else str(prob.value)\n            )\n            + \"\\nSolution: \"\n            + (\n                str([np.round(x_i, 2) for x_i in x.value])\n                if prob.status == \"optimal\"\n                else prob.status\n            )\n        )\n    )\n    return label, prob\n\n\n# Checks if the number is an integer within specified decimal rounding\nis_integer = lambda x, decimals=3: np.round(x, decimals).is_integer()\n\n# Checks if all elements in array are integers\nis_integer_solution = lambda x: np.alltrue([is_integer(x_i) for x_i in x])\n\n\ndef branch_and_bound_dfs(root, x, constraints, obj_coeff, problem_type):\n    \"\"\"Iterative DFS traversal of branch and bound tree\"\"\"\n\n    node_id = \"root\"  # ID to map the node of branch and bound tree to the constraints\n    stack = (\n        []\n    )  # To simulate depth first traversal by appending onto stack the node's children\n    node_constraints = (\n        {}\n    )  # A map of the node_id to constraints associated with the node\n    visited = []  # A list to keep the nodes already visited\n\n    stack.append((node_id, None))\n    node_constraints[node_id] = constraints\n\n    lb, ub = None, None  # Lower bound and upper bound of ILP\n\n    while len(stack) > 0:\n\n        # Visit node\n        node_id, parent_node_id = stack.pop()\n        visited.append(node_id)\n\n        # Process Root\n        label, prob = solve_lp(x, node_constraints[node_id], obj_coeff, problem_type)\n        root.node(name=str(node_id), label=label)\n\n        # Add Edge\n        if node_id != \"root\":\n            root.edge(\n                tail_name=str(parent_node_id),\n                head_name=str(node_id),\n                label=re.sub(\n                    r\"x\\[([0-9]*)\\]\",\n                    \"x\"\n                    + str(\n                        int(\n                            re.search(\n                                r\"\\[[0-9]*\\]\",\n                                re.sub(\n                                    r\"var[0-9]*\",\n                                    \"x\",\n                                    str(node_constraints[node_id][-1]),\n                                ),\n                            )\n                            .group()\n                            .replace(\"]\", \"\")\n                            .replace(\"[\", \"\")\n                        )\n                        + 1\n                    ),\n                    re.sub(r\"var[0-9]*\", \"x\", str(node_constraints[node_id][-1])),\n                ),\n                len=\"5\",\n            )\n\n        if prob.status == \"optimal\":\n\n            # If current solution is integer\n            is_integer_current_solution = is_integer_solution(\n                np.array(list(prob.solution.primal_vars.values())).flatten()\n            )\n\n            # Break Conditions\n            if is_integer_current_solution and (\n                (ub is None) or (prob.value == np.floor(ub.value))\n            ):  # Optimal Integer solution found\n                return root, prob\n\n            # Set lower bound of the ilp\n            if is_integer_current_solution and (\n                (lb is None) or (prob.value > lb.value)\n            ):\n                lb = prob\n\n            # Set upper bound of the ilp\n            if (ub is None) or (prob.value > ub.value):\n                ub = prob\n\n            if (\n                prob.value > lb.value if lb is not None else True\n            ) and not is_integer_current_solution:\n\n                # Find non-integer value of solution\n                largest_nonint_idx, largest_nonint_val = sorted(\n                    [\n                        (idx, x_i)\n                        for idx, x_i in enumerate(prob.variables()[0].value)\n                        if not is_integer(x_i)\n                    ],\n                    key=lambda x: x[1],\n                    reverse=True,\n                )[0]\n\n                # Add left and right children nodes for processing\n                stack.append((node_id + \" -> left\", node_id))\n                node_constraints[node_id + \" -> left\"] = node_constraints[node_id] + [\n                    x[largest_nonint_idx] >= np.ceil(largest_nonint_val)\n                ]\n                stack.append((node_id + \" -> right\", node_id))\n                node_constraints[node_id + \" -> right\"] = node_constraints[node_id] + [\n                    x[largest_nonint_idx] <= np.floor(largest_nonint_val)\n                ]\n\n    return root, lb\n\n\ndef branch_and_bound_ilp(x, constraints, obj_coeff, problem_type):\n    \"\"\"Solves Pure Integer Linear Program using\n    Branch and Bound method.\n    \n    Args:\n        x (cvxpy.Variable): The integer variables in our problem\n        constraints (List[Inequality]): List of inequality constraints to impose on problem\n        obj_coeff (numpy.array): The objective coefficients for a linear program\n        problem_type (str): Either min, or max (default - min)\n        \n    Returns:\n        \n    \n    \"\"\"\n    assert (problem_type == \"min\") or (problem_type == \"max\"), print(\n        \"problem_type must be either `min` or `max`.\"\n    )\n    # Standardize the optimization problem to be maximization\n    if problem_type == \"min\":\n        obj_coeff = -obj_coeff\n\n    # Run the recursive depth-first branch and bound algo\n    root = Digraph(\n        name=\"Branch and Bound Tree\",\n        filename=\"btree.gv\",\n        node_attr={\"shape\": \"record\", \"height\": \".1\"},\n    )\n    root.attr(\"node\", shape=\"box\")\n    root, prob = branch_and_bound_dfs(root, x, constraints, obj_coeff, problem_type)\n    print(\n        f\"Optimal Objective Value: {np.round(prob.value, 3)} | Integer Solution: {np.round(np.array(list(prob.solution.primal_vars.values())).flatten(), 3)}\"\n    )\n    root.attr(label=r\"\\n\\nBranch and Bound Tree\")\n    root.attr(fontsize=\"20\")\n\n    display(root)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">4</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">branch_and_bound_ilp</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">14</span><span class="p">]),</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,],</span>
    <span class="n">obj_coeff</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal Objective Value: 21.0 | Integer Solution: [1. 0. 1. 1.]
</pre></div>
</div>
<img alt="../../_images/hw9_7_1.svg" src="../../_images/hw9_7_1.svg" /><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 447 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 3;
                var nbb_unformatted_code = "x = cp.Variable((4,), integer=False)\nbranch_and_bound_ilp(\n    x=x,\n    constraints=[np.array([[7, 5, 4, 3]]) @ x <= np.array([14]), x >= 0, x <= 1,],\n    obj_coeff=np.array([11, 8, 6, 4]),\n    problem_type=\"max\",\n)";
                var nbb_formatted_code = "x = cp.Variable((4,), integer=False)\nbranch_and_bound_ilp(\n    x=x,\n    constraints=[np.array([[7, 5, 4, 3]]) @ x <= np.array([14]), x >= 0, x <= 1,],\n    obj_coeff=np.array([11, 8, 6, 4]),\n    problem_type=\"max\",\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sanity Check</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">4</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">14</span><span class="p">]),</span>
    <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear Programming Solution&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal value is: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal solution is: x = </span><span class="si">{</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Programming Solution
==============================
Status: optimal
The optimal value is: 21.0
The optimal solution is: x = [1.0, 0.0, 1.0, 1.0]
time: 10.4 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 4;
                var nbb_unformatted_code = "# Sanity Check\nx = cp.Variable((4,), integer=True)\nconstraints = [\n    np.array([[7, 5, 4, 3]]) @ x <= np.array([14]),\n    x >= 0,\n    x <= 1,\n]\nobj = cp.Maximize(np.array([11, 8, 6, 4]) @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_formatted_code = "# Sanity Check\nx = cp.Variable((4,), integer=True)\nconstraints = [\n    np.array([[7, 5, 4, 3]]) @ x <= np.array([14]),\n    x >= 0,\n    x <= 1,\n]\nobj = cp.Maximize(np.array([11, 8, 6, 4]) @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<hr class="docutils" />
<ul class="simple">
<li><p>Solve the following two integer programs by the branch-and-bound algorithm:</p></li>
</ul>
<ol class="simple">
<li></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-2c33ebaf-09c1-4620-b19e-214f572fb367">
<span class="eqno">(427)<a class="headerlink" href="#equation-2c33ebaf-09c1-4620-b19e-214f572fb367" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \underset{x \geq 0 \text{ integer }}{\text{maximize }}\qquad&amp;2x_1 + x_2 \\
    \text{subject to }\qquad&amp;x_1 + x_2 \leq 5 \\
    &amp;x_2 - x_1 \leq 0 \\
    \text{and }\qquad&amp;6x_1 + 2x_2 \leq 21. \\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">branch_and_bound_ilp</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">21</span><span class="p">]),</span>
        <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">obj_coeff</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal Objective Value: 7.0 | Integer Solution: [3. 1.]
</pre></div>
</div>
<img alt="../../_images/hw9_10_1.svg" src="../../_images/hw9_10_1.svg" /><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 375 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 5;
                var nbb_unformatted_code = "x = cp.Variable((2,), integer=False)\nbranch_and_bound_ilp(\n    x=x,\n    constraints=[\n        np.array([[1, 1], [-1, 1], [6, 2]]) @ x <= np.array([5, 0, 21]),\n        x >= 0,\n    ],\n    obj_coeff=np.array([2, 1]),\n    problem_type=\"max\",\n)";
                var nbb_formatted_code = "x = cp.Variable((2,), integer=False)\nbranch_and_bound_ilp(\n    x=x,\n    constraints=[\n        np.array([[1, 1], [-1, 1], [6, 2]]) @ x <= np.array([5, 0, 21]),\n        x >= 0,\n    ],\n    obj_coeff=np.array([2, 1]),\n    problem_type=\"max\",\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sanity Check</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">21</span><span class="p">]),</span>
    <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear Programming Solution&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal value is: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal solution is: x = </span><span class="si">{</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Programming Solution
==============================
Status: optimal
The optimal value is: 7.0
The optimal solution is: x = [3.0, 1.0]
time: 9.45 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 6;
                var nbb_unformatted_code = "# Sanity Check\nx = cp.Variable((2,), integer=True)\nconstraints = [\n    np.array([[1, 1], [-1, 1], [6, 2]]) @ x <= np.array([5, 0, 21]),\n    x >= 0,\n]\nobj = cp.Maximize(np.array([2, 1]) @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_formatted_code = "# Sanity Check\nx = cp.Variable((2,), integer=True)\nconstraints = [\n    np.array([[1, 1], [-1, 1], [6, 2]]) @ x <= np.array([5, 0, 21]),\n    x >= 0,\n]\nobj = cp.Maximize(np.array([2, 1]) @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<ol class="simple">
<li></li>
</ol>
<div class="amsmath math notranslate nohighlight" id="equation-82291caf-a085-4068-9506-0d2ac3c6d64f">
<span class="eqno">(428)<a class="headerlink" href="#equation-82291caf-a085-4068-9506-0d2ac3c6d64f" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \underset{x \geq 0 \text{ integer }}{\text{maximize }}\qquad&amp;2x_1 + x_2 + 4x_3 + 5x_4 \\
    \text{subject to }\qquad&amp;x_1 + 3x_2 + 2x_3 + 5x_4 \leq 10 \\
    \text{and }\qquad&amp;3x_1 - x_2 - 5x_3 + 10x_4 \leq -4. \\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">4</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">branch_and_bound_ilp</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">]),</span>
        <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">obj_coeff</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal Objective Value: 20.0 | Integer Solution: [2. 0. 4. 0.]
</pre></div>
</div>
<img alt="../../_images/hw9_13_1.svg" src="../../_images/hw9_13_1.svg" /><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 419 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 7;
                var nbb_unformatted_code = "x = cp.Variable((4,), integer=False)\nbranch_and_bound_ilp(\n    x=x,\n    constraints=[\n        np.array([[1, 3, 2, 5], [3, -1, -5, 10]]) @ x <= np.array([10, -4]),\n        x >= 0,\n    ],\n    obj_coeff=np.array([2, 1, 4, 5]),\n    problem_type=\"max\",\n)";
                var nbb_formatted_code = "x = cp.Variable((4,), integer=False)\nbranch_and_bound_ilp(\n    x=x,\n    constraints=[\n        np.array([[1, 3, 2, 5], [3, -1, -5, 10]]) @ x <= np.array([10, -4]),\n        x >= 0,\n    ],\n    obj_coeff=np.array([2, 1, 4, 5]),\n    problem_type=\"max\",\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sanity Check</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">4</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">]),</span>
    <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear Programming Solution&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal value is: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal solution is: x = </span><span class="si">{</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Programming Solution
==============================
Status: optimal
The optimal value is: 20.0
The optimal solution is: x = [0.0, 0.0, 5.0, 0.0]
time: 9.07 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 8;
                var nbb_unformatted_code = "# Sanity Check\nx = cp.Variable((4,), integer=True)\nconstraints = [\n    np.array([[1, 3, 2, 5], [3, -1, -5, 10]]) @ x <= np.array([10, -4]),\n    x >= 0,\n]\nobj = cp.Maximize(np.array([2, 1, 4, 5]) @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_formatted_code = "# Sanity Check\nx = cp.Variable((4,), integer=True)\nconstraints = [\n    np.array([[1, 3, 2, 5], [3, -1, -5, 10]]) @ x <= np.array([10, -4]),\n    x >= 0,\n]\nobj = cp.Maximize(np.array([2, 1, 4, 5]) @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<hr class="docutils" />
<ul class="simple">
<li><p>Consider the integer programming problem:</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-2aae885b-2b95-4c78-8b7b-0c2c44302bba">
<span class="eqno">(429)<a class="headerlink" href="#equation-2aae885b-2b95-4c78-8b7b-0c2c44302bba" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \underset{x}{\text{maximize }}\qquad&amp;x_1 + x_2 \\
    \text{subject to }\qquad&amp;-3x_1 + 4x_2 \leq 4 \\
    &amp;3x_1 + 2x_2 \leq 11 \\
    &amp;2x_1 - x_2 \leq 5 \\
    \text{and }\qquad&amp;x_1, x_2 \geq 0 \text{ and integer}. \\
\end{align}\]</div>
<p>Use a figure to answer the following questions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sanity Check</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
    <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear Programming Solution&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal value is: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal solution is: x = </span><span class="si">{</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Programming Solution
==============================
Status: optimal
The optimal value is: 4.0
The optimal solution is: x = [2.0, 2.0]
time: 7.59 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 9;
                var nbb_unformatted_code = "# Sanity Check\nx = cp.Variable((2,), integer=True)\nconstraints = [\n    np.array([[-3, 4], [3, 2], [2, -1]]) @ x <= np.array([4, 11, 5]),\n    x >= 0,\n]\nobj = cp.Maximize(np.array([1, 1]) @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_formatted_code = "# Sanity Check\nx = cp.Variable((2,), integer=True)\nconstraints = [\n    np.array([[-3, 4], [3, 2], [2, -1]]) @ x <= np.array([4, 11, 5]),\n    x >= 0,\n]\nobj = cp.Maximize(np.array([1, 1]) @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct lines</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>  <span class="c1"># x_1 &gt;= 0</span>
<span class="n">x2_1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>  <span class="c1"># constraint 1: −3𝑥1+4𝑥2≤4</span>
<span class="n">x2_2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">11</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># constraint 2: 3𝑥1+2𝑥2≤11</span>
<span class="n">x2_3</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">-</span> <span class="mi">5</span>  <span class="c1"># constraint 3: 2𝑥1−𝑥2≤5</span>

<span class="c1"># Make plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2_1</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$-3x_1 + 4x_2 \leq 4$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2_2</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$3x_1 + 2x_2 \leq 11$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2_3</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$2x_1 - x_2 \leq 5$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>

<span class="c1"># Fill feasible region when Integer constraints are relaxed</span>
<span class="n">ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">x2_1</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">x2_2</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)),</span> <span class="n">x2_3</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">x1</span><span class="p">,</span>
    <span class="n">lb</span><span class="p">,</span>
    <span class="n">ub</span><span class="p">,</span>
    <span class="n">where</span><span class="o">=</span><span class="n">ub</span> <span class="o">&gt;</span> <span class="n">lb</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Convex Hull [feasible region (relaxed int constraints)]&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Get Feasible Integer Points</span>
<span class="n">feasible</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">])),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">feasible_integer_points</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">if</span> <span class="n">feasible</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]))</span>
<span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">feasible_integer_points</span><span class="p">)),</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span><span class="p">:</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/hw9_17_0.png" src="../../_images/hw9_17_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 1.86 s
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 10;
                var nbb_unformatted_code = "# Construct lines\nx1 = np.linspace(0, 6, 2000)  # x_1 >= 0\nx2_1 = lambda x1: (3 * x1 + 4) / 4  # constraint 1: \u22123\ud835\udc651+4\ud835\udc652\u22644\nx2_2 = lambda x1: (-3 * x1 + 11) / 2  # constraint 2: 3\ud835\udc651+2\ud835\udc652\u226411\nx2_3 = lambda x1: 2 * x1 - 5  # constraint 3: 2\ud835\udc651\u2212\ud835\udc652\u22645\n\n# Make plot\nplt.plot(x1, x2_1(x1), label=r\"$-3x_1 + 4x_2 \\leq 4$\")\nplt.plot(x1, x2_2(x1), label=r\"$3x_1 + 2x_2 \\leq 11$\")\nplt.plot(x1, x2_3(x1), label=r\"$2x_1 - x_2 \\leq 5$\")\nplt.xlim((0, 6))\nplt.ylim((0, 6))\nplt.xlabel(r\"$x_1$\")\nplt.ylabel(r\"$x_2$\")\n\n# Fill feasible region when Integer constraints are relaxed\nub = np.minimum(x2_1(x1), x2_2(x1))\nlb = np.maximum(np.zeros(len(x1)), x2_3(x1))\nplt.fill_between(\n    x1,\n    lb,\n    ub,\n    where=ub > lb,\n    color=\"grey\",\n    alpha=0.5,\n    label=\"Convex Hull [feasible region (relaxed int constraints)]\",\n)\n\n# Get Feasible Integer Points\nfeasible = lambda x: np.alltrue(\n    [\n        np.alltrue(np.array([[-3, 4], [3, 2], [2, -1]]) @ x <= np.array([4, 11, 5])),\n        np.alltrue(x >= 0),\n    ]\n)\nfeasible_integer_points = [\n    (i, j) for i in range(6) for j in range(6) if feasible(np.array([i, j]))\n]\nplt.scatter(*list(zip(*feasible_integer_points)), marker=\"X\", c=\"r\", s=100)\nfor x, y in feasible_integer_points:\n    label = f\"({x},{y})\"\n    plt.annotate(label, (x, y), textcoords=\"offset points\", xytext=(0, 10), ha=\"center\")\n\nplt.grid(True)\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.0)\nplt.show()";
                var nbb_formatted_code = "# Construct lines\nx1 = np.linspace(0, 6, 2000)  # x_1 >= 0\nx2_1 = lambda x1: (3 * x1 + 4) / 4  # constraint 1: \u22123\ud835\udc651+4\ud835\udc652\u22644\nx2_2 = lambda x1: (-3 * x1 + 11) / 2  # constraint 2: 3\ud835\udc651+2\ud835\udc652\u226411\nx2_3 = lambda x1: 2 * x1 - 5  # constraint 3: 2\ud835\udc651\u2212\ud835\udc652\u22645\n\n# Make plot\nplt.plot(x1, x2_1(x1), label=r\"$-3x_1 + 4x_2 \\leq 4$\")\nplt.plot(x1, x2_2(x1), label=r\"$3x_1 + 2x_2 \\leq 11$\")\nplt.plot(x1, x2_3(x1), label=r\"$2x_1 - x_2 \\leq 5$\")\nplt.xlim((0, 6))\nplt.ylim((0, 6))\nplt.xlabel(r\"$x_1$\")\nplt.ylabel(r\"$x_2$\")\n\n# Fill feasible region when Integer constraints are relaxed\nub = np.minimum(x2_1(x1), x2_2(x1))\nlb = np.maximum(np.zeros(len(x1)), x2_3(x1))\nplt.fill_between(\n    x1,\n    lb,\n    ub,\n    where=ub > lb,\n    color=\"grey\",\n    alpha=0.5,\n    label=\"Convex Hull [feasible region (relaxed int constraints)]\",\n)\n\n# Get Feasible Integer Points\nfeasible = lambda x: np.alltrue(\n    [\n        np.alltrue(np.array([[-3, 4], [3, 2], [2, -1]]) @ x <= np.array([4, 11, 5])),\n        np.alltrue(x >= 0),\n    ]\n)\nfeasible_integer_points = [\n    (i, j) for i in range(6) for j in range(6) if feasible(np.array([i, j]))\n]\nplt.scatter(*list(zip(*feasible_integer_points)), marker=\"X\", c=\"r\", s=100)\nfor x, y in feasible_integer_points:\n    label = f\"({x},{y})\"\n    plt.annotate(label, (x, y), textcoords=\"offset points\", xytext=(0, 10), ha=\"center\")\n\nplt.grid(True)\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.0)\nplt.show()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>(a) What is the optimal objective value of the linear programming relaxation? What is the optimal objective value of the integer program?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sanity Check</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
    <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear Programming Solution&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal value is: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal solution is: x = </span><span class="si">{</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Programming Solution
==============================
Status: optimal
The optimal value is: 4.5
The optimal solution is: x = [2.0, 2.5]
time: 10.4 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 11;
                var nbb_unformatted_code = "# Sanity Check\nx = cp.Variable((2,), integer=False)\nconstraints = [\n    np.array([[-3, 4], [3, 2], [2, -1]]) @ x <= np.array([4, 11, 5]),\n    x >= 0,\n]\nobj = cp.Maximize(np.array([1, 1]) @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_formatted_code = "# Sanity Check\nx = cp.Variable((2,), integer=False)\nconstraints = [\n    np.array([[-3, 4], [3, 2], [2, -1]]) @ x <= np.array([4, 11, 5]),\n    x >= 0,\n]\nobj = cp.Maximize(np.array([1, 1]) @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Optimal Objective value of Integer Program: &quot;</span><span class="p">,</span>
    <span class="nb">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">feasible_integer_points</span><span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span>
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span><span class="p">]</span>
    <span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal Objective value of Integer Program:  4
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2, 2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 3.23 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 12;
                var nbb_unformatted_code = "print(\n    \"Optimal Objective value of Integer Program: \",\n    max([np.array([1, 1]) @ np.array([x1, x2]) for x1, x2 in feasible_integer_points]),\n)\nfeasible_integer_points[\n    np.argmax(\n        [np.array([1, 1]) @ np.array([x1, x2]) for x1, x2 in feasible_integer_points]\n    )\n]";
                var nbb_formatted_code = "print(\n    \"Optimal Objective value of Integer Program: \",\n    max([np.array([1, 1]) @ np.array([x1, x2]) for x1, x2 in feasible_integer_points]),\n)\nfeasible_integer_points[\n    np.argmax(\n        [np.array([1, 1]) @ np.array([x1, x2]) for x1, x2 in feasible_integer_points]\n    )\n]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>(b) What is the convex hull of the set of all feasible solution to the integer program?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Integer points in Convex Hull of the set of all feasible solution to the integer program: </span><span class="si">{</span><span class="n">feasible_integer_points</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Integer points in Convex Hull of the set of all feasible solution to the integer program: [(0, 0), (0, 1), (1, 0), (1, 1), (2, 0), (2, 1), (2, 2), (3, 1)]
time: 447 µs
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 13;
                var nbb_unformatted_code = "print(\n    f\"Integer points in Convex Hull of the set of all feasible solution to the integer program: {feasible_integer_points}\"\n)";
                var nbb_formatted_code = "print(\n    f\"Integer points in Convex Hull of the set of all feasible solution to the integer program: {feasible_integer_points}\"\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>(c) Construct a Gomory cutting plane using the optimal linear programming solution.</p>
<div class="amsmath math notranslate nohighlight" id="equation-b345baed-dd44-4be0-ace7-e0e4e8766ea7">
<span class="eqno">(430)<a class="headerlink" href="#equation-b345baed-dd44-4be0-ace7-e0e4e8766ea7" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \underset{x}{\text{maximize }}\qquad&amp;x_1 + x_2 \\
    \text{subject to }\qquad&amp;-3x_1 + 4x_2 \leq 4 \\
    &amp;3x_1 + 2x_2 \leq 11 \\
    &amp;2x_1 - x_2 \leq 5 \\
    \text{and }\qquad&amp;x_1, x_2 \geq 0. \\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">5</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">A</span> <span class="o">@</span> <span class="n">x</span> <span class="o">==</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear Programming Solution&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal value is: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal solution is: x = </span><span class="si">{</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Programming Solution
==============================
Status: optimal
The optimal value is: 4.5
The optimal solution is: x = [2.0, 2.5, 0.0, -0.0, 3.5]
time: 10.1 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 14;
                var nbb_unformatted_code = "A = np.array([[-3, 4, 1, 0, 0], [3, 2, 0, 1, 0], [2, -1, 0, 0, 1]])\nb = np.array([4, 11, 5])\nc = np.array([1, 1, 0, 0, 0])\nx = cp.Variable((5,), integer=False)\nconstraints = [\n    A @ x == b,\n    x >= 0,\n]\nobj = cp.Maximize(c.T @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_formatted_code = "A = np.array([[-3, 4, 1, 0, 0], [3, 2, 0, 1, 0], [2, -1, 0, 0, 1]])\nb = np.array([4, 11, 5])\nc = np.array([1, 1, 0, 0, 0])\nx = cp.Variable((5,), integer=False)\nconstraints = [\n    A @ x == b,\n    x >= 0,\n]\nobj = cp.Maximize(c.T @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">basic_idxs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">non_basic_idxs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 507 µs
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 15;
                var nbb_unformatted_code = "basic_idxs = [0, 1, 4]\nnon_basic_idxs = [2, 3]";
                var nbb_formatted_code = "basic_idxs = [0, 1, 4]\nnon_basic_idxs = [2, 3]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p><span class="math notranslate nohighlight">\({c_B}^\top B^{-1} N - c_N\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">basic_idxs</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="n">basic_idxs</span><span class="p">])</span> <span class="o">@</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">non_basic_idxs</span><span class="p">])</span> <span class="o">-</span> <span class="n">c</span><span class="p">[</span>
    <span class="n">non_basic_idxs</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.05555556, 0.38888889])
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 2.7 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 16;
                var nbb_unformatted_code = "(c[basic_idxs].T @ np.linalg.inv(A[:, basic_idxs]) @ A[:, non_basic_idxs]) - c[\n    non_basic_idxs\n]";
                var nbb_formatted_code = "(c[basic_idxs].T @ np.linalg.inv(A[:, basic_idxs]) @ A[:, non_basic_idxs]) - c[\n    non_basic_idxs\n]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>Since the negative reduced cost coefficients are &gt;= 0 for maximization problem, solution is optimal.</p>
<p><span class="math notranslate nohighlight">\(B^{-1}N\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="n">basic_idxs</span><span class="p">])</span> <span class="o">@</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">non_basic_idxs</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.11111111,  0.22222222],
       [ 0.16666667,  0.16666667],
       [ 0.38888889, -0.27777778]])
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 2.59 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 17;
                var nbb_unformatted_code = "(np.linalg.inv(A[:, basic_idxs]) @ A[:, non_basic_idxs])";
                var nbb_formatted_code = "(np.linalg.inv(A[:, basic_idxs]) @ A[:, non_basic_idxs])";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p><span class="math notranslate nohighlight">\(B^{-1}b\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="n">basic_idxs</span><span class="p">])</span> <span class="o">@</span> <span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2. , 2.5, 3.5])
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 2.25 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 18;
                var nbb_unformatted_code = "np.linalg.inv(A[:, basic_idxs]) @ b";
                var nbb_formatted_code = "np.linalg.inv(A[:, basic_idxs]) @ b";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p><span class="math notranslate nohighlight">\({c_B}^\top  B^{-1}b\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="p">[</span><span class="n">basic_idxs</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="n">basic_idxs</span><span class="p">])</span> <span class="o">@</span> <span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.499999999999999
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 2.56 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 19;
                var nbb_unformatted_code = "c[basic_idxs].T @ np.linalg.inv(A[:, basic_idxs]) @ b";
                var nbb_formatted_code = "c[basic_idxs].T @ np.linalg.inv(A[:, basic_idxs]) @ b";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>Optimal Solution Simplex Tableau:</p>
<div class="amsmath math notranslate nohighlight" id="equation-aba472aa-caae-4235-967b-25eb59e9564b">
<span class="eqno">(431)<a class="headerlink" href="#equation-aba472aa-caae-4235-967b-25eb59e9564b" title="Permalink to this equation">¶</a></span>\[\begin{align}
    &amp;\begin{array}{c}
    \\
    z \\ 
    x_1 \\
    x_2 \\
    s_3 \\
    \end{array}
    \begin{bmatrix}
    \begin{array}{c|ccccc|c}
      z &amp; x_1 &amp; x_2 &amp; s_1 &amp; s_2 &amp; s_3 &amp; b \\ \hline
      4.5 &amp; 0 &amp; 0 &amp; 0.05555556 &amp; 0.38888889 &amp; 0 &amp; - \\ \hline
      0 &amp; 1 &amp; 0 &amp; -0.11111111 &amp; 0.22222222 &amp; 0 &amp; 2 \\
      0 &amp; 0 &amp; 1 &amp; 0.16666667 &amp; 0.16666667 &amp; 0 &amp; 2.5 \\
      0 &amp; 0 &amp; 0 &amp; 0.38888889 &amp; -0.27777778 &amp; 1 &amp; 3.5 \\
    \end{array}
    \end{bmatrix} \\
\end{align}\]</div>
<p>From the 2nd row:</p>
<div class="amsmath math notranslate nohighlight" id="equation-148daedf-82eb-4e50-814c-a48ab4e392cb">
<span class="eqno">(432)<a class="headerlink" href="#equation-148daedf-82eb-4e50-814c-a48ab4e392cb" title="Permalink to this equation">¶</a></span>\[\begin{align}
    x_2 + 0.16666667s_1 + 0.16666667s_2 &amp;= 2.5 \\
    0.16666667s_1 + 0.16666667s_2 + 0.5 &amp;= 3 - x_2 \\
\end{align}\]</div>
<p>LHS is always <span class="math notranslate nohighlight">\(\geq 0\)</span> since <span class="math notranslate nohighlight">\(s_1\)</span> and <span class="math notranslate nohighlight">\(s_2\)</span> are non-negative, hence, we add a new constraint (Gomory Cutting plane):</p>
<div class="amsmath math notranslate nohighlight" id="equation-e5d2b326-50e3-4e45-9a03-f9113fc2faa3">
<span class="eqno">(433)<a class="headerlink" href="#equation-e5d2b326-50e3-4e45-9a03-f9113fc2faa3" title="Permalink to this equation">¶</a></span>\[\begin{align}
    0.16666667s_1 + 0.16666667s_2 &amp;\geq 0.5 \\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">*-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="n">basic_idxs</span><span class="p">])</span> <span class="o">@</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">non_basic_idxs</span><span class="p">])[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">6</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">A</span> <span class="o">@</span> <span class="n">x</span> <span class="o">==</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear Programming Solution&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal value is: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal solution is: x = </span><span class="si">{</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Programming Solution
==============================
Status: optimal
The optimal value is: 4.33
The optimal solution is: x = [2.33, 2.0, 3.0, 0.0, 2.33, -0.0]
time: 11.6 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 20;
                var nbb_unformatted_code = "A = np.array(\n    [\n        [-3, 4, 1, 0, 0, 0],\n        [3, 2, 0, 1, 0, 0],\n        [2, -1, 0, 0, 1, 0],\n        [0, 0, *-(np.linalg.inv(A[:, basic_idxs]) @ A[:, non_basic_idxs])[1], 0, 1],\n    ]\n)\nb = np.array([4, 11, 5, -0.5])\nc = np.array([1, 1, 0, 0, 0, 0])\nx = cp.Variable((6,), integer=False)\nconstraints = [\n    A @ x == b,\n    x >= 0,\n]\nobj = cp.Maximize(c.T @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_formatted_code = "A = np.array(\n    [\n        [-3, 4, 1, 0, 0, 0],\n        [3, 2, 0, 1, 0, 0],\n        [2, -1, 0, 0, 1, 0],\n        [0, 0, *-(np.linalg.inv(A[:, basic_idxs]) @ A[:, non_basic_idxs])[1], 0, 1],\n    ]\n)\nb = np.array([4, 11, 5, -0.5])\nc = np.array([1, 1, 0, 0, 0, 0])\nx = cp.Variable((6,), integer=False)\nconstraints = [\n    A @ x == b,\n    x >= 0,\n]\nobj = cp.Maximize(c.T @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>(d) Starting with the optimal linear programming solution, solve the integer program using the branch-and-bound method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">branch_and_bound_ilp</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
        <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">obj_coeff</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal Objective Value: 4.0 | Integer Solution: [2. 2.]
</pre></div>
</div>
<img alt="../../_images/hw9_40_1.svg" src="../../_images/hw9_40_1.svg" /><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 389 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 21;
                var nbb_unformatted_code = "x = cp.Variable((2,), integer=False)\nbranch_and_bound_ilp(\n    x=x,\n    constraints=[\n        np.array([[-3, 4], [3, 2], [2, -1]]) @ x <= np.array([4, 11, 5]),\n        x >= 0,\n    ],\n    obj_coeff=np.array([1, 1]),\n    problem_type=\"max\",\n)";
                var nbb_formatted_code = "x = cp.Variable((2,), integer=False)\nbranch_and_bound_ilp(\n    x=x,\n    constraints=[\n        np.array([[-3, 4], [3, 2], [2, -1]]) @ x <= np.array([4, 11, 5]),\n        x >= 0,\n    ],\n    obj_coeff=np.array([1, 1]),\n    problem_type=\"max\",\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>(e) Suppose you relax the first constraint. What is the optimal value <span class="math notranslate nohighlight">\(Z_{\text{dual}}\)</span> of the Lagrangian dual?</p>
<div class="amsmath math notranslate nohighlight" id="equation-f1171bad-1092-4079-b639-4769fee6629a">
<span class="eqno">(434)<a class="headerlink" href="#equation-f1171bad-1092-4079-b639-4769fee6629a" title="Permalink to this equation">¶</a></span>\[\begin{align}
    d(\lambda) = \underset{x}{\text{minimize }}\qquad&amp;-x_1 - x_2 + \lambda(-3x_1 + 4x_2 - 4) \\
    \text{subject to }\qquad&amp;3x_1 + 2x_2 - 11 \leq 0 \\
    &amp;2x_1 - x_2 - 5 \leq 0 \\
    \text{and }\qquad&amp;x_1, x_2 \geq 0 \text{ and integer}. \\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct lines</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>  <span class="c1"># x_1 &gt;= 0</span>
<span class="n">x2_2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">11</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># constraint 2: 3𝑥1+2𝑥2≤11</span>
<span class="n">x2_3</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">-</span> <span class="mi">5</span>  <span class="c1"># constraint 3: 2𝑥1−𝑥2≤5</span>

<span class="c1"># Make plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2_2</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$3x_1 + 2x_2 \leq 11$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2_3</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$2x_1 - x_2 \leq 5$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>

<span class="c1"># Fill feasible region when Integer constraints are relaxed</span>
<span class="n">ub</span> <span class="o">=</span> <span class="n">x2_2</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)),</span> <span class="n">x2_3</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">x1</span><span class="p">,</span>
    <span class="n">lb</span><span class="p">,</span>
    <span class="n">ub</span><span class="p">,</span>
    <span class="n">where</span><span class="o">=</span><span class="n">ub</span> <span class="o">&gt;</span> <span class="n">lb</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Convex Hull [feasible region (relaxed int constraints)]&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Get Feasible Integer Points</span>
<span class="n">feasible</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">])),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">feasible_integer_points</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">if</span> <span class="n">feasible</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]))</span>
<span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">feasible_integer_points</span><span class="p">)),</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span><span class="p">:</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/hw9_43_0.png" src="../../_images/hw9_43_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 1.63 s
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 22;
                var nbb_unformatted_code = "# Construct lines\nx1 = np.linspace(0, 6, 2000)  # x_1 >= 0\nx2_2 = lambda x1: (-3 * x1 + 11) / 2  # constraint 2: 3\ud835\udc651+2\ud835\udc652\u226411\nx2_3 = lambda x1: 2 * x1 - 5  # constraint 3: 2\ud835\udc651\u2212\ud835\udc652\u22645\n\n# Make plot\nplt.plot(x1, x2_2(x1), label=r\"$3x_1 + 2x_2 \\leq 11$\")\nplt.plot(x1, x2_3(x1), label=r\"$2x_1 - x_2 \\leq 5$\")\nplt.xlim((0, 6))\nplt.ylim((0, 6))\nplt.xlabel(r\"$x_1$\")\nplt.ylabel(r\"$x_2$\")\n\n# Fill feasible region when Integer constraints are relaxed\nub = x2_2(x1)\nlb = np.maximum(np.zeros(len(x1)), x2_3(x1))\nplt.fill_between(\n    x1,\n    lb,\n    ub,\n    where=ub > lb,\n    color=\"grey\",\n    alpha=0.5,\n    label=\"Convex Hull [feasible region (relaxed int constraints)]\",\n)\n\n# Get Feasible Integer Points\nfeasible = lambda x: np.alltrue(\n    [\n        np.alltrue(np.array([[3, 2], [2, -1]]) @ x <= np.array([11, 5])),\n        np.alltrue(x >= 0),\n    ]\n)\nfeasible_integer_points = [\n    (i, j) for i in range(6) for j in range(6) if feasible(np.array([i, j]))\n]\nplt.scatter(*list(zip(*feasible_integer_points)), marker=\"X\", c=\"r\", s=100)\nfor x, y in feasible_integer_points:\n    label = f\"({x},{y})\"\n    plt.annotate(label, (x, y), textcoords=\"offset points\", xytext=(0, 10), ha=\"center\")\n\nplt.grid(True)\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.0)\nplt.show()";
                var nbb_formatted_code = "# Construct lines\nx1 = np.linspace(0, 6, 2000)  # x_1 >= 0\nx2_2 = lambda x1: (-3 * x1 + 11) / 2  # constraint 2: 3\ud835\udc651+2\ud835\udc652\u226411\nx2_3 = lambda x1: 2 * x1 - 5  # constraint 3: 2\ud835\udc651\u2212\ud835\udc652\u22645\n\n# Make plot\nplt.plot(x1, x2_2(x1), label=r\"$3x_1 + 2x_2 \\leq 11$\")\nplt.plot(x1, x2_3(x1), label=r\"$2x_1 - x_2 \\leq 5$\")\nplt.xlim((0, 6))\nplt.ylim((0, 6))\nplt.xlabel(r\"$x_1$\")\nplt.ylabel(r\"$x_2$\")\n\n# Fill feasible region when Integer constraints are relaxed\nub = x2_2(x1)\nlb = np.maximum(np.zeros(len(x1)), x2_3(x1))\nplt.fill_between(\n    x1,\n    lb,\n    ub,\n    where=ub > lb,\n    color=\"grey\",\n    alpha=0.5,\n    label=\"Convex Hull [feasible region (relaxed int constraints)]\",\n)\n\n# Get Feasible Integer Points\nfeasible = lambda x: np.alltrue(\n    [\n        np.alltrue(np.array([[3, 2], [2, -1]]) @ x <= np.array([11, 5])),\n        np.alltrue(x >= 0),\n    ]\n)\nfeasible_integer_points = [\n    (i, j) for i in range(6) for j in range(6) if feasible(np.array([i, j]))\n]\nplt.scatter(*list(zip(*feasible_integer_points)), marker=\"X\", c=\"r\", s=100)\nfor x, y in feasible_integer_points:\n    label = f\"({x},{y})\"\n    plt.annotate(label, (x, y), textcoords=\"offset points\", xytext=(0, 10), ha=\"center\")\n\nplt.grid(True)\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.0)\nplt.show()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Integer points in Convex Hull X_hat of Dual Function: </span><span class="si">{</span><span class="n">feasible_integer_points</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Integer points in Convex Hull X_hat of Dual Function: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4), (0, 5), (1, 0), (1, 1), (1, 2), (1, 3), (1, 4), (2, 0), (2, 1), (2, 2), (3, 1)]
time: 364 µs
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 23;
                var nbb_unformatted_code = "print(f\"Integer points in Convex Hull X_hat of Dual Function: {feasible_integer_points}\")";
                var nbb_formatted_code = "print(\n    f\"Integer points in Convex Hull X_hat of Dual Function: {feasible_integer_points}\"\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="o">-</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;λ&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">[</span><span class="n">expr</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-4*λ,
 -1,
 4*λ - 2,
 8*λ - 3,
 12*λ - 4,
 16*λ - 5,
 -7*λ - 1,
 -3*λ - 2,
 λ - 3,
 5*λ - 4,
 9*λ - 5,
 -10*λ - 2,
 -6*λ - 3,
 -2*λ - 4,
 -9*λ - 4]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 49.3 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 24;
                var nbb_unformatted_code = "expr = lambda x1, x2: -x1 - x2 + symbols(\"\u03bb\") * (-3 * x1 + 4 * x2 - 4)\n[expr(x1, x2) for x1, x2 in feasible_integer_points]";
                var nbb_formatted_code = "expr = lambda x1, x2: -x1 - x2 + symbols(\"\u03bb\") * (-3 * x1 + 4 * x2 - 4)\n[expr(x1, x2) for x1, x2 in feasible_integer_points]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="amsmath math notranslate nohighlight" id="equation-9e595e7c-705d-407d-81d2-8d0cf58aa770">
<span class="eqno">(435)<a class="headerlink" href="#equation-9e595e7c-705d-407d-81d2-8d0cf58aa770" title="Permalink to this equation">¶</a></span>\[\begin{align}
    d(\lambda) &amp;= \underset{x\in\hat{X}}{\text{minimize }} -x_1 - x_2 + \lambda(-3x_1 + 4x_2 - 4) \\
    &amp;= \min\{ 
    -4\lambda,
     -1,
     4\lambda - 2,
     8\lambda - 3,
     12\lambda - 4,
     16\lambda - 5,
     -7\lambda - 1,
     -3\lambda - 2,
     λ - 3,
     5\lambda - 4,
     9\lambda - 5,
     -10\lambda - 2,
     -6\lambda - 3,
     -2\lambda - 4,
     -9\lambda - 4  
     \}\\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">1</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">λ</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">1</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">*</span><span class="p">[</span>
        <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">lambdify</span><span class="p">(</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;λ&quot;</span><span class="p">),</span> <span class="n">expr</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="s2">&quot;numpy&quot;</span><span class="p">)(</span><span class="n">λ</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span>
    <span class="p">],</span>
    <span class="n">λ</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal Solution for Lagrangian Dual Relaxation&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal value Z_dual is: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal solution is: λ = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">λ</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal Solution for Lagrangian Dual Relaxation
==============================
Status: optimal
The optimal value Z_dual is: -4.5
The optimal solution is: λ = 0.06
time: 36.8 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 25;
                var nbb_unformatted_code = "t = cp.Variable((1,), integer=False)\n\u03bb = cp.Variable((1,), integer=False)\nconstraints = [\n    *[\n        t <= lambdify(symbols(\"\u03bb\"), expr(x1, x2), \"numpy\")(\u03bb)\n        for x1, x2 in feasible_integer_points\n    ],\n    \u03bb >= 0,\n]\nobj = cp.Maximize(t)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Optimal Solution for Lagrangian Dual Relaxation\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value Z_dual is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: \u03bb = {np.round(\u03bb.value[0], 2)}\")";
                var nbb_formatted_code = "t = cp.Variable((1,), integer=False)\n\u03bb = cp.Variable((1,), integer=False)\nconstraints = [\n    *[\n        t <= lambdify(symbols(\"\u03bb\"), expr(x1, x2), \"numpy\")(\u03bb)\n        for x1, x2 in feasible_integer_points\n    ],\n    \u03bb >= 0,\n]\nobj = cp.Maximize(t)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Optimal Solution for Lagrangian Dual Relaxation\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value Z_dual is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: \u03bb = {np.round(\u03bb.value[0], 2)}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>(f) Repeat part (e) by relaxing the third constraint.</p>
<div class="amsmath math notranslate nohighlight" id="equation-42d991e2-a343-4675-bfdd-6034cc0600e1">
<span class="eqno">(436)<a class="headerlink" href="#equation-42d991e2-a343-4675-bfdd-6034cc0600e1" title="Permalink to this equation">¶</a></span>\[\begin{align}
    d(\lambda) = \underset{x}{\text{minimize }}\qquad&amp;-x_1 - x_2 + \lambda(2x_1 - x_2 - 5) \\
    \text{subject to }\qquad&amp;-3x_1 + 4x_2 - 4 \leq 0 \\
    &amp;3x_1 + 2x_2 - 11 \leq 0 \\
    \text{and }\qquad&amp;x_1, x_2 \geq 0 \text{ and integer}. \\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct lines</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>  <span class="c1"># x_1 &gt;= 0</span>
<span class="n">x2_1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>  <span class="c1"># constraint 1: −3𝑥1+4𝑥2≤4</span>
<span class="n">x2_2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">11</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># constraint 2: 3𝑥1+2𝑥2≤11</span>

<span class="c1"># Make plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2_1</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$-3x_1 + 4x_2 \leq 4$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2_2</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$3x_1 + 2x_2 \leq 11$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>

<span class="c1"># Fill feasible region when Integer constraints are relaxed</span>
<span class="n">ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">x2_1</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">x2_2</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">x1</span><span class="p">,</span>
    <span class="n">lb</span><span class="p">,</span>
    <span class="n">ub</span><span class="p">,</span>
    <span class="n">where</span><span class="o">=</span><span class="n">ub</span> <span class="o">&gt;</span> <span class="n">lb</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Convex Hull [feasible region (relaxed int constraints)]&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Get Feasible Integer Points</span>
<span class="n">feasible</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">])),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">feasible_integer_points</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">if</span> <span class="n">feasible</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]))</span>
<span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">feasible_integer_points</span><span class="p">)),</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span><span class="p">:</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/hw9_50_0.png" src="../../_images/hw9_50_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 1.64 s
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 26;
                var nbb_unformatted_code = "# Construct lines\nx1 = np.linspace(0, 6, 2000)  # x_1 >= 0\nx2_1 = lambda x1: (3 * x1 + 4) / 4  # constraint 1: \u22123\ud835\udc651+4\ud835\udc652\u22644\nx2_2 = lambda x1: (-3 * x1 + 11) / 2  # constraint 2: 3\ud835\udc651+2\ud835\udc652\u226411\n\n# Make plot\nplt.plot(x1, x2_1(x1), label=r\"$-3x_1 + 4x_2 \\leq 4$\")\nplt.plot(x1, x2_2(x1), label=r\"$3x_1 + 2x_2 \\leq 11$\")\nplt.xlim((0, 6))\nplt.ylim((0, 6))\nplt.xlabel(r\"$x_1$\")\nplt.ylabel(r\"$x_2$\")\n\n# Fill feasible region when Integer constraints are relaxed\nub = np.minimum(x2_1(x1), x2_2(x1))\nlb = np.zeros(len(x1))\nplt.fill_between(\n    x1,\n    lb,\n    ub,\n    where=ub > lb,\n    color=\"grey\",\n    alpha=0.5,\n    label=\"Convex Hull [feasible region (relaxed int constraints)]\",\n)\n\n# Get Feasible Integer Points\nfeasible = lambda x: np.alltrue(\n    [\n        np.alltrue(np.array([[-3, 4], [3, 2]]) @ x <= np.array([4, 11])),\n        np.alltrue(x >= 0),\n    ]\n)\nfeasible_integer_points = [\n    (i, j) for i in range(6) for j in range(6) if feasible(np.array([i, j]))\n]\nplt.scatter(*list(zip(*feasible_integer_points)), marker=\"X\", c=\"r\", s=100)\nfor x, y in feasible_integer_points:\n    label = f\"({x},{y})\"\n    plt.annotate(label, (x, y), textcoords=\"offset points\", xytext=(0, 10), ha=\"center\")\n\nplt.grid(True)\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.0)\nplt.show()";
                var nbb_formatted_code = "# Construct lines\nx1 = np.linspace(0, 6, 2000)  # x_1 >= 0\nx2_1 = lambda x1: (3 * x1 + 4) / 4  # constraint 1: \u22123\ud835\udc651+4\ud835\udc652\u22644\nx2_2 = lambda x1: (-3 * x1 + 11) / 2  # constraint 2: 3\ud835\udc651+2\ud835\udc652\u226411\n\n# Make plot\nplt.plot(x1, x2_1(x1), label=r\"$-3x_1 + 4x_2 \\leq 4$\")\nplt.plot(x1, x2_2(x1), label=r\"$3x_1 + 2x_2 \\leq 11$\")\nplt.xlim((0, 6))\nplt.ylim((0, 6))\nplt.xlabel(r\"$x_1$\")\nplt.ylabel(r\"$x_2$\")\n\n# Fill feasible region when Integer constraints are relaxed\nub = np.minimum(x2_1(x1), x2_2(x1))\nlb = np.zeros(len(x1))\nplt.fill_between(\n    x1,\n    lb,\n    ub,\n    where=ub > lb,\n    color=\"grey\",\n    alpha=0.5,\n    label=\"Convex Hull [feasible region (relaxed int constraints)]\",\n)\n\n# Get Feasible Integer Points\nfeasible = lambda x: np.alltrue(\n    [\n        np.alltrue(np.array([[-3, 4], [3, 2]]) @ x <= np.array([4, 11])),\n        np.alltrue(x >= 0),\n    ]\n)\nfeasible_integer_points = [\n    (i, j) for i in range(6) for j in range(6) if feasible(np.array([i, j]))\n]\nplt.scatter(*list(zip(*feasible_integer_points)), marker=\"X\", c=\"r\", s=100)\nfor x, y in feasible_integer_points:\n    label = f\"({x},{y})\"\n    plt.annotate(label, (x, y), textcoords=\"offset points\", xytext=(0, 10), ha=\"center\")\n\nplt.grid(True)\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.0)\nplt.show()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Integer points in Convex Hull X_hat of Dual Function: </span><span class="si">{</span><span class="n">feasible_integer_points</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Integer points in Convex Hull X_hat of Dual Function: [(0, 0), (0, 1), (1, 0), (1, 1), (2, 0), (2, 1), (2, 2), (3, 0), (3, 1)]
time: 367 µs
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 27;
                var nbb_unformatted_code = "print(\n    f\"Integer points in Convex Hull X_hat of Dual Function: {feasible_integer_points}\"\n)";
                var nbb_formatted_code = "print(\n    f\"Integer points in Convex Hull X_hat of Dual Function: {feasible_integer_points}\"\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="o">-</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;λ&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">[</span><span class="n">expr</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-5*λ, -6*λ - 1, -3*λ - 1, -4*λ - 2, -λ - 2, -2*λ - 3, -3*λ - 4, λ - 3, -4]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 3.95 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 28;
                var nbb_unformatted_code = "expr = lambda x1, x2: -x1 - x2 + symbols(\"\u03bb\") * (2 * x1 - x2 - 5)\n[expr(x1, x2) for x1, x2 in feasible_integer_points]";
                var nbb_formatted_code = "expr = lambda x1, x2: -x1 - x2 + symbols(\"\u03bb\") * (2 * x1 - x2 - 5)\n[expr(x1, x2) for x1, x2 in feasible_integer_points]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="amsmath math notranslate nohighlight" id="equation-26bc27b2-8ff5-4e0f-ae82-1af051e7fc97">
<span class="eqno">(437)<a class="headerlink" href="#equation-26bc27b2-8ff5-4e0f-ae82-1af051e7fc97" title="Permalink to this equation">¶</a></span>\[\begin{align}
    d(\lambda) &amp;= \underset{x\in\hat{X}}{\text{minimize }} -x_1 - x_2 + \lambda(-3x_1 + 4x_2 - 4) \\
    &amp;= \min\{ -5\lambda, -6\lambda - 1, -3\lambda - 1, -4\lambda - 2, -λ - 2, -2\lambda - 3, -3\lambda - 4, λ - 3, -4 \}\\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">1</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">λ</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">1</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">*</span><span class="p">[</span>
        <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">lambdify</span><span class="p">(</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;λ&quot;</span><span class="p">),</span> <span class="n">expr</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="s2">&quot;numpy&quot;</span><span class="p">)(</span><span class="n">λ</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span>
    <span class="p">],</span>
    <span class="n">λ</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal Solution for Lagrangian Dual Relaxation&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal value Z_dual is: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal solution is: λ = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">λ</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal Solution for Lagrangian Dual Relaxation
==============================
Status: optimal
The optimal value Z_dual is: -4.0
The optimal solution is: λ = -0.0
time: 24.9 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 29;
                var nbb_unformatted_code = "t = cp.Variable((1,), integer=False)\n\u03bb = cp.Variable((1,), integer=False)\nconstraints = [\n    *[\n        t <= lambdify(symbols(\"\u03bb\"), expr(x1, x2), \"numpy\")(\u03bb)\n        for x1, x2 in feasible_integer_points\n    ],\n    \u03bb >= 0,\n]\nobj = cp.Maximize(t)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Optimal Solution for Lagrangian Dual Relaxation\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value Z_dual is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: \u03bb = {np.round(\u03bb.value[0], 2)}\")";
                var nbb_formatted_code = "t = cp.Variable((1,), integer=False)\n\u03bb = cp.Variable((1,), integer=False)\nconstraints = [\n    *[\n        t <= lambdify(symbols(\"\u03bb\"), expr(x1, x2), \"numpy\")(\u03bb)\n        for x1, x2 in feasible_integer_points\n    ],\n    \u03bb >= 0,\n]\nobj = cp.Maximize(t)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Optimal Solution for Lagrangian Dual Relaxation\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value Z_dual is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: \u03bb = {np.round(\u03bb.value[0], 2)}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<hr class="docutils" />
<ul class="simple">
<li><p>Consider the integer program:</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-7de314d4-e0b4-497d-b986-effa22e4e342">
<span class="eqno">(438)<a class="headerlink" href="#equation-7de314d4-e0b4-497d-b986-effa22e4e342" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \underset{x}{\text{maximize }}\qquad&amp;x_1 + 2x_2 \\
    \text{subject to }\qquad&amp;x_1 + x_2 \leq 5 \\
    &amp;x_1 - 3x_2 \leq -4 \\
    &amp;x_1 \geq 1 \\
    &amp;x_1 - x_2 \leq 0 \\
    \text{and }\qquad&amp;x_1, x_2 \geq 0 \text{ and integer}. \\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sanity Check</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
    <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear Programming Solution&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal value is: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal solution is: x = </span><span class="si">{</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Programming Solution
==============================
Status: optimal
The optimal value is: 9.0
The optimal solution is: x = [1.0, 4.0]
time: 9.27 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 30;
                var nbb_unformatted_code = "# Sanity Check\nx = cp.Variable((2,), integer=True)\nconstraints = [\n    np.array([[1, 1], [1, -3], [-1, 0], [1, -1]]) @ x <= np.array([5, -4, -1, 0]),\n    x >= 0,\n]\nobj = cp.Maximize(np.array([1, 2]) @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_formatted_code = "# Sanity Check\nx = cp.Variable((2,), integer=True)\nconstraints = [\n    np.array([[1, 1], [1, -3], [-1, 0], [1, -1]]) @ x <= np.array([5, -4, -1, 0]),\n    x >= 0,\n]\nobj = cp.Maximize(np.array([1, 2]) @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct lines</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>  <span class="c1"># x_1 &gt;= 0</span>
<span class="n">x2_1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">:</span> <span class="o">-</span><span class="n">x1</span> <span class="o">+</span> <span class="mi">5</span>  <span class="c1"># constraint 1: 𝑥1+𝑥2≤5</span>
<span class="n">x2_2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">:</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>  <span class="c1"># constraint 2: 𝑥1−3𝑥2≤−4</span>
<span class="n">x2_3</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>  <span class="c1"># constraint 3: x_1 &gt;= 1</span>
<span class="n">x2_4</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">:</span> <span class="n">x1</span>  <span class="c1"># constraint 4: 𝑥1−𝑥2≤0</span>

<span class="c1"># Make plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2_1</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$x_1 + x_2 \leq 5$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2_2</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$x_1 - 3x_2 \leq -4$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">x1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$x_1 \geq 1$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2_4</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$x_1 - x_2 \leq 0$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>

<span class="c1"># Fill feasible region</span>
<span class="n">ub</span> <span class="o">=</span> <span class="n">x2_1</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2000</span><span class="p">))</span>
<span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">x2_2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)),</span> <span class="n">x2_4</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">ub</span> <span class="o">&gt;</span> <span class="n">lb</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span>
<span class="p">)</span>

<span class="c1"># Get Feasible Integer Points</span>
<span class="n">feasible</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span>
            <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">feasible_integer_points</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">if</span> <span class="n">feasible</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]))</span>
<span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">feasible_integer_points</span><span class="p">)),</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span><span class="p">:</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/hw9_57_0.png" src="../../_images/hw9_57_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 1.55 s
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 31;
                var nbb_unformatted_code = "# Construct lines\nx1 = np.linspace(0, 5, 2000)  # x_1 >= 0\nx2_1 = lambda x1: -x1 + 5  # constraint 1: \ud835\udc651+\ud835\udc652\u22645\nx2_2 = lambda x1: (x1 + 4) / 3  # constraint 2: \ud835\udc651\u22123\ud835\udc652\u2264\u22124\nx2_3 = lambda x1: [1] * len(x1)  # constraint 3: x_1 >= 1\nx2_4 = lambda x1: x1  # constraint 4: \ud835\udc651\u2212\ud835\udc652\u22640\n\n# Make plot\nplt.plot(x1, x2_1(x1), label=r\"$x_1 + x_2 \\leq 5$\")\nplt.plot(x1, x2_2(x1), label=r\"$x_1 - 3x_2 \\leq -4$\")\nplt.plot([1] * len(x1), x1, label=r\"$x_1 \\geq 1$\")\nplt.plot(x1, x2_4(x1), label=r\"$x_1 - x_2 \\leq 0$\")\nplt.xlim((0, 5))\nplt.ylim((0, 5))\nplt.xlabel(r\"$x_1$\")\nplt.ylabel(r\"$x_2$\")\n\n# Fill feasible region\nub = x2_1(np.linspace(1, 5, 2000))\nlb = np.maximum(x2_2(np.linspace(1, 5, 2000)), x2_4(np.linspace(1, 5, 2000)))\nplt.fill_between(\n    np.linspace(1, 5, 2000), lb, ub, where=ub > lb, color=\"grey\", alpha=0.5\n)\n\n# Get Feasible Integer Points\nfeasible = lambda x: np.alltrue(\n    [\n        np.alltrue(\n            np.array([[1, 1], [1, -3], [-1, 0], [1, -1]]) @ x\n            <= np.array([5, -4, -1, 0])\n        ),\n        np.alltrue(x >= 0),\n    ]\n)\nfeasible_integer_points = [\n    (i, j) for i in range(5) for j in range(5) if feasible(np.array([i, j]))\n]\nplt.scatter(*list(zip(*feasible_integer_points)), marker=\"X\", c=\"r\", s=100)\nfor x, y in feasible_integer_points:\n    label = f\"({x},{y})\"\n    plt.annotate(label, (x, y), textcoords=\"offset points\", xytext=(0, 10), ha=\"center\")\n\nplt.grid(True)\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.0)\nplt.show()";
                var nbb_formatted_code = "# Construct lines\nx1 = np.linspace(0, 5, 2000)  # x_1 >= 0\nx2_1 = lambda x1: -x1 + 5  # constraint 1: \ud835\udc651+\ud835\udc652\u22645\nx2_2 = lambda x1: (x1 + 4) / 3  # constraint 2: \ud835\udc651\u22123\ud835\udc652\u2264\u22124\nx2_3 = lambda x1: [1] * len(x1)  # constraint 3: x_1 >= 1\nx2_4 = lambda x1: x1  # constraint 4: \ud835\udc651\u2212\ud835\udc652\u22640\n\n# Make plot\nplt.plot(x1, x2_1(x1), label=r\"$x_1 + x_2 \\leq 5$\")\nplt.plot(x1, x2_2(x1), label=r\"$x_1 - 3x_2 \\leq -4$\")\nplt.plot([1] * len(x1), x1, label=r\"$x_1 \\geq 1$\")\nplt.plot(x1, x2_4(x1), label=r\"$x_1 - x_2 \\leq 0$\")\nplt.xlim((0, 5))\nplt.ylim((0, 5))\nplt.xlabel(r\"$x_1$\")\nplt.ylabel(r\"$x_2$\")\n\n# Fill feasible region\nub = x2_1(np.linspace(1, 5, 2000))\nlb = np.maximum(x2_2(np.linspace(1, 5, 2000)), x2_4(np.linspace(1, 5, 2000)))\nplt.fill_between(\n    np.linspace(1, 5, 2000), lb, ub, where=ub > lb, color=\"grey\", alpha=0.5\n)\n\n# Get Feasible Integer Points\nfeasible = lambda x: np.alltrue(\n    [\n        np.alltrue(\n            np.array([[1, 1], [1, -3], [-1, 0], [1, -1]]) @ x\n            <= np.array([5, -4, -1, 0])\n        ),\n        np.alltrue(x >= 0),\n    ]\n)\nfeasible_integer_points = [\n    (i, j) for i in range(5) for j in range(5) if feasible(np.array([i, j]))\n]\nplt.scatter(*list(zip(*feasible_integer_points)), marker=\"X\", c=\"r\", s=100)\nfor x, y in feasible_integer_points:\n    label = f\"({x},{y})\"\n    plt.annotate(label, (x, y), textcoords=\"offset points\", xytext=(0, 10), ha=\"center\")\n\nplt.grid(True)\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.0)\nplt.show()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>(a) Construct the convex hull of the feasible integer solutions and derive an optimal solution graphically.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Integer points in Convex Hull of the feasible integer solutions: </span><span class="si">{</span><span class="n">feasible_integer_points</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Integer points in Convex Hull of the feasible integer solutions: [(1, 2), (1, 3), (1, 4), (2, 2), (2, 3)]
time: 376 µs
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 32;
                var nbb_unformatted_code = "print(\n    f\"Integer points in Convex Hull of the feasible integer solutions: {feasible_integer_points}\"\n)";
                var nbb_formatted_code = "print(\n    f\"Integer points in Convex Hull of the feasible integer solutions: {feasible_integer_points}\"\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feasible_integer_points</span><span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span>
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span><span class="p">]</span>
    <span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 4)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 1.68 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 33;
                var nbb_unformatted_code = "feasible_integer_points[\n    np.argmax(\n        [np.array([1, 2]) @ np.array([x1, x2]) for x1, x2 in feasible_integer_points]\n    )\n]";
                var nbb_formatted_code = "feasible_integer_points[\n    np.argmax(\n        [np.array([1, 2]) @ np.array([x1, x2]) for x1, x2 in feasible_integer_points]\n    )\n]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>Going through each integer feasible solution and passing the values through the objective function, we get that the optimal objective value for the integer linear program is 9 and the solution is <span class="math notranslate nohighlight">\(x_1 = 1, x_2 = 4\)</span>.</p>
<p>(b) Solve the linear program relaxation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
    <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear Programming Solution&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal value is: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal solution is: x = </span><span class="si">{</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Programming Solution
==============================
Status: optimal
The optimal value is: 9.0
The optimal solution is: x = [1.0, 4.0]
time: 8.31 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 34;
                var nbb_unformatted_code = "x = cp.Variable((2,), integer=False)\nconstraints = [\n    np.array([[1, 1], [1, -3], [-1, 0], [1, -1]]) @ x <= np.array([5, -4, -1, 0]),\n    x >= 0,\n]\nobj = cp.Maximize(np.array([1, 2]) @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_formatted_code = "x = cp.Variable((2,), integer=False)\nconstraints = [\n    np.array([[1, 1], [1, -3], [-1, 0], [1, -1]]) @ x <= np.array([5, -4, -1, 0]),\n    x >= 0,\n]\nobj = cp.Maximize(np.array([1, 2]) @ x)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Linear Programming Solution\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: x = {[np.round(x_i, 2) for x_i in x.value]}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>The Linear Program gives the same solution as the Integer Linear Program because the optimal solution exists on the vertex of the convex hull of the linear program and is also integral.</p>
<p>(c) Solve by Lagrangian relaxation of the first constraint.</p>
<div class="amsmath math notranslate nohighlight" id="equation-f31b92c3-30a5-49c2-b74f-b695f04f7250">
<span class="eqno">(439)<a class="headerlink" href="#equation-f31b92c3-30a5-49c2-b74f-b695f04f7250" title="Permalink to this equation">¶</a></span>\[\begin{align}
    d(\lambda) = \underset{x}{\text{minimize }}\qquad&amp;-x_1 - 2x_2 + \lambda(x_1 + x_2 - 5)\\
    \text{subject to }\qquad&amp;x_1 - 3x_2 + 4 \leq 0 \\
    &amp;-x_1 + 1 \leq 0 \\
    &amp;x_1 - x_2 \leq 0 \\
    \text{and }\qquad&amp;x_1, x_2 \geq 0 \text{ and integer}. \\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct lines</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>  <span class="c1"># x_1 &gt;= 0</span>
<span class="n">x2_2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">:</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>  <span class="c1"># constraint 2: 𝑥1−3𝑥2≤−4</span>
<span class="n">x2_3</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>  <span class="c1"># constraint 3: x_1 &gt;= 1</span>
<span class="n">x2_4</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">:</span> <span class="n">x1</span>  <span class="c1"># constraint 4: 𝑥1−𝑥2≤0</span>

<span class="c1"># Make plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2_2</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$x_1 - 3x_2 \leq -4$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">x1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$x_1 \geq 1$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2_4</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$x_1 - x_2 \leq 0$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>

<span class="c1"># Fill feasible region</span>
<span class="n">ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2000</span><span class="p">)</span>
<span class="n">lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">x2_2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)),</span> <span class="n">x2_4</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">ub</span> <span class="o">&gt;</span> <span class="n">lb</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span>
<span class="p">)</span>

<span class="c1"># Get Feasible Integer Points</span>
<span class="n">feasible</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">feasible_integer_points</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">if</span> <span class="n">feasible</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]))</span>
<span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">feasible_integer_points</span><span class="p">)),</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span><span class="p">:</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/hw9_67_0.png" src="../../_images/hw9_67_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 1.64 s
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 35;
                var nbb_unformatted_code = "# Construct lines\nx1 = np.linspace(0, 5, 2000)  # x_1 >= 0\nx2_2 = lambda x1: (x1 + 4) / 3  # constraint 2: \ud835\udc651\u22123\ud835\udc652\u2264\u22124\nx2_3 = lambda x1: [1] * len(x1)  # constraint 3: x_1 >= 1\nx2_4 = lambda x1: x1  # constraint 4: \ud835\udc651\u2212\ud835\udc652\u22640\n\n# Make plot\nplt.plot(x1, x2_2(x1), label=r\"$x_1 - 3x_2 \\leq -4$\")\nplt.plot([1] * len(x1), x1, label=r\"$x_1 \\geq 1$\")\nplt.plot(x1, x2_4(x1), label=r\"$x_1 - x_2 \\leq 0$\")\nplt.xlim((0, 5))\nplt.ylim((0, 5))\nplt.xlabel(r\"$x_1$\")\nplt.ylabel(r\"$x_2$\")\n\n# Fill feasible region\nub = np.array([5] * 2000)\nlb = np.maximum(x2_2(np.linspace(1, 5, 2000)), x2_4(np.linspace(1, 5, 2000)))\nplt.fill_between(\n    np.linspace(1, 5, 2000), lb, ub, where=ub > lb, color=\"grey\", alpha=0.5\n)\n\n# Get Feasible Integer Points\nfeasible = lambda x: np.alltrue(\n    [\n        np.alltrue(np.array([[1, -3], [-1, 0], [1, -1]]) @ x <= np.array([-4, -1, 0])),\n        np.alltrue(x >= 0),\n    ]\n)\nfeasible_integer_points = [\n    (i, j) for i in range(6) for j in range(6) if feasible(np.array([i, j]))\n]\nplt.scatter(*list(zip(*feasible_integer_points)), marker=\"X\", c=\"r\", s=100)\nfor x, y in feasible_integer_points:\n    label = f\"({x},{y})\"\n    plt.annotate(label, (x, y), textcoords=\"offset points\", xytext=(0, 10), ha=\"center\")\n\nplt.grid(True)\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.0)\nplt.show()";
                var nbb_formatted_code = "# Construct lines\nx1 = np.linspace(0, 5, 2000)  # x_1 >= 0\nx2_2 = lambda x1: (x1 + 4) / 3  # constraint 2: \ud835\udc651\u22123\ud835\udc652\u2264\u22124\nx2_3 = lambda x1: [1] * len(x1)  # constraint 3: x_1 >= 1\nx2_4 = lambda x1: x1  # constraint 4: \ud835\udc651\u2212\ud835\udc652\u22640\n\n# Make plot\nplt.plot(x1, x2_2(x1), label=r\"$x_1 - 3x_2 \\leq -4$\")\nplt.plot([1] * len(x1), x1, label=r\"$x_1 \\geq 1$\")\nplt.plot(x1, x2_4(x1), label=r\"$x_1 - x_2 \\leq 0$\")\nplt.xlim((0, 5))\nplt.ylim((0, 5))\nplt.xlabel(r\"$x_1$\")\nplt.ylabel(r\"$x_2$\")\n\n# Fill feasible region\nub = np.array([5] * 2000)\nlb = np.maximum(x2_2(np.linspace(1, 5, 2000)), x2_4(np.linspace(1, 5, 2000)))\nplt.fill_between(\n    np.linspace(1, 5, 2000), lb, ub, where=ub > lb, color=\"grey\", alpha=0.5\n)\n\n# Get Feasible Integer Points\nfeasible = lambda x: np.alltrue(\n    [\n        np.alltrue(np.array([[1, -3], [-1, 0], [1, -1]]) @ x <= np.array([-4, -1, 0])),\n        np.alltrue(x >= 0),\n    ]\n)\nfeasible_integer_points = [\n    (i, j) for i in range(6) for j in range(6) if feasible(np.array([i, j]))\n]\nplt.scatter(*list(zip(*feasible_integer_points)), marker=\"X\", c=\"r\", s=100)\nfor x, y in feasible_integer_points:\n    label = f\"({x},{y})\"\n    plt.annotate(label, (x, y), textcoords=\"offset points\", xytext=(0, 10), ha=\"center\")\n\nplt.grid(True)\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.0)\nplt.show()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Integer points in Convex Hull X_hat of Dual Function: </span><span class="si">{</span><span class="n">feasible_integer_points</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Integer points in Convex Hull X_hat of Dual Function: [(1, 2), (1, 3), (1, 4), (1, 5), (2, 2), (2, 3), (2, 4), (2, 5), (3, 3), (3, 4), (3, 5), (4, 4), (4, 5), (5, 5)]
time: 409 µs
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 36;
                var nbb_unformatted_code = "print(\n    f\"Integer points in Convex Hull X_hat of Dual Function: {feasible_integer_points}\"\n)";
                var nbb_formatted_code = "print(\n    f\"Integer points in Convex Hull X_hat of Dual Function: {feasible_integer_points}\"\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span> <span class="o">-</span><span class="n">x1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;λ&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">[</span><span class="n">expr</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-2*λ - 5,
 -λ - 7,
 -9,
 λ - 11,
 -λ - 6,
 -8,
 λ - 10,
 2*λ - 12,
 λ - 9,
 2*λ - 11,
 3*λ - 13,
 3*λ - 12,
 4*λ - 14,
 5*λ - 15]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 7.85 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 37;
                var nbb_unformatted_code = "expr = lambda x1, x2: -x1 - 2 * x2 + symbols(\"\u03bb\") * (x1 + x2 - 5)\n[expr(x1, x2) for x1, x2 in feasible_integer_points]";
                var nbb_formatted_code = "expr = lambda x1, x2: -x1 - 2 * x2 + symbols(\"\u03bb\") * (x1 + x2 - 5)\n[expr(x1, x2) for x1, x2 in feasible_integer_points]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="amsmath math notranslate nohighlight" id="equation-b2d98dff-4c93-4714-bbdc-85b77afc6178">
<span class="eqno">(440)<a class="headerlink" href="#equation-b2d98dff-4c93-4714-bbdc-85b77afc6178" title="Permalink to this equation">¶</a></span>\[\begin{align}
    d(\lambda) &amp;= \underset{x\in\hat{X}}{\text{minimize }} -x_1 - x_2 + \lambda(-3x_1 + 4x_2 - 4) \\
    &amp;= \min\{ 
    -2\lambda - 5,
    -λ - 7,
    -9,
    λ - 11,
    -λ - 6,
    -8,
    λ - 10,
    2\lambda - 12,
    λ - 9,
    2\lambda - 11,
    3\lambda - 13,
    3\lambda - 12,
    4\lambda - 14,
    5\lambda - 15, \cdots
    \}\\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">1</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">λ</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="mi">1</span><span class="p">,),</span> <span class="n">integer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">*</span><span class="p">[</span>
        <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">lambdify</span><span class="p">(</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;λ&quot;</span><span class="p">),</span> <span class="n">expr</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="s2">&quot;numpy&quot;</span><span class="p">)(</span><span class="n">λ</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span>
    <span class="p">],</span>
    <span class="n">λ</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal Solution for Lagrangian Dual Relaxation&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Status: </span><span class="si">{</span><span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal value Z_dual is: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The optimal solution is: λ = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">λ</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal Solution for Lagrangian Dual Relaxation
==============================
Status: optimal
The optimal value Z_dual is: -9.0
The optimal solution is: λ = 2.0
time: 40.9 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 38;
                var nbb_unformatted_code = "t = cp.Variable((1,), integer=False)\n\u03bb = cp.Variable((1,), integer=False)\nconstraints = [\n    *[\n        t <= lambdify(symbols(\"\u03bb\"), expr(x1, x2), \"numpy\")(\u03bb)\n        for x1, x2 in feasible_integer_points\n    ],\n    \u03bb >= 0,\n]\nobj = cp.Maximize(t)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Optimal Solution for Lagrangian Dual Relaxation\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value Z_dual is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: \u03bb = {np.round(\u03bb.value[0], 2)}\")";
                var nbb_formatted_code = "t = cp.Variable((1,), integer=False)\n\u03bb = cp.Variable((1,), integer=False)\nconstraints = [\n    *[\n        t <= lambdify(symbols(\"\u03bb\"), expr(x1, x2), \"numpy\")(\u03bb)\n        for x1, x2 in feasible_integer_points\n    ],\n    \u03bb >= 0,\n]\nobj = cp.Maximize(t)\nprob = cp.Problem(obj, constraints)\nprob.solve()\n\nprint(\"Optimal Solution for Lagrangian Dual Relaxation\")\nprint(\"=\" * 30)\nprint(f\"Status: {prob.status}\")\nprint(f\"The optimal value Z_dual is: {np.round(prob.value, 2)}\")\nprint(f\"The optimal solution is: \u03bb = {np.round(\u03bb.value[0], 2)}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Integer Points associated with Optimal Dual Function in Convex Hull of Feasible Set of Lagrangian-relaxed problem: &quot;</span>
<span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">feasible_integer_points</span><span class="p">)[</span>
    <span class="nb">list</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">lambdify</span><span class="p">(</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;λ&quot;</span><span class="p">),</span> <span class="n">expr</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="s2">&quot;numpy&quot;</span><span class="p">)(</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="n">feasible_integer_points</span>
                <span class="p">],</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">feasible_integer_points</span><span class="p">)),</span>
            <span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Integer Points associated with Optimal Dual Function in Convex Hull of Feasible Set of Lagrangian-relaxed problem: 
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 2],
       [1, 3],
       [1, 4],
       [1, 5]])
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time: 12.1 ms
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 39;
                var nbb_unformatted_code = "print(\n    \"Integer Points associated with Optimal Dual Function in Convex Hull of Feasible Set of Lagrangian-relaxed problem: \"\n)\nnp.array(feasible_integer_points)[\n    list(\n        np.argwhere(\n            np.isclose(\n                [\n                    lambdify(symbols(\"\u03bb\"), expr(x1, x2), \"numpy\")(2)\n                    for x1, x2 in feasible_integer_points\n                ],\n                np.array([-9] * len(feasible_integer_points)),\n            )\n        ).flatten()\n    )\n]";
                var nbb_formatted_code = "print(\n    \"Integer Points associated with Optimal Dual Function in Convex Hull of Feasible Set of Lagrangian-relaxed problem: \"\n)\nnp.array(feasible_integer_points)[\n    list(\n        np.argwhere(\n            np.isclose(\n                [\n                    lambdify(symbols(\"\u03bb\"), expr(x1, x2), \"numpy\")(2)\n                    for x1, x2 in feasible_integer_points\n                ],\n                np.array([-9] * len(feasible_integer_points)),\n            )\n        ).flatten()\n    )\n]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./course-work/ise-530"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="hw8.html" title="previous page">HW 8</a>
    <a class='right-next' id="next-link" href="midterm.html" title="next page">Midterm</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Chengyi (Jeff) Chen<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>
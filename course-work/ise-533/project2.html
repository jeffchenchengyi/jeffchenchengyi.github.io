
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Project 2: Multi-location Transshipment Problem &#8212; ΨΦ</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/default.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://jeffchenchengyi.github.io/course-work/ise-533/project2.html" />
    <link rel="shortcut icon" href="../../_static/jeffchenchengyi2019.jpg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ISE-537: Financial Analytics" href="../ise-537/intro.html" />
    <link rel="prev" title="Project 1: Group Restaurants Choice" href="project1.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://jeffchenchengyi.github.io/course-work/ise-533/project2.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Project 2: Multi-location Transshipment Problem" />
<meta property="og:description" content="Project 2: Multi-location Transshipment Problem  In this project, we compare Stochastic Gradient Descent Vs. Bender’s Decomposition in optimizing a Two-Stage St" />
<meta property="og:image"       content="https://jeffchenchengyi.github.io/_static/jeffchenchengyi2019.jpg" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/jeffchenchengyi2019.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">ΨΦ</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Machine Learning Notes
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../notes/ml-ifaqs.html">
   Infrequently Asked Questions in ML
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notes/uplift-modelling-and-contextual-bandits.html">
   Uplift Modelling and Contextual Bandits
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../notes/probabilistic-machine-learning/00-objective.html">
   Probabilistic Machine Learning
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../notes/probabilistic-machine-learning/01-frequentist-bayesian.html">
     Frequentist Vs. Bayesian Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../notes/probabilistic-machine-learning/02-finding-the-posterior.html">
     Finding the Posterior of Latent Variables
     <span class="math notranslate nohighlight">
      \(\mathcal{Z}\)
     </span>
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Personal Projects
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../projects/bayesian-contextual-bandits.html">
   Bayesian Contextual Bandits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../projects/wtte-rnn-pyro.html">
   Weibull Time To Event Recurrent Neural Net in Pyro
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Featured Course Work &amp; Extra-curriculars
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../ise-562/intro.html">
   ISE-562 Decision Analysis
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-562/lab_assignment.html">
     Certain Equivalents and Sensitivity Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-562/midterm.html">
     Mid Term Part (2): Individual Assignment: Tornado Diagrams and Bidding
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="intro.html">
   ISE-533 Integrative Analytics
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="hw1.html">
     HW 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw2.html">
     HW 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="project1.html">
     Project 1: Group Restaurants Choice
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Project 2: Multi-location Transshipment Problem
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../ise-537/intro.html">
   ISE-537 Financial Analytics
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-537/hw1.html">
     HW 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-537/hw2_part1.html">
     HW 2 Part 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-537/hw2_part2.html">
     HW 2 Part 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-537/hw3.html">
     HW 3
    </a>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../ise-537/market-observations.html">
     Market Observations
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/market-observations-week-1.html">
       MO 1: TSLA Absurd P/E Ratio
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/market-observations-week-2.html">
       MO 2: The NASDAQ Whale
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/market-observations-week-3.html">
       MO 4: Dovish till 2024
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/market-observations-week-4.html">
       MO 4: The Future of EV batteries
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/market-observations-week-5.html">
       MO 5: Palantir
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../ise-537/paper-reviews.html">
     Paper Reviews
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/paper-review-1.html">
       Paper Review 1: Value and Momentum Everywhere
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/paper-review-2.html">
       Paper Review 2: Carry
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/paper-review-3.html">
       Paper Review 3: Quality Minus Junk
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/paper-review-4.html">
       Paper Review 4: Size Matters, if You Control Your Junk
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../ise-537/paper-review-5.html">
       Paper Review 5: The Low-Risk Anomaly: A Decomposition into Micro and Macro Effects
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-537/project1.html">
     Project 1: Momentum Strategies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-537/project2.html">
     Project 2: Carry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-537/notes.html">
     Notes
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../ise-530/intro.html">
   ISE-530 Optimization Analytics
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-530/hw1.html">
     HW 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-530/hw2.html">
     HW 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-530/hw3.html">
     HW 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-530/hw4.html">
     HW 4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-530/hw5.html">
     HW 5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-530/hw6.html">
     HW 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-530/hw7.html">
     HW 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-530/hw8.html">
     HW 8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-530/hw9.html">
     HW 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-530/midterm.html">
     Midterm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-530/final.html">
     Final
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ise-530/notes.html">
     Summary
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../csci-499/intro.html">
   CSCI-499 AI for Social Good
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../csci-499/paper-reviews.html">
     Paper Reviews
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-1.html">
       Paper Review 1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-2.html">
       Paper Review 2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-3.html">
       Paper Review 3
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-4.html">
       Paper Review 4
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-5.html">
       Paper Review 5
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-6.html">
       Paper Review 6
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-7.html">
       Paper Review 7
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../csci-499/paper-review-8.html">
       Paper Review 8
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://docs.google.com/presentation/d/1MqA1jPrUw2UUTnQBGHqH-_Y3FCcOgsUGoCG1LNnCvZY/edit?usp=sharing">
     Paper Review Presentation
     <i class="fas fa-external-link-alt">
     </i>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://github.com/lucashu1/education-deserts">
     Education Deserts Research
     <i class="fas fa-external-link-alt">
     </i>
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../cais%2B%2B/intro.html">
   CAIS++
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference external" href="https://github.com/pelillian/varro">
     Evolving FPGAs for Accelerated MachineLearning on Bare Metal
     <i class="fas fa-external-link-alt">
     </i>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference external" href="https://github.com/usc-caisplusplus/SLAB">
     OCR Research on Google Street View Panoramics
     <i class="fas fa-external-link-alt">
     </i>
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../udacity/exploring-house-prices-singapore-part-3-crispdm.html">
   Udacity Data Scientist Nanodegree - Exploring House Prices in Singapore
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://graduation.udacity.com/confirm/2LGCCKNA">
   Udacity Data Scientist Nanodegree Certificate
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://drive.google.com/file/d/1DQ7wcOU5jEdVMOMbm2xdZ8k7rF1if2yT/view?usp=sharing">
   Chengyi (Jeff) Chen's Resume
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/jeffchenchengyi/">
   GitHub
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/course-work/ise-533/project2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/jeffchenchengyi/jeffchenchengyi.github.io"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preface">
   1. Preface
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-two-stage-stochastic-program">
     1.1. General Two-Stage Stochastic Program
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#first-stage-stochastic-program">
       1.1.1 First Stage Stochastic Program
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#second-stage-stochastic-program">
       1.1.2 Second Stage Stochastic Program
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-stage-stochastic-linear-program">
     1.2. Two-Stage Stochastic Linear Program
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#first-stage-stochastic-linear-program">
       1.2.1 First Stage Stochastic Linear Program
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#second-stage-stochastic-linear-program">
       1.2.2 Second Stage Stochastic Linear Program
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-stage-stochastic-linear-program-with-discretized-scenario-distribution">
     1.3. Two-Stage Stochastic Linear Program with Discretized Scenario Distribution
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#first-stage-stochastic-linear-program-with-discretized-scenario-distribution">
       1.3.1 First Stage Stochastic Linear Program with Discretized Scenario Distribution
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#second-stage-stochastic-linear-program-with-discretized-scenario-distribution">
       1.3.2 Second Stage Stochastic Linear Program with Discretized Scenario Distribution
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#method-stochastic-gradient-descent">
   2. Method: Stochastic Gradient Descent
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#l-shaped-bender-s-method">
   3. L-Shaped / Bender’s Method
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-stage-multi-location-transshipment-problem">
   4. Two-stage Multi-location Transshipment Problem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-setup">
     4.1. Problem Setup
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       4.1.1 First Stage Stochastic Linear Program
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       4.1.2 Second Stage Stochastic Linear Program
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stochastic-gradient-descent">
     4.2. Stochastic Gradient Descent
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#benders">
     4.3. Benders
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stochastic-gradient-descent-vs-benders">
     4.4. Stochastic Gradient Descent Vs. Benders
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#comparing-mean-optimal-order-up-to-quantities">
       4.4.1 Comparing Mean(Optimal Order-Up-To Quantities)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#conclusion">
       4.4.2 Conclusion
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="project-2-multi-location-transshipment-problem">
<h1>Project 2: Multi-location Transshipment Problem<a class="headerlink" href="#project-2-multi-location-transshipment-problem" title="Permalink to this headline">¶</a></h1>
<p>In this project, we compare Stochastic Gradient Descent Vs. Bender’s Decomposition in optimizing a Two-Stage Stochastic LP.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install autotime
<span class="o">!</span>pip install nb-black
<span class="o">!</span>pip install cvxpy
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting autotime
  Using cached autotime-0.1.5-py3-none-any.whl (46 kB)
Requirement already satisfied: statsmodels&gt;=0.11.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from autotime) (0.12.2)
Requirement already satisfied: plotly&gt;=4.5.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from autotime) (4.14.3)
Requirement already satisfied: scikit-learn&gt;=0.22.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from autotime) (0.24.2)
Requirement already satisfied: seaborn&gt;=0.9.0 in /home/fpga/.local/lib/python3.7/site-packages (from autotime) (0.11.0)
Requirement already satisfied: pandas==0.25.3 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from autotime) (0.25.3)
Collecting dnntime&gt;=0.3.4
  Using cached dnntime-0.4.1-py3-none-any.whl (47 kB)
Requirement already satisfied: numpy&gt;=1.18 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from autotime) (1.20.2)
Requirement already satisfied: art&gt;=4.5 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from autotime) (5.1)
Collecting fbprophet&gt;=0.5
  Using cached fbprophet-0.7.1.tar.gz (64 kB)
Requirement already satisfied: tscv&gt;=0.0.4 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from autotime) (0.1.2)
Requirement already satisfied: matplotlib&gt;=3.1.3 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from autotime) (3.4.1)
Collecting pyflux&gt;=0.4.0
  Using cached pyflux-0.4.15.tar.gz (1.3 MB)
Requirement already satisfied: scipy&gt;=1.1 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from statsmodels&gt;=0.11.0-&gt;autotime) (1.6.3)
Requirement already satisfied: patsy&gt;=0.5 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from statsmodels&gt;=0.11.0-&gt;autotime) (0.5.1)
Requirement already satisfied: six in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from plotly&gt;=4.5.0-&gt;autotime) (1.15.0)
Requirement already satisfied: retrying&gt;=1.3.3 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from plotly&gt;=4.5.0-&gt;autotime) (1.3.3)
Requirement already satisfied: joblib&gt;=0.11 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from scikit-learn&gt;=0.22.0-&gt;autotime) (1.0.1)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from scikit-learn&gt;=0.22.0-&gt;autotime) (2.1.0)
Requirement already satisfied: python-dateutil&gt;=2.6.1 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from pandas==0.25.3-&gt;autotime) (2.8.1)
Requirement already satisfied: pytz&gt;=2017.2 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from pandas==0.25.3-&gt;autotime) (2021.1)
Requirement already satisfied: nbformat&gt;=5.0.4 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from dnntime&gt;=0.3.4-&gt;autotime) (5.1.3)
Requirement already satisfied: tensorflow&gt;=2.1.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from dnntime&gt;=0.3.4-&gt;autotime) (2.4.1)
Requirement already satisfied: pyyaml&gt;=5.3 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from dnntime&gt;=0.3.4-&gt;autotime) (5.4.1)
Requirement already satisfied: Cython&gt;=0.22 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from fbprophet&gt;=0.5-&gt;autotime) (0.29.23)
Requirement already satisfied: cmdstanpy==0.9.5 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from fbprophet&gt;=0.5-&gt;autotime) (0.9.5)
Requirement already satisfied: pystan&gt;=2.14 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from fbprophet&gt;=0.5-&gt;autotime) (3.0.2)
Requirement already satisfied: LunarCalendar&gt;=0.0.9 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from fbprophet&gt;=0.5-&gt;autotime) (0.0.9)
Requirement already satisfied: convertdate&gt;=2.1.2 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from fbprophet&gt;=0.5-&gt;autotime) (2.3.2)
Requirement already satisfied: holidays&gt;=0.10.2 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from fbprophet&gt;=0.5-&gt;autotime) (0.11.1)
Requirement already satisfied: setuptools-git&gt;=1.2 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from fbprophet&gt;=0.5-&gt;autotime) (1.2)
Requirement already satisfied: tqdm&gt;=4.36.1 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from fbprophet&gt;=0.5-&gt;autotime) (4.60.0)
Requirement already satisfied: cycler&gt;=0.10 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from matplotlib&gt;=3.1.3-&gt;autotime) (0.10.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from matplotlib&gt;=3.1.3-&gt;autotime) (1.3.1)
Requirement already satisfied: pillow&gt;=6.2.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from matplotlib&gt;=3.1.3-&gt;autotime) (8.2.0)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from matplotlib&gt;=3.1.3-&gt;autotime) (2.4.7)
Requirement already satisfied: numdifftools in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from pyflux&gt;=0.4.0-&gt;autotime) (0.9.39)
Requirement already satisfied: ipython-genutils in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from nbformat&gt;=5.0.4-&gt;dnntime&gt;=0.3.4-&gt;autotime) (0.2.0)
Requirement already satisfied: jsonschema!=2.5.0,&gt;=2.4 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from nbformat&gt;=5.0.4-&gt;dnntime&gt;=0.3.4-&gt;autotime) (3.2.0)
Requirement already satisfied: traitlets&gt;=4.1 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from nbformat&gt;=5.0.4-&gt;dnntime&gt;=0.3.4-&gt;autotime) (5.0.5)
Requirement already satisfied: jupyter-core in /home/fpga/.local/lib/python3.7/site-packages (from nbformat&gt;=5.0.4-&gt;dnntime&gt;=0.3.4-&gt;autotime) (4.7.0)
Requirement already satisfied: typing-extensions~=3.7.4 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (3.7.4.3)
Requirement already satisfied: wheel~=0.35 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (0.36.2)
Requirement already satisfied: astunparse~=1.6.3 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (1.6.3)
Requirement already satisfied: tensorflow-estimator&lt;2.5.0,&gt;=2.4.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (2.4.0)
Requirement already satisfied: wrapt~=1.12.1 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (1.12.1)
Requirement already satisfied: tensorboard~=2.4 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (2.5.0)
Requirement already satisfied: protobuf&gt;=3.9.2 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (3.15.8)
Requirement already satisfied: h5py~=2.10.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (2.10.0)
Requirement already satisfied: opt-einsum~=3.3.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (3.3.0)
Requirement already satisfied: termcolor~=1.1.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (1.1.0)
Requirement already satisfied: absl-py~=0.10 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (0.12.0)
Requirement already satisfied: grpcio~=1.32.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (1.32.0)
Requirement already satisfied: google-pasta~=0.2 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (0.2.0)
Requirement already satisfied: flatbuffers~=1.12.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (1.12)
Requirement already satisfied: gast==0.3.3 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (0.3.3)
Requirement already satisfied: keras-preprocessing~=1.1.2 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (1.1.2)
Requirement already satisfied: pysimdjson&lt;4.0,&gt;=3.2 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (3.2.0)
Requirement already satisfied: httpstan&lt;4.5,&gt;=4.4 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (4.4.2)
Requirement already satisfied: clikit&lt;0.7,&gt;=0.6 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (0.6.2)
Requirement already satisfied: aiohttp&lt;4.0,&gt;=3.6 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (3.7.4.post0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: ephem&gt;=3.7.5.3 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from LunarCalendar&gt;=0.0.9-&gt;fbprophet&gt;=0.5-&gt;autotime) (3.7.7.1)
Requirement already satisfied: pymeeus&lt;=1,&gt;=0.3.13 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from convertdate&gt;=2.1.2-&gt;fbprophet&gt;=0.5-&gt;autotime) (0.5.11)
Requirement already satisfied: hijri-converter in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from holidays&gt;=0.10.2-&gt;fbprophet&gt;=0.5-&gt;autotime) (2.1.1)
Requirement already satisfied: korean-lunar-calendar in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from holidays&gt;=0.10.2-&gt;fbprophet&gt;=0.5-&gt;autotime) (0.2.1)
Requirement already satisfied: pyrsistent&gt;=0.14.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from jsonschema!=2.5.0,&gt;=2.4-&gt;nbformat&gt;=5.0.4-&gt;dnntime&gt;=0.3.4-&gt;autotime) (0.17.3)
Requirement already satisfied: attrs&gt;=17.4.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from jsonschema!=2.5.0,&gt;=2.4-&gt;nbformat&gt;=5.0.4-&gt;dnntime&gt;=0.3.4-&gt;autotime) (20.3.0)
Requirement already satisfied: importlib-metadata; python_version &lt; &quot;3.8&quot; in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from jsonschema!=2.5.0,&gt;=2.4-&gt;nbformat&gt;=5.0.4-&gt;dnntime&gt;=0.3.4-&gt;autotime) (3.10.0)
Requirement already satisfied: setuptools in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from jsonschema!=2.5.0,&gt;=2.4-&gt;nbformat&gt;=5.0.4-&gt;dnntime&gt;=0.3.4-&gt;autotime) (52.0.0.post20210125)
Requirement already satisfied: werkzeug&gt;=0.11.15 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (1.0.1)
Requirement already satisfied: google-auth&lt;2,&gt;=1.6.3 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (1.30.0)
Requirement already satisfied: markdown&gt;=2.6.8 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (3.3.4)
Requirement already satisfied: requests&lt;3,&gt;=2.21.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (2.25.1)
Requirement already satisfied: tensorboard-plugin-wit&gt;=1.6.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (1.8.0)
Requirement already satisfied: tensorboard-data-server&lt;0.7.0,&gt;=0.6.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (0.6.0)
Requirement already satisfied: google-auth-oauthlib&lt;0.5,&gt;=0.4.1 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (0.4.4)
Requirement already satisfied: webargs&lt;8.0,&gt;=7.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from httpstan&lt;4.5,&gt;=4.4-&gt;pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (7.0.1)
Requirement already satisfied: appdirs&lt;2.0,&gt;=1.4 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from httpstan&lt;4.5,&gt;=4.4-&gt;pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (1.4.4)
Requirement already satisfied: marshmallow&lt;4.0,&gt;=3.10 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from httpstan&lt;4.5,&gt;=4.4-&gt;pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (3.11.1)
Requirement already satisfied: lz4&lt;4.0,&gt;=3.1 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from httpstan&lt;4.5,&gt;=4.4-&gt;pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (3.1.3)
Requirement already satisfied: pastel&lt;0.3.0,&gt;=0.2.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from clikit&lt;0.7,&gt;=0.6-&gt;pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (0.2.1)
Requirement already satisfied: crashtest&lt;0.4.0,&gt;=0.3.0; python_version &gt;= &quot;3.6&quot; and python_version &lt; &quot;4.0&quot; in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from clikit&lt;0.7,&gt;=0.6-&gt;pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (0.3.1)
Requirement already satisfied: pylev&lt;2.0,&gt;=1.3 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from clikit&lt;0.7,&gt;=0.6-&gt;pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (1.3.0)
Requirement already satisfied: yarl&lt;2.0,&gt;=1.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from aiohttp&lt;4.0,&gt;=3.6-&gt;pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (1.6.3)
Requirement already satisfied: multidict&lt;7.0,&gt;=4.5 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from aiohttp&lt;4.0,&gt;=3.6-&gt;pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (5.1.0)
Requirement already satisfied: async-timeout&lt;4.0,&gt;=3.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from aiohttp&lt;4.0,&gt;=3.6-&gt;pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (3.0.1)
Requirement already satisfied: chardet&lt;5.0,&gt;=2.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from aiohttp&lt;4.0,&gt;=3.6-&gt;pystan&gt;=2.14-&gt;fbprophet&gt;=0.5-&gt;autotime) (4.0.0)
Requirement already satisfied: zipp&gt;=0.5 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from importlib-metadata; python_version &lt; &quot;3.8&quot;-&gt;jsonschema!=2.5.0,&gt;=2.4-&gt;nbformat&gt;=5.0.4-&gt;dnntime&gt;=0.3.4-&gt;autotime) (3.4.1)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4; python_version &gt;= &quot;3.6&quot; in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from google-auth&lt;2,&gt;=1.6.3-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (4.7.2)
Requirement already satisfied: cachetools&lt;5.0,&gt;=2.0.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from google-auth&lt;2,&gt;=1.6.3-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (4.2.2)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from google-auth&lt;2,&gt;=1.6.3-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (0.2.8)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (1.26.4)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (2.10)
Requirement already satisfied: certifi&gt;=2017.4.17 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (2020.12.5)
Requirement already satisfied: requests-oauthlib&gt;=0.7.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from google-auth-oauthlib&lt;0.5,&gt;=0.4.1-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (1.3.0)
Requirement already satisfied: pyasn1&gt;=0.1.3 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from rsa&lt;5,&gt;=3.1.4; python_version &gt;= &quot;3.6&quot;-&gt;google-auth&lt;2,&gt;=1.6.3-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (0.4.8)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from requests-oauthlib&gt;=0.7.0-&gt;google-auth-oauthlib&lt;0.5,&gt;=0.4.1-&gt;tensorboard~=2.4-&gt;tensorflow&gt;=2.1.0-&gt;dnntime&gt;=0.3.4-&gt;autotime) (3.1.0)
Building wheels for collected packages: fbprophet, pyflux
  Building wheel for fbprophet (setup.py) ... ?25lerror
<span class=" -Color -Color-Red">  ERROR: Command errored out with exit status 1:</span>
<span class=" -Color -Color-Red">   command: /opt/anaconda3/envs/jeff/bin/python -u -c &#39;import sys, setuptools, tokenize; sys.argv[0] = &#39;&quot;&#39;&quot;&#39;/tmp/pip-install-cyipebue/fbprophet/setup.py&#39;&quot;&#39;&quot;&#39;; __file__=&#39;&quot;&#39;&quot;&#39;/tmp/pip-install-cyipebue/fbprophet/setup.py&#39;&quot;&#39;&quot;&#39;;f=getattr(tokenize, &#39;&quot;&#39;&quot;&#39;open&#39;&quot;&#39;&quot;&#39;, open)(__file__);code=f.read().replace(&#39;&quot;&#39;&quot;&#39;\r\n&#39;&quot;&#39;&quot;&#39;, &#39;&quot;&#39;&quot;&#39;\n&#39;&quot;&#39;&quot;&#39;);f.close();exec(compile(code, __file__, &#39;&quot;&#39;&quot;&#39;exec&#39;&quot;&#39;&quot;&#39;))&#39; bdist_wheel -d /tmp/pip-wheel-46ektaws</span>
<span class=" -Color -Color-Red">       cwd: /tmp/pip-install-cyipebue/fbprophet/</span>
<span class=" -Color -Color-Red">  Complete output (38 lines):</span>
<span class=" -Color -Color-Red">  running bdist_wheel</span>
<span class=" -Color -Color-Red">  running build</span>
<span class=" -Color -Color-Red">  running build_py</span>
<span class=" -Color -Color-Red">  creating build</span>
<span class=" -Color -Color-Red">  creating build/lib</span>
<span class=" -Color -Color-Red">  creating build/lib/fbprophet</span>
<span class=" -Color -Color-Red">  creating build/lib/fbprophet/stan_model</span>
<span class=" -Color -Color-Red">  Traceback (most recent call last):</span>
<span class=" -Color -Color-Red">    File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class=" -Color -Color-Red">    File &quot;/tmp/pip-install-cyipebue/fbprophet/setup.py&quot;, line 149, in &lt;module&gt;</span>
<span class=" -Color -Color-Red">      long_description_content_type=&#39;text/markdown&#39;,</span>
<span class=" -Color -Color-Red">    File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/setuptools/__init__.py&quot;, line 153, in setup</span>
<span class=" -Color -Color-Red">      return distutils.core.setup(**attrs)</span>
<span class=" -Color -Color-Red">    File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/core.py&quot;, line 148, in setup</span>
<span class=" -Color -Color-Red">      dist.run_commands()</span>
<span class=" -Color -Color-Red">    File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/dist.py&quot;, line 966, in run_commands</span>
<span class=" -Color -Color-Red">      self.run_command(cmd)</span>
<span class=" -Color -Color-Red">    File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/dist.py&quot;, line 985, in run_command</span>
<span class=" -Color -Color-Red">      cmd_obj.run()</span>
<span class=" -Color -Color-Red">    File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/wheel/bdist_wheel.py&quot;, line 299, in run</span>
<span class=" -Color -Color-Red">      self.run_command(&#39;build&#39;)</span>
<span class=" -Color -Color-Red">    File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/cmd.py&quot;, line 313, in run_command</span>
<span class=" -Color -Color-Red">      self.distribution.run_command(command)</span>
<span class=" -Color -Color-Red">    File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/dist.py&quot;, line 985, in run_command</span>
<span class=" -Color -Color-Red">      cmd_obj.run()</span>
<span class=" -Color -Color-Red">    File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/command/build.py&quot;, line 135, in run</span>
<span class=" -Color -Color-Red">      self.run_command(cmd_name)</span>
<span class=" -Color -Color-Red">    File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/cmd.py&quot;, line 313, in run_command</span>
<span class=" -Color -Color-Red">      self.distribution.run_command(command)</span>
<span class=" -Color -Color-Red">    File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/dist.py&quot;, line 985, in run_command</span>
<span class=" -Color -Color-Red">      cmd_obj.run()</span>
<span class=" -Color -Color-Red">    File &quot;/tmp/pip-install-cyipebue/fbprophet/setup.py&quot;, line 48, in run</span>
<span class=" -Color -Color-Red">      build_models(target_dir)</span>
<span class=" -Color -Color-Red">    File &quot;/tmp/pip-install-cyipebue/fbprophet/setup.py&quot;, line 38, in build_models</span>
<span class=" -Color -Color-Red">      StanBackendEnum.get_backend_class(backend).build_model(target_dir, MODEL_DIR)</span>
<span class=" -Color -Color-Red">    File &quot;/tmp/pip-install-cyipebue/fbprophet/fbprophet/models.py&quot;, line 209, in build_model</span>
<span class=" -Color -Color-Red">      import pystan</span>
<span class=" -Color -Color-Red">  ModuleNotFoundError: No module named &#39;pystan&#39;</span>
<span class=" -Color -Color-Red">  ----------------------------------------</span>
<span class=" -Color -Color-Red">  ERROR: Failed building wheel for fbprophet</span>
?25h  Running setup.py clean for fbprophet
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Building wheel for pyflux (setup.py) ... ?25lerror
<span class=" -Color -Color-Red">  ERROR: Command errored out with exit status 1:</span>
<span class=" -Color -Color-Red">   command: /opt/anaconda3/envs/jeff/bin/python -u -c &#39;import sys, setuptools, tokenize; sys.argv[0] = &#39;&quot;&#39;&quot;&#39;/tmp/pip-install-cyipebue/pyflux/setup.py&#39;&quot;&#39;&quot;&#39;; __file__=&#39;&quot;&#39;&quot;&#39;/tmp/pip-install-cyipebue/pyflux/setup.py&#39;&quot;&#39;&quot;&#39;;f=getattr(tokenize, &#39;&quot;&#39;&quot;&#39;open&#39;&quot;&#39;&quot;&#39;, open)(__file__);code=f.read().replace(&#39;&quot;&#39;&quot;&#39;\r\n&#39;&quot;&#39;&quot;&#39;, &#39;&quot;&#39;&quot;&#39;\n&#39;&quot;&#39;&quot;&#39;);f.close();exec(compile(code, __file__, &#39;&quot;&#39;&quot;&#39;exec&#39;&quot;&#39;&quot;&#39;))&#39; bdist_wheel -d /tmp/pip-wheel-qzqjec6v</span>
<span class=" -Color -Color-Red">       cwd: /tmp/pip-install-cyipebue/pyflux/</span>
<span class=" -Color -Color-Red">  Complete output (628 lines):</span>
<span class=" -Color -Color-Red">  running bdist_wheel</span>
<span class=" -Color -Color-Red">  running build</span>
<span class=" -Color -Color-Red">  running config_cc</span>
<span class=" -Color -Color-Red">  unifing config_cc, config, build_clib, build_ext, build commands --compiler options</span>
<span class=" -Color -Color-Red">  running config_fc</span>
<span class=" -Color -Color-Red">  unifing config_fc, config, build_clib, build_ext, build commands --fcompiler options</span>
<span class=" -Color -Color-Red">  running build_src</span>
<span class=" -Color -Color-Red">  build_src</span>
<span class=" -Color -Color-Red">  building extension &quot;pyflux.__check_build._check_build&quot; sources</span>
<span class=" -Color -Color-Red">  building extension &quot;pyflux.arma.arma_recursions&quot; sources</span>
<span class=" -Color -Color-Red">  building extension &quot;pyflux.arma.nn_architecture&quot; sources</span>
<span class=" -Color -Color-Red">  building extension &quot;pyflux.families.gas_recursions&quot; sources</span>
<span class=" -Color -Color-Red">  building extension &quot;pyflux.families.poisson_kalman_recursions&quot; sources</span>
<span class=" -Color -Color-Red">  building extension &quot;pyflux.garch.garch_recursions&quot; sources</span>
<span class=" -Color -Color-Red">  building extension &quot;pyflux.gas.gas_core_recursions&quot; sources</span>
<span class=" -Color -Color-Red">  building extension &quot;pyflux.gpnarx.kernel_routines&quot; sources</span>
<span class=" -Color -Color-Red">  building extension &quot;pyflux.inference.metropolis_sampler&quot; sources</span>
<span class=" -Color -Color-Red">  building extension &quot;pyflux.inference.bbvi_routines&quot; sources</span>
<span class=" -Color -Color-Red">  building extension &quot;pyflux.ssm.kalman&quot; sources</span>
<span class=" -Color -Color-Red">  building extension &quot;pyflux.var.var_recursions&quot; sources</span>
<span class=" -Color -Color-Red">  build_src: building npy-pkg config files</span>
<span class=" -Color -Color-Red">  running build_py</span>
<span class=" -Color -Color-Red">  creating build</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7/pyflux</span>
<span class=" -Color -Color-Red">  copying pyflux/results.py -&gt; build/lib.linux-x86_64-3.7/pyflux</span>
<span class=" -Color -Color-Red">  copying pyflux/latent_variables.py -&gt; build/lib.linux-x86_64-3.7/pyflux</span>
<span class=" -Color -Color-Red">  copying pyflux/setup.py -&gt; build/lib.linux-x86_64-3.7/pyflux</span>
<span class=" -Color -Color-Red">  copying pyflux/data_check.py -&gt; build/lib.linux-x86_64-3.7/pyflux</span>
<span class=" -Color -Color-Red">  copying pyflux/__init__.py -&gt; build/lib.linux-x86_64-3.7/pyflux</span>
<span class=" -Color -Color-Red">  copying pyflux/tsm.py -&gt; build/lib.linux-x86_64-3.7/pyflux</span>
<span class=" -Color -Color-Red">  copying pyflux/covariances.py -&gt; build/lib.linux-x86_64-3.7/pyflux</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7/pyflux/__check_build</span>
<span class=" -Color -Color-Red">  copying pyflux/__check_build/setup.py -&gt; build/lib.linux-x86_64-3.7/pyflux/__check_build</span>
<span class=" -Color -Color-Red">  copying pyflux/__check_build/__init__.py -&gt; build/lib.linux-x86_64-3.7/pyflux/__check_build</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7/pyflux/arma</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/nnar.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/nnarx.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/arimax.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/setup.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/__init__.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/arma.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arimax_t.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arimax_poisson.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arima_cauchy.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arima_inference.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arima_normal.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arimax_skewt.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arimax_cauchy.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arimax_exponential.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arimax_laplace.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arima_poisson.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arima_laplace.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arima_t.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/__init__.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arima_exponential.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arimax_inference.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arimax_normal.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/arma/tests/test_arima_skewt.py -&gt; build/lib.linux-x86_64-3.7/pyflux/arma/tests</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7/pyflux/ensembles</span>
<span class=" -Color -Color-Red">  copying pyflux/ensembles/mixture_of_experts.py -&gt; build/lib.linux-x86_64-3.7/pyflux/ensembles</span>
<span class=" -Color -Color-Red">  copying pyflux/ensembles/__init__.py -&gt; build/lib.linux-x86_64-3.7/pyflux/ensembles</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  copying pyflux/families/t.py -&gt; build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  copying pyflux/families/exponential.py -&gt; build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  copying pyflux/families/family.py -&gt; build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  copying pyflux/families/laplace.py -&gt; build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  copying pyflux/families/inverse_gamma.py -&gt; build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  copying pyflux/families/cauchy.py -&gt; build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  copying pyflux/families/inverse_wishart.py -&gt; build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  copying pyflux/families/normal.py -&gt; build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  copying pyflux/families/poisson.py -&gt; build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  copying pyflux/families/setup.py -&gt; build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  copying pyflux/families/flat.py -&gt; build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  copying pyflux/families/__init__.py -&gt; build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  copying pyflux/families/truncated_normal.py -&gt; build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  copying pyflux/families/skewt.py -&gt; build/lib.linux-x86_64-3.7/pyflux/families</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7/pyflux/garch</span>
<span class=" -Color -Color-Red">  copying pyflux/garch/egarch.py -&gt; build/lib.linux-x86_64-3.7/pyflux/garch</span>
<span class=" -Color -Color-Red">  copying pyflux/garch/segarchm.py -&gt; build/lib.linux-x86_64-3.7/pyflux/garch</span>
<span class=" -Color -Color-Red">  copying pyflux/garch/garch.py -&gt; build/lib.linux-x86_64-3.7/pyflux/garch</span>
<span class=" -Color -Color-Red">  copying pyflux/garch/egarchmreg.py -&gt; build/lib.linux-x86_64-3.7/pyflux/garch</span>
<span class=" -Color -Color-Red">  copying pyflux/garch/setup.py -&gt; build/lib.linux-x86_64-3.7/pyflux/garch</span>
<span class=" -Color -Color-Red">  copying pyflux/garch/__init__.py -&gt; build/lib.linux-x86_64-3.7/pyflux/garch</span>
<span class=" -Color -Color-Red">  copying pyflux/garch/lmegarch.py -&gt; build/lib.linux-x86_64-3.7/pyflux/garch</span>
<span class=" -Color -Color-Red">  copying pyflux/garch/egarchm.py -&gt; build/lib.linux-x86_64-3.7/pyflux/garch</span>
<span class=" -Color -Color-Red">  copying pyflux/garch/segarch.py -&gt; build/lib.linux-x86_64-3.7/pyflux/garch</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7/pyflux/gas</span>
<span class=" -Color -Color-Red">  copying pyflux/gas/scores.py -&gt; build/lib.linux-x86_64-3.7/pyflux/gas</span>
<span class=" -Color -Color-Red">  copying pyflux/gas/gas.py -&gt; build/lib.linux-x86_64-3.7/pyflux/gas</span>
<span class=" -Color -Color-Red">  copying pyflux/gas/gasllt.py -&gt; build/lib.linux-x86_64-3.7/pyflux/gas</span>
<span class=" -Color -Color-Red">  copying pyflux/gas/gasx.py -&gt; build/lib.linux-x86_64-3.7/pyflux/gas</span>
<span class=" -Color -Color-Red">  copying pyflux/gas/setup.py -&gt; build/lib.linux-x86_64-3.7/pyflux/gas</span>
<span class=" -Color -Color-Red">  copying pyflux/gas/gasllm.py -&gt; build/lib.linux-x86_64-3.7/pyflux/gas</span>
<span class=" -Color -Color-Red">  copying pyflux/gas/__init__.py -&gt; build/lib.linux-x86_64-3.7/pyflux/gas</span>
<span class=" -Color -Color-Red">  copying pyflux/gas/gasreg.py -&gt; build/lib.linux-x86_64-3.7/pyflux/gas</span>
<span class=" -Color -Color-Red">  copying pyflux/gas/gasrank.py -&gt; build/lib.linux-x86_64-3.7/pyflux/gas</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7/pyflux/gpnarx</span>
<span class=" -Color -Color-Red">  copying pyflux/gpnarx/gpnarx.py -&gt; build/lib.linux-x86_64-3.7/pyflux/gpnarx</span>
<span class=" -Color -Color-Red">  copying pyflux/gpnarx/kernels.py -&gt; build/lib.linux-x86_64-3.7/pyflux/gpnarx</span>
<span class=" -Color -Color-Red">  copying pyflux/gpnarx/setup.py -&gt; build/lib.linux-x86_64-3.7/pyflux/gpnarx</span>
<span class=" -Color -Color-Red">  copying pyflux/gpnarx/__init__.py -&gt; build/lib.linux-x86_64-3.7/pyflux/gpnarx</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7/pyflux/inference</span>
<span class=" -Color -Color-Red">  copying pyflux/inference/norm_post_sim.py -&gt; build/lib.linux-x86_64-3.7/pyflux/inference</span>
<span class=" -Color -Color-Red">  copying pyflux/inference/stoch_optim.py -&gt; build/lib.linux-x86_64-3.7/pyflux/inference</span>
<span class=" -Color -Color-Red">  copying pyflux/inference/metropolis_hastings.py -&gt; build/lib.linux-x86_64-3.7/pyflux/inference</span>
<span class=" -Color -Color-Red">  copying pyflux/inference/bbvi.py -&gt; build/lib.linux-x86_64-3.7/pyflux/inference</span>
<span class=" -Color -Color-Red">  copying pyflux/inference/setup.py -&gt; build/lib.linux-x86_64-3.7/pyflux/inference</span>
<span class=" -Color -Color-Red">  copying pyflux/inference/__init__.py -&gt; build/lib.linux-x86_64-3.7/pyflux/inference</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7/pyflux/output</span>
<span class=" -Color -Color-Red">  copying pyflux/output/__init__.py -&gt; build/lib.linux-x86_64-3.7/pyflux/output</span>
<span class=" -Color -Color-Red">  copying pyflux/output/tableprinter.py -&gt; build/lib.linux-x86_64-3.7/pyflux/output</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7/pyflux/ssm</span>
<span class=" -Color -Color-Red">  copying pyflux/ssm/dynlin.py -&gt; build/lib.linux-x86_64-3.7/pyflux/ssm</span>
<span class=" -Color -Color-Red">  copying pyflux/ssm/nllt.py -&gt; build/lib.linux-x86_64-3.7/pyflux/ssm</span>
<span class=" -Color -Color-Red">  copying pyflux/ssm/dynamic_glm.py -&gt; build/lib.linux-x86_64-3.7/pyflux/ssm</span>
<span class=" -Color -Color-Red">  copying pyflux/ssm/local_level.py -&gt; build/lib.linux-x86_64-3.7/pyflux/ssm</span>
<span class=" -Color -Color-Red">  copying pyflux/ssm/local_trend.py -&gt; build/lib.linux-x86_64-3.7/pyflux/ssm</span>
<span class=" -Color -Color-Red">  copying pyflux/ssm/llt.py -&gt; build/lib.linux-x86_64-3.7/pyflux/ssm</span>
<span class=" -Color -Color-Red">  copying pyflux/ssm/setup.py -&gt; build/lib.linux-x86_64-3.7/pyflux/ssm</span>
<span class=" -Color -Color-Red">  copying pyflux/ssm/ndynlin.py -&gt; build/lib.linux-x86_64-3.7/pyflux/ssm</span>
<span class=" -Color -Color-Red">  copying pyflux/ssm/__init__.py -&gt; build/lib.linux-x86_64-3.7/pyflux/ssm</span>
<span class=" -Color -Color-Red">  copying pyflux/ssm/nllm.py -&gt; build/lib.linux-x86_64-3.7/pyflux/ssm</span>
<span class=" -Color -Color-Red">  copying pyflux/ssm/dar.py -&gt; build/lib.linux-x86_64-3.7/pyflux/ssm</span>
<span class=" -Color -Color-Red">  copying pyflux/ssm/llm.py -&gt; build/lib.linux-x86_64-3.7/pyflux/ssm</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7/pyflux/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/tests/nhst.py -&gt; build/lib.linux-x86_64-3.7/pyflux/tests</span>
<span class=" -Color -Color-Red">  copying pyflux/tests/__init__.py -&gt; build/lib.linux-x86_64-3.7/pyflux/tests</span>
<span class=" -Color -Color-Red">  creating build/lib.linux-x86_64-3.7/pyflux/var</span>
<span class=" -Color -Color-Red">  copying pyflux/var/var.py -&gt; build/lib.linux-x86_64-3.7/pyflux/var</span>
<span class=" -Color -Color-Red">  copying pyflux/var/setup.py -&gt; build/lib.linux-x86_64-3.7/pyflux/var</span>
<span class=" -Color -Color-Red">  copying pyflux/var/__init__.py -&gt; build/lib.linux-x86_64-3.7/pyflux/var</span>
<span class=" -Color -Color-Red">  running build_ext</span>
<span class=" -Color -Color-Red">  customize UnixCCompiler</span>
<span class=" -Color -Color-Red">  customize UnixCCompiler using build_ext</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-march=native)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  creating /tmp/tmp0x9e4tz_/opt</span>
<span class=" -Color -Color-Red">  creating /tmp/tmp0x9e4tz_/opt/anaconda3</span>
<span class=" -Color -Color-Red">  creating /tmp/tmp0x9e4tz_/opt/anaconda3/envs</span>
<span class=" -Color -Color-Red">  creating /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff</span>
<span class=" -Color -Color-Red">  creating /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib</span>
<span class=" -Color -Color-Red">  creating /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7</span>
<span class=" -Color -Color-Red">  creating /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages</span>
<span class=" -Color -Color-Red">  creating /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy</span>
<span class=" -Color -Color-Red">  creating /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils</span>
<span class=" -Color -Color-Red">  creating /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks</span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-march=native&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-O3)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-O3&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-Werror)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.__init__[1674] : check requested baseline</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-msse)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-msse2)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse2&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;SSE&#39; with flags (-msse -msse2)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;SSE2&#39; with flags (-msse -msse2)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-msse3)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse3&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;SSE3&#39; with flags (-msse -msse2 -msse3)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.__init__[1683] : check requested dispatch-able features</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-mssse3)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-mssse3&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-msse4.1)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse4.1&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-mpopcnt)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-mpopcnt&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-msse4.2)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse4.2&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-mavx)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-mavx&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;AVX&#39; with flags (-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;SSSE3&#39; with flags (-msse -msse2 -msse3 -mssse3)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;POPCNT&#39; with flags (-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;SSE41&#39; with flags (-msse -msse2 -msse3 -mssse3 -msse4.1)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-mf16c)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-mf16c&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;F16C&#39; with flags (-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;SSE42&#39; with flags (-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-mavx2)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-mavx2&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;AVX2&#39; with flags (-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mavx2)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mavx2 -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-mfma)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-mfma&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-mavx512f)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-mavx512f&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-mavx512cd)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-mavx512cd&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-mavx512vl -mavx512bw -mavx512dq)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-mavx512vl -mavx512bw -mavx512dq&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-mavx512ifma -mavx512vbmi)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-mavx512ifma -mavx512vbmi&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;AVX512_CNL&#39; with flags (-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512vl -mavx512bw -mavx512dq -mavx512ifma -mavx512vbmi)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512vl -mavx512bw -mavx512dq -mavx512ifma -mavx512vbmi -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;FMA3&#39; with flags (-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;AVX512_SKX&#39; with flags (-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512vl -mavx512bw -mavx512dq)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512vl -mavx512bw -mavx512dq -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;AVX512CD&#39; with flags (-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;AVX512F&#39; with flags (-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-mavx512vnni)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-mavx512vnni&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.dist_test[576] : CCompilerOpt._dist_test_spawn[713] : Command (gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/opt/anaconda3/envs/jeff/include/python3.7m -c /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/test_flags.c -o /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/test_flags.o -MMD -MF /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/test_flags.o.d -mavx512vnni) failed with exit status 1 output -&gt;</span>
<span class=" -Color -Color-Red">  gcc: error: unrecognized command line option ‘-mavx512vnni’</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[1003] : testing failed</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;AVX512_CLX&#39; with flags (-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512vl -mavx512bw -mavx512dq)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512vl -mavx512bw -mavx512dq -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.dist_test[576] : CCompilerOpt._dist_test_spawn[713] : Command (gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/opt/anaconda3/envs/jeff/include/python3.7m -c /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_clx.c -o /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_clx.o -MMD -MF /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_clx.o.d -msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512vl -mavx512bw -mavx512dq -Werror) failed with exit status 1 output -&gt;</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_clx.c: In function ‘main’:</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_clx.c:6:17: error: implicit declaration of function ‘_mm512_dpbusd_epi32’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       __m512i a = _mm512_dpbusd_epi32(_mm512_setzero_si512(), _mm512_setzero_si512(), _mm512_setzero_si512());</span>
<span class=" -Color -Color-Red">                   ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_clx.c:6:17: error: incompatible types when initializing type ‘__m512i {aka __vector(8) long long int}’ using type ‘int’</span>
<span class=" -Color -Color-Red">  cc1: all warnings being treated as errors</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1458] : testing failed</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-mavx512er -mavx512pf)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-mavx512er -mavx512pf&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;AVX512_KNL&#39; with flags (-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512er -mavx512pf)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512er -mavx512pf -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[999] : testing flags (-mavx5124fmaps -mavx5124vnniw -mavx512vpopcntdq)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-mavx5124fmaps -mavx5124vnniw -mavx512vpopcntdq&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.dist_test[576] : CCompilerOpt._dist_test_spawn[713] : Command (gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/opt/anaconda3/envs/jeff/include/python3.7m -c /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/test_flags.c -o /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/test_flags.o -MMD -MF /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/test_flags.o.d -mavx5124fmaps -mavx5124vnniw -mavx512vpopcntdq) failed with exit status 1 output -&gt;</span>
<span class=" -Color -Color-Red">  gcc: error: unrecognized command line option ‘-mavx5124fmaps’</span>
<span class=" -Color -Color-Red">  gcc: error: unrecognized command line option ‘-mavx5124vnniw’</span>
<span class=" -Color -Color-Red">  gcc: error: unrecognized command line option ‘-mavx512vpopcntdq’</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  CCompilerOpt.cc_test_flags[1003] : testing failed</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1446] : testing feature &#39;AVX512_KNM&#39; with flags (-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512er -mavx512pf)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512er -mavx512pf -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.dist_test[576] : CCompilerOpt._dist_test_spawn[713] : Command (gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/opt/anaconda3/envs/jeff/include/python3.7m -c /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_knm.c -o /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_knm.o -MMD -MF /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_knm.o.d -msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512er -mavx512pf -Werror) failed with exit status 1 output -&gt;</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_knm.c: In function ‘main’:</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_knm.c:9:9: error: implicit declaration of function ‘_mm512_4fmadd_ps’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       b = _mm512_4fmadd_ps(b, b, b, b, b, NULL);</span>
<span class=" -Color -Color-Red">           ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_knm.c:9:7: error: incompatible types when assigning to type ‘__m512 {aka __vector(16) float}’ from type ‘int’</span>
<span class=" -Color -Color-Red">       b = _mm512_4fmadd_ps(b, b, b, b, b, NULL);</span>
<span class=" -Color -Color-Red">         ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_knm.c:11:9: error: implicit declaration of function ‘_mm512_4dpwssd_epi32’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       a = _mm512_4dpwssd_epi32(a, a, a, a, a, NULL);</span>
<span class=" -Color -Color-Red">           ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_knm.c:11:7: error: incompatible types when assigning to type ‘__m512i {aka __vector(8) long long int}’ from type ‘int’</span>
<span class=" -Color -Color-Red">       a = _mm512_4dpwssd_epi32(a, a, a, a, a, NULL);</span>
<span class=" -Color -Color-Red">         ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_knm.c:13:9: error: implicit declaration of function ‘_mm512_popcnt_epi64’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       a = _mm512_popcnt_epi64(a);</span>
<span class=" -Color -Color-Red">           ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/cpu_avx512_knm.c:13:7: error: incompatible types when assigning to type ‘__m512i {aka __vector(8) long long int}’ from type ‘int’</span>
<span class=" -Color -Color-Red">       a = _mm512_popcnt_epi64(a);</span>
<span class=" -Color -Color-Red">         ^</span>
<span class=" -Color -Color-Red">  cc1: all warnings being treated as errors</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_test[1458] : testing failed</span>
<span class=" -Color -Color-Red">  CCompilerOpt.__init__[1696] : skip features (SSE3 SSE SSE2) since its part of baseline</span>
<span class=" -Color -Color-Red">  CCompilerOpt.__init__[1699] : initialize targets groups</span>
<span class=" -Color -Color-Red">  CCompilerOpt.__init__[1701] : parse target group simd_test</span>
<span class=" -Color -Color-Red">  CCompilerOpt._parse_target_tokens[1912] : skip targets (VSX3 ASIMD VSX FMA4 VSX2 XOP NEON) not part of baseline or dispatch-able features</span>
<span class=" -Color -Color-Red">  CCompilerOpt._parse_policy_not_keepbase[2022] : skip baseline features (SSE2)</span>
<span class=" -Color -Color-Red">  CCompilerOpt.generate_dispatch_header[2236] : generate CPU dispatch header: (build/src.linux-x86_64-3.7/numpy/distutils/include/npy_cpu_dispatch_config.h)</span>
<span class=" -Color -Color-Red">  CCompilerOpt.generate_dispatch_header[2247] : dispatch header dir build/src.linux-x86_64-3.7/numpy/distutils/include does not exist, creating it</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_extra_checks[1519] : Testing extra checks for feature &#39;AVX512F&#39; (AVX512F_REDUCE)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.dist_test[576] : CCompilerOpt._dist_test_spawn[713] : Command (gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/opt/anaconda3/envs/jeff/include/python3.7m -c /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c -o /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.o -MMD -MF /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.o.d -msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -Werror) failed with exit status 1 output -&gt;</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c: In function ‘main’:</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:13:21: error: implicit declaration of function ‘_mm512_reduce_add_ps’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       float sum_ps  = _mm512_reduce_add_ps(one_ps);</span>
<span class=" -Color -Color-Red">                       ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:14:21: error: implicit declaration of function ‘_mm512_reduce_add_pd’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       double sum_pd = _mm512_reduce_add_pd(one_pd);</span>
<span class=" -Color -Color-Red">                       ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:15:26: error: implicit declaration of function ‘_mm512_reduce_add_epi64’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       int sum_int   = (int)_mm512_reduce_add_epi64(one_i64);</span>
<span class=" -Color -Color-Red">                            ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:16:26: error: implicit declaration of function ‘_mm512_reduce_add_epi32’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">           sum_int  += (int)_mm512_reduce_add_epi32(one_i64);</span>
<span class=" -Color -Color-Red">                            ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:18:16: error: implicit declaration of function ‘_mm512_reduce_mul_ps’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_ps  += _mm512_reduce_mul_ps(one_ps);</span>
<span class=" -Color -Color-Red">                  ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:19:16: error: implicit declaration of function ‘_mm512_reduce_mul_pd’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_pd  += _mm512_reduce_mul_pd(one_pd);</span>
<span class=" -Color -Color-Red">                  ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:20:21: error: implicit declaration of function ‘_mm512_reduce_mul_epi64’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_int += (int)_mm512_reduce_mul_epi64(one_i64);</span>
<span class=" -Color -Color-Red">                       ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:21:21: error: implicit declaration of function ‘_mm512_reduce_mul_epi32’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_int += (int)_mm512_reduce_mul_epi32(one_i64);</span>
<span class=" -Color -Color-Red">                       ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:23:16: error: implicit declaration of function ‘_mm512_reduce_min_ps’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_ps  += _mm512_reduce_min_ps(one_ps);</span>
<span class=" -Color -Color-Red">                  ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:24:16: error: implicit declaration of function ‘_mm512_reduce_min_pd’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_pd  += _mm512_reduce_min_pd(one_pd);</span>
<span class=" -Color -Color-Red">                  ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:25:21: error: implicit declaration of function ‘_mm512_reduce_min_epi32’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_int += (int)_mm512_reduce_min_epi32(one_i64);</span>
<span class=" -Color -Color-Red">                       ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:26:21: error: implicit declaration of function ‘_mm512_reduce_min_epu32’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_int += (int)_mm512_reduce_min_epu32(one_i64);</span>
<span class=" -Color -Color-Red">                       ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:27:21: error: implicit declaration of function ‘_mm512_reduce_min_epi64’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_int += (int)_mm512_reduce_min_epi64(one_i64);</span>
<span class=" -Color -Color-Red">                       ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:29:16: error: implicit declaration of function ‘_mm512_reduce_max_ps’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_ps  += _mm512_reduce_max_ps(one_ps);</span>
<span class=" -Color -Color-Red">                  ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:30:16: error: implicit declaration of function ‘_mm512_reduce_max_pd’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_pd  += _mm512_reduce_max_pd(one_pd);</span>
<span class=" -Color -Color-Red">                  ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:31:21: error: implicit declaration of function ‘_mm512_reduce_max_epi32’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_int += (int)_mm512_reduce_max_epi32(one_i64);</span>
<span class=" -Color -Color-Red">                       ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:32:21: error: implicit declaration of function ‘_mm512_reduce_max_epu32’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_int += (int)_mm512_reduce_max_epu32(one_i64);</span>
<span class=" -Color -Color-Red">                       ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:33:21: error: implicit declaration of function ‘_mm512_reduce_max_epi64’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_int += (int)_mm512_reduce_max_epi64(one_i64);</span>
<span class=" -Color -Color-Red">                       ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:35:21: error: implicit declaration of function ‘_mm512_reduce_and_epi32’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_int += (int)_mm512_reduce_and_epi32(one_i64);</span>
<span class=" -Color -Color-Red">                       ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:36:21: error: implicit declaration of function ‘_mm512_reduce_and_epi64’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_int += (int)_mm512_reduce_and_epi64(one_i64);</span>
<span class=" -Color -Color-Red">                       ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:38:21: error: implicit declaration of function ‘_mm512_reduce_or_epi32’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_int += (int)_mm512_reduce_or_epi32(one_i64);</span>
<span class=" -Color -Color-Red">                       ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512f_reduce.c:39:21: error: implicit declaration of function ‘_mm512_reduce_or_epi64’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       sum_int += (int)_mm512_reduce_or_epi64(one_i64);</span>
<span class=" -Color -Color-Red">                       ^</span>
<span class=" -Color -Color-Red">  cc1: all warnings being treated as errors</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_extra_checks[1537] : testing failed for checks (AVX512F_REDUCE)</span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_extra_checks[1519] : Testing extra checks for feature &#39;AVX512_SKX&#39; (AVX512BW_MASK AVX512DQ_MASK)</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512vl -mavx512bw -mavx512dq -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.dist_test[576] : CCompilerOpt._dist_test_spawn[713] : Command (gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/opt/anaconda3/envs/jeff/include/python3.7m -c /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512bw_mask.c -o /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512bw_mask.o -MMD -MF /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512bw_mask.o.d -msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512vl -mavx512bw -mavx512dq -Werror) failed with exit status 1 output -&gt;</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512bw_mask.c: In function ‘main’:</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512bw_mask.c:12:11: error: implicit declaration of function ‘_kor_mask64’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       m64 = _kor_mask64(m64, m64);</span>
<span class=" -Color -Color-Red">             ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512bw_mask.c:13:11: error: implicit declaration of function ‘_kxor_mask64’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       m64 = _kxor_mask64(m64, m64);</span>
<span class=" -Color -Color-Red">             ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512bw_mask.c:14:11: error: implicit declaration of function ‘_cvtu64_mask64’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       m64 = _cvtu64_mask64(_cvtmask64_u64(m64));</span>
<span class=" -Color -Color-Red">             ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512bw_mask.c:14:26: error: implicit declaration of function ‘_cvtmask64_u64’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       m64 = _cvtu64_mask64(_cvtmask64_u64(m64));</span>
<span class=" -Color -Color-Red">                            ^</span>
<span class=" -Color -Color-Red">  cc1: all warnings being treated as errors</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512vl -mavx512bw -mavx512dq -Werror&#39;</span>
<span class=" -Color -Color-Red">  CCompilerOpt.dist_test[576] : CCompilerOpt._dist_test_spawn[713] : Command (gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/opt/anaconda3/envs/jeff/include/python3.7m -c /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512dq_mask.c -o /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512dq_mask.o -MMD -MF /tmp/tmp0x9e4tz_/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512dq_mask.o.d -msse -msse2 -msse3 -mssse3 -msse4.1 -mpopcnt -msse4.2 -mavx -mf16c -mfma -mavx2 -mavx512f -mavx512cd -mavx512vl -mavx512bw -mavx512dq -Werror) failed with exit status 1 output -&gt;</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512dq_mask.c: In function ‘main’:</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512dq_mask.c:12:10: error: implicit declaration of function ‘_kor_mask8’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       m8 = _kor_mask8(m8, m8);</span>
<span class=" -Color -Color-Red">            ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512dq_mask.c:13:10: error: implicit declaration of function ‘_kxor_mask8’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       m8 = _kxor_mask8(m8, m8);</span>
<span class=" -Color -Color-Red">            ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512dq_mask.c:14:10: error: implicit declaration of function ‘_cvtu32_mask8’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       m8 = _cvtu32_mask8(_cvtmask8_u32(m8));</span>
<span class=" -Color -Color-Red">            ^</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/distutils/checks/extra_avx512dq_mask.c:14:24: error: implicit declaration of function ‘_cvtmask8_u32’ [-Werror=implicit-function-declaration]</span>
<span class=" -Color -Color-Red">       m8 = _cvtu32_mask8(_cvtmask8_u32(m8));</span>
<span class=" -Color -Color-Red">                          ^</span>
<span class=" -Color -Color-Red">  cc1: all warnings being treated as errors</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  CCompilerOpt.feature_extra_checks[1537] : testing failed for checks (AVX512BW_MASK AVX512DQ_MASK)</span>
<span class=" -Color -Color-Red">  Detected changes on compiler optimizations, force rebuilding</span>
<span class=" -Color -Color-Red">  building &#39;pyflux.__check_build._check_build&#39; extension</span>
<span class=" -Color -Color-Red">  compiling C sources</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  creating build/temp.linux-x86_64-3.7/pyflux</span>
<span class=" -Color -Color-Red">  creating build/temp.linux-x86_64-3.7/pyflux/__check_build</span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/core/include -Ibuild/src.linux-x86_64-3.7/numpy/distutils/include -I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3&#39;</span>
<span class=" -Color -Color-Red">  gcc: pyflux/__check_build/_check_build.c</span>
<span class=" -Color -Color-Red">  gcc -pthread -shared -B /opt/anaconda3/envs/jeff/compiler_compat -L/opt/anaconda3/envs/jeff/lib -Wl,-rpath=/opt/anaconda3/envs/jeff/lib -Wl,--no-as-needed -Wl,--sysroot=/ build/temp.linux-x86_64-3.7/pyflux/__check_build/_check_build.o -o build/lib.linux-x86_64-3.7/pyflux/__check_build/_check_build.cpython-37m-x86_64-linux-gnu.so</span>
<span class=" -Color -Color-Red">  building &#39;pyflux.arma.arma_recursions&#39; extension</span>
<span class=" -Color -Color-Red">  compiling C sources</span>
<span class=" -Color -Color-Red">  C compiler: gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  creating build/temp.linux-x86_64-3.7/pyflux/arma</span>
<span class=" -Color -Color-Red">  compile options: &#39;-I/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/core/include -Ibuild/src.linux-x86_64-3.7/numpy/distutils/include -I/opt/anaconda3/envs/jeff/include/python3.7m -c&#39;</span>
<span class=" -Color -Color-Red">  extra options: &#39;-msse -msse2 -msse3&#39;</span>
<span class=" -Color -Color-Red">  gcc: pyflux/arma/arma_recursions.c</span>
<span class=" -Color -Color-Red">  In file included from /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/core/include/numpy/ndarraytypes.h:1944:0,</span>
<span class=" -Color -Color-Red">                   from /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,</span>
<span class=" -Color -Color-Red">                   from /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/core/include/numpy/arrayobject.h:4,</span>
<span class=" -Color -Color-Red">                   from pyflux/arma/arma_recursions.c:274:</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning &quot;Using deprecated NumPy API, disable it with &quot; &quot;#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION&quot; [-Wcpp]</span>
<span class=" -Color -Color-Red">   #warning &quot;Using deprecated NumPy API, disable it with &quot; \</span>
<span class=" -Color -Color-Red">    ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c: In function ‘__Pyx__ExceptionSave’:</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19331:19: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_type’</span>
<span class=" -Color -Color-Red">       *type = tstate-&gt;exc_type;</span>
<span class=" -Color -Color-Red">                     ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19332:20: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_value’</span>
<span class=" -Color -Color-Red">       *value = tstate-&gt;exc_value;</span>
<span class=" -Color -Color-Red">                      ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19333:17: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_traceback’</span>
<span class=" -Color -Color-Red">       *tb = tstate-&gt;exc_traceback;</span>
<span class=" -Color -Color-Red">                   ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c: In function ‘__Pyx__ExceptionReset’:</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19340:22: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_type’</span>
<span class=" -Color -Color-Red">       tmp_type = tstate-&gt;exc_type;</span>
<span class=" -Color -Color-Red">                        ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19341:23: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_value’</span>
<span class=" -Color -Color-Red">       tmp_value = tstate-&gt;exc_value;</span>
<span class=" -Color -Color-Red">                         ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19342:20: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_traceback’</span>
<span class=" -Color -Color-Red">       tmp_tb = tstate-&gt;exc_traceback;</span>
<span class=" -Color -Color-Red">                      ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19343:11: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_type’</span>
<span class=" -Color -Color-Red">       tstate-&gt;exc_type = type;</span>
<span class=" -Color -Color-Red">             ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19344:11: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_value’</span>
<span class=" -Color -Color-Red">       tstate-&gt;exc_value = value;</span>
<span class=" -Color -Color-Red">             ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19345:11: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_traceback’</span>
<span class=" -Color -Color-Red">       tstate-&gt;exc_traceback = tb;</span>
<span class=" -Color -Color-Red">             ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c: In function ‘__Pyx__GetException’:</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19400:22: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_type’</span>
<span class=" -Color -Color-Red">       tmp_type = tstate-&gt;exc_type;</span>
<span class=" -Color -Color-Red">                        ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19401:23: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_value’</span>
<span class=" -Color -Color-Red">       tmp_value = tstate-&gt;exc_value;</span>
<span class=" -Color -Color-Red">                         ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19402:20: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_traceback’</span>
<span class=" -Color -Color-Red">       tmp_tb = tstate-&gt;exc_traceback;</span>
<span class=" -Color -Color-Red">                      ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19403:11: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_type’</span>
<span class=" -Color -Color-Red">       tstate-&gt;exc_type = local_type;</span>
<span class=" -Color -Color-Red">             ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19404:11: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_value’</span>
<span class=" -Color -Color-Red">       tstate-&gt;exc_value = local_value;</span>
<span class=" -Color -Color-Red">             ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19405:11: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_traceback’</span>
<span class=" -Color -Color-Red">       tstate-&gt;exc_traceback = local_tb;</span>
<span class=" -Color -Color-Red">             ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c: In function ‘__Pyx__ExceptionSwap’:</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19427:22: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_type’</span>
<span class=" -Color -Color-Red">       tmp_type = tstate-&gt;exc_type;</span>
<span class=" -Color -Color-Red">                        ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19428:23: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_value’</span>
<span class=" -Color -Color-Red">       tmp_value = tstate-&gt;exc_value;</span>
<span class=" -Color -Color-Red">                         ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19429:20: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_traceback’</span>
<span class=" -Color -Color-Red">       tmp_tb = tstate-&gt;exc_traceback;</span>
<span class=" -Color -Color-Red">                      ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19430:11: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_type’</span>
<span class=" -Color -Color-Red">       tstate-&gt;exc_type = *type;</span>
<span class=" -Color -Color-Red">             ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19431:11: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_value’</span>
<span class=" -Color -Color-Red">       tstate-&gt;exc_value = *value;</span>
<span class=" -Color -Color-Red">             ^</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c:19432:11: error: ‘PyThreadState {aka struct _ts}’ has no member named ‘exc_traceback’</span>
<span class=" -Color -Color-Red">       tstate-&gt;exc_traceback = *tb;</span>
<span class=" -Color -Color-Red">             ^</span>
<span class=" -Color -Color-Red">  In file included from /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/core/include/numpy/ndarrayobject.h:21:0,</span>
<span class=" -Color -Color-Red">                   from /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/core/include/numpy/arrayobject.h:4,</span>
<span class=" -Color -Color-Red">                   from pyflux/arma/arma_recursions.c:274:</span>
<span class=" -Color -Color-Red">  pyflux/arma/arma_recursions.c: At top level:</span>
<span class=" -Color -Color-Red">  /opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/core/include/numpy/__multiarray_api.h:1464:1: warning: ‘_import_array’ defined but not used [-Wunused-function]</span>
<span class=" -Color -Color-Red">   _import_array(void)</span>
<span class=" -Color -Color-Red">   ^</span>
<span class=" -Color -Color-Red">  error: Command &quot;gcc -pthread -B /opt/anaconda3/envs/jeff/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/numpy/core/include -Ibuild/src.linux-x86_64-3.7/numpy/distutils/include -I/opt/anaconda3/envs/jeff/include/python3.7m -c pyflux/arma/arma_recursions.c -o build/temp.linux-x86_64-3.7/pyflux/arma/arma_recursions.o -MMD -MF build/temp.linux-x86_64-3.7/pyflux/arma/arma_recursions.o.d -msse -msse2 -msse3&quot; failed with exit status 1</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  ########### EXT COMPILER OPTIMIZATION ###########</span>
<span class=" -Color -Color-Red">  Platform      :</span>
<span class=" -Color -Color-Red">    Architecture: x64</span>
<span class=" -Color -Color-Red">    Compiler    : gcc</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  CPU baseline  :</span>
<span class=" -Color -Color-Red">    Requested   : &#39;min&#39;</span>
<span class=" -Color -Color-Red">    Enabled     : SSE SSE2 SSE3</span>
<span class=" -Color -Color-Red">    Flags       : -msse -msse2 -msse3</span>
<span class=" -Color -Color-Red">    Extra checks: none</span>
<span class=" -Color -Color-Red">  </span>
<span class=" -Color -Color-Red">  CPU dispatch  :</span>
<span class=" -Color -Color-Red">    Requested   : &#39;max -xop -fma4&#39;</span>
<span class=" -Color -Color-Red">    Enabled     : SSSE3 SSE41 POPCNT SSE42 AVX F16C FMA3 AVX2 AVX512F AVX512CD AVX512_KNL AVX512_SKX AVX512_CNL</span>
<span class=" -Color -Color-Red">    Generated   : none</span>
<span class=" -Color -Color-Red">  CCompilerOpt._cache_write[796] : write cache to path -&gt; /tmp/pip-install-cyipebue/pyflux/build/temp.linux-x86_64-3.7/ccompiler_opt_cache_ext.py</span>
<span class=" -Color -Color-Red">  ----------------------------------------</span>
<span class=" -Color -Color-Red">  ERROR: Failed building wheel for pyflux</span>
?25h  Running setup.py clean for pyflux
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Failed to build fbprophet pyflux
Installing collected packages: fbprophet, dnntime, pyflux, autotime
    Running setup.py install for fbprophet ... ?25lerror
<span class=" -Color -Color-Red">    ERROR: Command errored out with exit status 1:</span>
<span class=" -Color -Color-Red">     command: /opt/anaconda3/envs/jeff/bin/python -u -c &#39;import sys, setuptools, tokenize; sys.argv[0] = &#39;&quot;&#39;&quot;&#39;/tmp/pip-install-cyipebue/fbprophet/setup.py&#39;&quot;&#39;&quot;&#39;; __file__=&#39;&quot;&#39;&quot;&#39;/tmp/pip-install-cyipebue/fbprophet/setup.py&#39;&quot;&#39;&quot;&#39;;f=getattr(tokenize, &#39;&quot;&#39;&quot;&#39;open&#39;&quot;&#39;&quot;&#39;, open)(__file__);code=f.read().replace(&#39;&quot;&#39;&quot;&#39;\r\n&#39;&quot;&#39;&quot;&#39;, &#39;&quot;&#39;&quot;&#39;\n&#39;&quot;&#39;&quot;&#39;);f.close();exec(compile(code, __file__, &#39;&quot;&#39;&quot;&#39;exec&#39;&quot;&#39;&quot;&#39;))&#39; install --record /tmp/pip-record-7vad5ilk/install-record.txt --single-version-externally-managed --compile --install-headers /opt/anaconda3/envs/jeff/include/python3.7m/fbprophet</span>
<span class=" -Color -Color-Red">         cwd: /tmp/pip-install-cyipebue/fbprophet/</span>
<span class=" -Color -Color-Red">    Complete output (40 lines):</span>
<span class=" -Color -Color-Red">    running install</span>
<span class=" -Color -Color-Red">    running build</span>
<span class=" -Color -Color-Red">    running build_py</span>
<span class=" -Color -Color-Red">    creating build</span>
<span class=" -Color -Color-Red">    creating build/lib</span>
<span class=" -Color -Color-Red">    creating build/lib/fbprophet</span>
<span class=" -Color -Color-Red">    creating build/lib/fbprophet/stan_model</span>
<span class=" -Color -Color-Red">    Traceback (most recent call last):</span>
<span class=" -Color -Color-Red">      File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class=" -Color -Color-Red">      File &quot;/tmp/pip-install-cyipebue/fbprophet/setup.py&quot;, line 149, in &lt;module&gt;</span>
<span class=" -Color -Color-Red">        long_description_content_type=&#39;text/markdown&#39;,</span>
<span class=" -Color -Color-Red">      File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/setuptools/__init__.py&quot;, line 153, in setup</span>
<span class=" -Color -Color-Red">        return distutils.core.setup(**attrs)</span>
<span class=" -Color -Color-Red">      File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/core.py&quot;, line 148, in setup</span>
<span class=" -Color -Color-Red">        dist.run_commands()</span>
<span class=" -Color -Color-Red">      File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/dist.py&quot;, line 966, in run_commands</span>
<span class=" -Color -Color-Red">        self.run_command(cmd)</span>
<span class=" -Color -Color-Red">      File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/dist.py&quot;, line 985, in run_command</span>
<span class=" -Color -Color-Red">        cmd_obj.run()</span>
<span class=" -Color -Color-Red">      File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/site-packages/setuptools/command/install.py&quot;, line 61, in run</span>
<span class=" -Color -Color-Red">        return orig.install.run(self)</span>
<span class=" -Color -Color-Red">      File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/command/install.py&quot;, line 545, in run</span>
<span class=" -Color -Color-Red">        self.run_command(&#39;build&#39;)</span>
<span class=" -Color -Color-Red">      File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/cmd.py&quot;, line 313, in run_command</span>
<span class=" -Color -Color-Red">        self.distribution.run_command(command)</span>
<span class=" -Color -Color-Red">      File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/dist.py&quot;, line 985, in run_command</span>
<span class=" -Color -Color-Red">        cmd_obj.run()</span>
<span class=" -Color -Color-Red">      File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/command/build.py&quot;, line 135, in run</span>
<span class=" -Color -Color-Red">        self.run_command(cmd_name)</span>
<span class=" -Color -Color-Red">      File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/cmd.py&quot;, line 313, in run_command</span>
<span class=" -Color -Color-Red">        self.distribution.run_command(command)</span>
<span class=" -Color -Color-Red">      File &quot;/opt/anaconda3/envs/jeff/lib/python3.7/distutils/dist.py&quot;, line 985, in run_command</span>
<span class=" -Color -Color-Red">        cmd_obj.run()</span>
<span class=" -Color -Color-Red">      File &quot;/tmp/pip-install-cyipebue/fbprophet/setup.py&quot;, line 48, in run</span>
<span class=" -Color -Color-Red">        build_models(target_dir)</span>
<span class=" -Color -Color-Red">      File &quot;/tmp/pip-install-cyipebue/fbprophet/setup.py&quot;, line 38, in build_models</span>
<span class=" -Color -Color-Red">        StanBackendEnum.get_backend_class(backend).build_model(target_dir, MODEL_DIR)</span>
<span class=" -Color -Color-Red">      File &quot;/tmp/pip-install-cyipebue/fbprophet/fbprophet/models.py&quot;, line 209, in build_model</span>
<span class=" -Color -Color-Red">        import pystan</span>
<span class=" -Color -Color-Red">    ModuleNotFoundError: No module named &#39;pystan&#39;</span>
<span class=" -Color -Color-Red">    ----------------------------------------</span>
<span class=" -Color -Color-Red">ERROR: Command errored out with exit status 1: /opt/anaconda3/envs/jeff/bin/python -u -c &#39;import sys, setuptools, tokenize; sys.argv[0] = &#39;&quot;&#39;&quot;&#39;/tmp/pip-install-cyipebue/fbprophet/setup.py&#39;&quot;&#39;&quot;&#39;; __file__=&#39;&quot;&#39;&quot;&#39;/tmp/pip-install-cyipebue/fbprophet/setup.py&#39;&quot;&#39;&quot;&#39;;f=getattr(tokenize, &#39;&quot;&#39;&quot;&#39;open&#39;&quot;&#39;&quot;&#39;, open)(__file__);code=f.read().replace(&#39;&quot;&#39;&quot;&#39;\r\n&#39;&quot;&#39;&quot;&#39;, &#39;&quot;&#39;&quot;&#39;\n&#39;&quot;&#39;&quot;&#39;);f.close();exec(compile(code, __file__, &#39;&quot;&#39;&quot;&#39;exec&#39;&quot;&#39;&quot;&#39;))&#39; install --record /tmp/pip-record-7vad5ilk/install-record.txt --single-version-externally-managed --compile --install-headers /opt/anaconda3/envs/jeff/include/python3.7m/fbprophet Check the logs for full command output.</span>
<span class=" -Color -Color-Yellow">WARNING: You are using pip version 20.2.4; however, version 21.1 is available.</span>
<span class=" -Color -Color-Yellow">You should consider upgrading via the &#39;/opt/anaconda3/envs/jeff/bin/python -m pip install --upgrade pip&#39; command.</span>
?25hRequirement already satisfied: nb-black in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (1.0.7)
Requirement already satisfied: black&gt;=&#39;19.3&#39;; python_version &gt;= &quot;3.6&quot; in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from nb-black) (21.4b2)
Requirement already satisfied: ipython in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from nb-black) (7.22.0)
Requirement already satisfied: regex&gt;=2020.1.8 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from black&gt;=&#39;19.3&#39;; python_version &gt;= &quot;3.6&quot;-&gt;nb-black) (2021.4.4)
Requirement already satisfied: typing-extensions&gt;=3.7.4; python_version &lt; &quot;3.8&quot; in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from black&gt;=&#39;19.3&#39;; python_version &gt;= &quot;3.6&quot;-&gt;nb-black) (3.7.4.3)
Requirement already satisfied: click&gt;=7.1.2 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from black&gt;=&#39;19.3&#39;; python_version &gt;= &quot;3.6&quot;-&gt;nb-black) (7.1.2)
Requirement already satisfied: pathspec&lt;1,&gt;=0.8.1 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from black&gt;=&#39;19.3&#39;; python_version &gt;= &quot;3.6&quot;-&gt;nb-black) (0.8.1)
Requirement already satisfied: mypy-extensions&gt;=0.4.3 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from black&gt;=&#39;19.3&#39;; python_version &gt;= &quot;3.6&quot;-&gt;nb-black) (0.4.3)
Requirement already satisfied: toml&gt;=0.10.1 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from black&gt;=&#39;19.3&#39;; python_version &gt;= &quot;3.6&quot;-&gt;nb-black) (0.10.2)
Requirement already satisfied: appdirs in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from black&gt;=&#39;19.3&#39;; python_version &gt;= &quot;3.6&quot;-&gt;nb-black) (1.4.4)
Requirement already satisfied: typed-ast&gt;=1.4.2; python_version &lt; &quot;3.8&quot; in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from black&gt;=&#39;19.3&#39;; python_version &gt;= &quot;3.6&quot;-&gt;nb-black) (1.4.3)
Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from ipython-&gt;nb-black) (3.0.18)
Requirement already satisfied: traitlets&gt;=4.2 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from ipython-&gt;nb-black) (5.0.5)
Requirement already satisfied: jedi&gt;=0.16 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from ipython-&gt;nb-black) (0.18.0)
Requirement already satisfied: backcall in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from ipython-&gt;nb-black) (0.2.0)
Requirement already satisfied: pygments in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from ipython-&gt;nb-black) (2.8.1)
Requirement already satisfied: pickleshare in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from ipython-&gt;nb-black) (0.7.5)
Requirement already satisfied: decorator in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from ipython-&gt;nb-black) (5.0.7)
Requirement already satisfied: pexpect&gt;4.3; sys_platform != &quot;win32&quot; in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from ipython-&gt;nb-black) (4.8.0)
Requirement already satisfied: setuptools&gt;=18.5 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from ipython-&gt;nb-black) (52.0.0.post20210125)
Requirement already satisfied: wcwidth in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0-&gt;ipython-&gt;nb-black) (0.2.5)
Requirement already satisfied: ipython-genutils in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from traitlets&gt;=4.2-&gt;ipython-&gt;nb-black) (0.2.0)
Requirement already satisfied: parso&lt;0.9.0,&gt;=0.8.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from jedi&gt;=0.16-&gt;ipython-&gt;nb-black) (0.8.2)
Requirement already satisfied: ptyprocess&gt;=0.5 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from pexpect&gt;4.3; sys_platform != &quot;win32&quot;-&gt;ipython-&gt;nb-black) (0.7.0)
<span class=" -Color -Color-Yellow">WARNING: You are using pip version 20.2.4; however, version 21.1 is available.</span>
<span class=" -Color -Color-Yellow">You should consider upgrading via the &#39;/opt/anaconda3/envs/jeff/bin/python -m pip install --upgrade pip&#39; command.</span>
Requirement already satisfied: cvxpy in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (1.1.12)
Requirement already satisfied: numpy&gt;=1.15 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from cvxpy) (1.20.2)
Requirement already satisfied: scipy&gt;=1.1.0 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from cvxpy) (1.6.3)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: scs&gt;=1.1.6 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from cvxpy) (2.1.3)
Requirement already satisfied: ecos&gt;=2 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from cvxpy) (2.0.7.post1)
Requirement already satisfied: osqp&gt;=0.4.1 in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from cvxpy) (0.6.2.post0)
Requirement already satisfied: qdldl in /opt/anaconda3/envs/jeff/lib/python3.7/site-packages (from osqp&gt;=0.4.1-&gt;cvxpy) (0.1.5.post0)
<span class=" -Color -Color-Yellow">WARNING: You are using pip version 20.2.4; however, version 21.1 is available.</span>
<span class=" -Color -Color-Yellow">You should consider upgrading via the &#39;/opt/anaconda3/envs/jeff/bin/python -m pip install --upgrade pip&#39; command.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %load_ext autotime</span>
<span class="c1"># %load_ext nb_black</span>

<span class="c1"># General</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="c1"># Ignore warnings LOL</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># SEED FOR RANDOMNESS</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">420</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="preface">
<h2>1. Preface<a class="headerlink" href="#preface" title="Permalink to this headline">¶</a></h2>
<p>The type of problem we care about in this project are known as <a class="reference external" href="https://en.wikipedia.org/wiki/Stochastic_programming#Two-stage_problems">two-stage stochastic programming</a>. Let The general formulation of it is as follows (Adapted from Wikipedia):</p>
<div class="section" id="general-two-stage-stochastic-program">
<h3>1.1. General Two-Stage Stochastic Program<a class="headerlink" href="#general-two-stage-stochastic-program" title="Permalink to this headline">¶</a></h3>
<div class="section" id="first-stage-stochastic-program">
<h4>1.1.1 First Stage Stochastic Program<a class="headerlink" href="#first-stage-stochastic-program" title="Permalink to this headline">¶</a></h4>
<div class="amsmath math notranslate nohighlight" id="equation-fcf7580c-0213-40c0-a074-226cd7f340b4">
<span class="eqno">(38)<a class="headerlink" href="#equation-fcf7580c-0213-40c0-a074-226cd7f340b4" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \min_{x\in X} &amp; \{ g(x)= f(x) + E_{\tilde{s}\sim S}[h(x, s=\tilde{s})]\}
\end{align}\]</div>
<p>, where <span class="math notranslate nohighlight">\(h(x, s=\tilde{s})\)</span> is the optimal value of the second-stage problem given a specific scenario <span class="math notranslate nohighlight">\(\tilde{s}\)</span>. <span class="math notranslate nohighlight">\(x \in X\)</span> is our first-stage decision variable vector, <span class="math notranslate nohighlight">\(S\)</span> is a probability distribution of the scenario variables that we’re sampling from.</p>
</div>
<div class="section" id="second-stage-stochastic-program">
<h4>1.1.2 Second Stage Stochastic Program<a class="headerlink" href="#second-stage-stochastic-program" title="Permalink to this headline">¶</a></h4>
<p>For a specific <span class="math notranslate nohighlight">\(\tilde{x}\)</span> and <span class="math notranslate nohighlight">\(\tilde{s}\)</span>,</p>
<div class="amsmath math notranslate nohighlight" id="equation-b6cc70d9-c95d-4ab3-9a68-08e0566499ad">
<span class="eqno">(39)<a class="headerlink" href="#equation-b6cc70d9-c95d-4ab3-9a68-08e0566499ad" title="Permalink to this equation">¶</a></span>\[\begin{align}
    h(x=\tilde{x}, s=\tilde{s}) = \min_{y} &amp; \{ d(s, y) \,\vert\,C(s, x) +D(s, y) = \xi(s)\}  \\
\end{align}\]</div>
<p>, where <span class="math notranslate nohighlight">\(C, D, \xi\)</span> are functions given a specific scenario <span class="math notranslate nohighlight">\(\tilde{s}\)</span>. <span class="math notranslate nohighlight">\(y\)</span> is our second-stage decision variable vector.</p>
<p>At the first stage we optimize (minimize in the above formulation) the cost of the first-stage decision plus the expected cost of the (optimal) second-stage decision. We can view the second-stage problem simply as an optimization problem which describes our supposedly optimal behavior when the uncertain data is revealed (specific scenario <span class="math notranslate nohighlight">\(\tilde{s}\)</span>), or we can consider its solution as a recourse action where the term <span class="math notranslate nohighlight">\(D(s, y)\)</span> compensates for a possible inconsistency of the system <span class="math notranslate nohighlight">\(C(s, x) \leq \xi(s)\)</span> and <span class="math notranslate nohighlight">\(d(s, y)\)</span> is the cost of this recourse action.</p>
</div>
</div>
<div class="section" id="two-stage-stochastic-linear-program">
<h3>1.2. Two-Stage Stochastic Linear Program<a class="headerlink" href="#two-stage-stochastic-linear-program" title="Permalink to this headline">¶</a></h3>
<p>The stochastic linear program below is just a specific instance of the general program above, with very minor changes - e.g. functions of first-stage / second-stage decision variables are no longer general functions, but rather vectors / matrices because of constraints must be linear for a linear program.</p>
<div class="section" id="first-stage-stochastic-linear-program">
<h4>1.2.1 First Stage Stochastic Linear Program<a class="headerlink" href="#first-stage-stochastic-linear-program" title="Permalink to this headline">¶</a></h4>
<div class="amsmath math notranslate nohighlight" id="equation-8b18cd58-6eeb-4b13-9898-73309ec91157">
<span class="eqno">(40)<a class="headerlink" href="#equation-8b18cd58-6eeb-4b13-9898-73309ec91157" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \min\limits_{x\in \mathbb{R}^n} &amp; f(x)= c^\top x + E_{\tilde{s}\sim S}[h(x, s=\tilde{s})] &amp; \\
    \text{subject to} 
    &amp; Ax = b &amp;\\
    &amp; x \geq 0
\end{align}\]</div>
<p>, where <span class="math notranslate nohighlight">\(h(x, s=\tilde{s})\)</span> is the optimal value of the second-stage problem given a specific scenario <span class="math notranslate nohighlight">\(\tilde{s}\)</span>. <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n\)</span> is our first-stage decision variable vector, <span class="math notranslate nohighlight">\(S\)</span> is a probability distribution of the scenario variables that we’re sampling from., where <span class="math notranslate nohighlight">\(h(x, s)\)</span> is the optimal value of the second-stage problem</p>
</div>
<div class="section" id="second-stage-stochastic-linear-program">
<h4>1.2.2 Second Stage Stochastic Linear Program<a class="headerlink" href="#second-stage-stochastic-linear-program" title="Permalink to this headline">¶</a></h4>
<p>For a specific <span class="math notranslate nohighlight">\(\tilde{x}\)</span> and <span class="math notranslate nohighlight">\(\tilde{s}\)</span>,</p>
<div class="amsmath math notranslate nohighlight" id="equation-a6b9ff06-2c53-4014-9a05-730cdf8192bd">
<span class="eqno">(41)<a class="headerlink" href="#equation-a6b9ff06-2c53-4014-9a05-730cdf8192bd" title="Permalink to this equation">¶</a></span>\[\begin{align}
    h(x=\tilde{x}, s=\tilde{s}) = \min\limits_{y\in \mathbb{R}^m}\,&amp; d(s)^T y \\
    \text{subject to }\,&amp; C(s)x + D(s)y = \xi(s) \\
    &amp;y \geq 0
\end{align}\]</div>
<p>, where <span class="math notranslate nohighlight">\(C, D, \xi\)</span> are matrices given a specific scenario <span class="math notranslate nohighlight">\(\tilde{s}\)</span>. <span class="math notranslate nohighlight">\(y\)</span> is our second-stage decision variable vector.</p>
<p>At the first stage we optimize (minimize in the above formulation) the cost of the first-stage decision plus the expected cost of the (optimal) second-stage decision. We can view the second-stage problem simply as an optimization problem which describes our supposedly optimal behavior when the uncertain data is revealed (specific scenario <span class="math notranslate nohighlight">\(\tilde{s}\)</span>), or we can consider its solution as a recourse action where the term <span class="math notranslate nohighlight">\(D(s)y\)</span> compensates for a possible inconsistency of the system <span class="math notranslate nohighlight">\(C(s)x \leq \xi(s)\)</span> and <span class="math notranslate nohighlight">\(d(s)^\top y\)</span> is the cost of this recourse action.</p>
</div>
</div>
<div class="section" id="two-stage-stochastic-linear-program-with-discretized-scenario-distribution">
<h3>1.3. Two-Stage Stochastic Linear Program with Discretized Scenario Distribution<a class="headerlink" href="#two-stage-stochastic-linear-program-with-discretized-scenario-distribution" title="Permalink to this headline">¶</a></h3>
<p>What happens if we can’t get / don’t want to sample from a continuous distribution for the scenarios? (What if <span class="math notranslate nohighlight">\(S\)</span> is discrete instead of continuous?). Nothing much changes other than how we calculate the expectation of the second-stage objective values.</p>
<div class="section" id="first-stage-stochastic-linear-program-with-discretized-scenario-distribution">
<h4>1.3.1 First Stage Stochastic Linear Program with Discretized Scenario Distribution<a class="headerlink" href="#first-stage-stochastic-linear-program-with-discretized-scenario-distribution" title="Permalink to this headline">¶</a></h4>
<div class="amsmath math notranslate nohighlight" id="equation-2fd28ef4-9855-4681-8dc1-c15dd7af09ed">
<span class="eqno">(42)<a class="headerlink" href="#equation-2fd28ef4-9855-4681-8dc1-c15dd7af09ed" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \min\limits_{x\in \mathbb{R}^n}\,&amp; f(x)= c^\top x + \underbrace{\sum_{s = \tilde{s}} p(s = \tilde{s}) h(x, s = \tilde{s})}_{E_{\tilde{s}\sim S}[h(x, s=\tilde{s})]} \\
    \text{subject to }\,
    &amp; Ax = b \\
    &amp; x \geq 0
\end{align}\]</div>
<p>, where <span class="math notranslate nohighlight">\(h(x, s)\)</span> is the optimal value of the second-stage problem, and <span class="math notranslate nohighlight">\(p(s = \tilde{s})\)</span> is the probability of the scenario <span class="math notranslate nohighlight">\(\tilde{s}\)</span> occuring.</p>
</div>
<div class="section" id="second-stage-stochastic-linear-program-with-discretized-scenario-distribution">
<h4>1.3.2 Second Stage Stochastic Linear Program with Discretized Scenario Distribution<a class="headerlink" href="#second-stage-stochastic-linear-program-with-discretized-scenario-distribution" title="Permalink to this headline">¶</a></h4>
<p>For a specific <span class="math notranslate nohighlight">\(\tilde{x}\)</span> and <span class="math notranslate nohighlight">\(\tilde{s}\)</span>,</p>
<div class="amsmath math notranslate nohighlight" id="equation-bf431504-6016-4bc7-b316-88f263b129f1">
<span class="eqno">(43)<a class="headerlink" href="#equation-bf431504-6016-4bc7-b316-88f263b129f1" title="Permalink to this equation">¶</a></span>\[\begin{align}
    h(x=\tilde{x}, s=\tilde{s}) = \min\limits_{y\in \mathbb{R}^m}\,&amp; d(s)^T y \\
    \text{subject to} &amp; \, C(s)x + D(s)y = \xi(s) \text{, where }C(s), D(s), \xi(s) \\
    &amp; y \geq 0 \\
\end{align}\]</div>
<p>However, how do we go about solving this two-stage stochastic programs? The problem we face here is We will present two algorithms: Stochastic Gradient Descent and L-Shaped / Bender’s Method.</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="method-stochastic-gradient-descent">
<h2>2. Method: Stochastic Gradient Descent<a class="headerlink" href="#method-stochastic-gradient-descent" title="Permalink to this headline">¶</a></h2>
<p>To keep things simple, we will work on using stochastic gradient descent on a stochastic linear program with s discretized scenario distribution.</p>
<p>First, we recall the general key update formula in gradient descent (adjusting parameter <span class="math notranslate nohighlight">\(w_i\)</span> in negative direction of gradient of objective <span class="math notranslate nohighlight">\(f\)</span>):</p>
<div class="amsmath math notranslate nohighlight" id="equation-e9798d9b-391c-4b27-9a9d-7a982f5af469">
<span class="eqno">(44)<a class="headerlink" href="#equation-e9798d9b-391c-4b27-9a9d-7a982f5af469" title="Permalink to this equation">¶</a></span>\[\begin{align}
    &amp; w_i \leftarrow w_i + \alpha \frac{\partial f}{\partial w_i}\,\forall i = 0, \cdots , \text{Number of parameters} \\
\end{align}\]</div>
<p>Let’s recall the Lagrangian for the first stage problem :</p>
<div class="amsmath math notranslate nohighlight" id="equation-cc540c86-0997-40ca-ac39-f6bea98c247b">
<span class="eqno">(45)<a class="headerlink" href="#equation-cc540c86-0997-40ca-ac39-f6bea98c247b" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \mathcal{L}(x) = c^\top x + E_{\tilde{s}\sim S}[h(x, s=\tilde{s})] - \mu
\end{align}\]</div>
<p>Assume we have solved the second stage problem, and have retrieved optimal primal variables <span class="math notranslate nohighlight">\(y^*\)</span> and dual variables <span class="math notranslate nohighlight">\(\pi^*\)</span> (equality constraints) and <span class="math notranslate nohighlight">\(\lambda^*\)</span> (inequality constraints), then recall the Lagrangian of <span class="math notranslate nohighlight">\(h(x=\tilde{x}, s=\tilde{s})\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-abae8a62-47ae-4e23-ad6d-07a02435fd04">
<span class="eqno">(46)<a class="headerlink" href="#equation-abae8a62-47ae-4e23-ad6d-07a02435fd04" title="Permalink to this equation">¶</a></span>\[\begin{align}
  \mathcal{L}(x) &amp;= d(s)^\top y^* - \pi^* \left(C(s)x + D(s)y^* - \xi(s) \right) - \lambda^* y^* \\
\end{align}\]</div>
<p>To perform gradient descent on our obejctive function <span class="math notranslate nohighlight">\(f(x)\)</span>, we need to find its gradient / subgradient w.r.t. <span class="math notranslate nohighlight">\(x\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d140395c-14af-42cd-9711-7af3c61c450a">
<span class="eqno">(47)<a class="headerlink" href="#equation-d140395c-14af-42cd-9711-7af3c61c450a" title="Permalink to this equation">¶</a></span>\[\begin{align}
  f(x) &amp;= c^\top x + \sum_s p_s h_s(x) \\
  \frac{df}{dx} &amp;= c + \frac{d \left(\sum_s p_s h_s(x)\right)}{dx} \\
  &amp;= c + \sum_s p_s\frac{d\left(h_s(x)\right)}{dx} \\
  &amp;= c + \sum_s p_s\frac{d\left(\mathcal{L}(x)\right)}{dx} \\
  &amp;= c + \sum_s p_s\frac{d\left(d^\top y_s - \pi_s \left( Dy_s - \xi_s + C_s x \right) - \lambda_s y_s \right)}{dx} \\
  &amp;= c - \sum_s p_s (\pi^\top_s C_s) \\
\end{align}\]</div>
<p>Stochastic Gradient Descent:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d0aad7b5-b34e-4b33-b15f-a28da300e73b">
<span class="eqno">(48)<a class="headerlink" href="#equation-d0aad7b5-b34e-4b33-b15f-a28da300e73b" title="Permalink to this equation">¶</a></span>\[\begin{align}
  x &amp;= x + \alpha \frac{df}{dx} \\
  &amp;= x + \alpha \left( c - \sum_s p_s (\pi^\top_s C_s) \right) \\
\end{align}\]</div>
<p>Orthogonal Projection onto <a class="reference external" href="https://en.wikipedia.org/wiki/Convex_polytope">intersection of half-spaces (Convex Polytope)</a></p>
<div class="amsmath math notranslate nohighlight" id="equation-d8a87abc-c9f0-4c92-99ad-0ecc4306c611">
<span class="eqno">(49)<a class="headerlink" href="#equation-d8a87abc-c9f0-4c92-99ad-0ecc4306c611" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \arg \min_{x \geq 0} &amp; \frac{1}{2} {\lVert x - y \rVert}_{2}^{2} \\
    \text{subject to } &amp; Ax \leq b
\end{align}\]</div>
<p>Lagrangian</p>
<div class="amsmath math notranslate nohighlight" id="equation-b92dc082-3332-43f2-a673-68dc7991b37f">
<span class="eqno">(50)<a class="headerlink" href="#equation-b92dc082-3332-43f2-a673-68dc7991b37f" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \mathcal{L}(x, \lambda) &amp;= \frac{1}{2} {\lVert x - y \rVert}_{2}^{2} + \lambda \left(Ax  - b \right) \\
\end{align}\]</div>
<p>Lagrange Dual</p>
<div class="amsmath math notranslate nohighlight" id="equation-448683fe-db60-4a73-a4d4-e29243227554">
<span class="eqno">(51)<a class="headerlink" href="#equation-448683fe-db60-4a73-a4d4-e29243227554" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \mathcal{L}(\lambda) 
    &amp;= \inf_{x \geq 0} \mathcal{L}(x, \lambda) \\ 
    &amp;= \inf_{x \geq 0} \frac{1}{2} {\lVert x - y \rVert}_{2}^{2} + \lambda \left(Ax  - b \right) \\
\end{align}\]</div>
<p>KKT Conditions</p>
<p>Stationarity:</p>
<div class="amsmath math notranslate nohighlight" id="equation-6a721ce4-765e-4d88-8609-a0a5e64919b4">
<span class="eqno">(52)<a class="headerlink" href="#equation-6a721ce4-765e-4d88-8609-a0a5e64919b4" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \nabla_x \mathcal{L}(x, \lambda) &amp;= 0 \\
    \nabla_x \frac{1}{2} {\left( x - y \right) }^\top \left( x - y \right) + \lambda \left(Ax  - b \right) &amp;= 0 \\
    \left( x - y \right) + \lambda A &amp;= 0 \\
    \lambda &amp;= A^{-1}\left(y - x\right) \\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">StochasticGradientDescent</span><span class="p">:</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">projection</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find the projection of y onto the C(A) that minimizes</span>
<span class="sd">        the euclidean norm between y and the projected vector</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \begin{align}</span>
<span class="sd">                \arg \min_{x \geq 0} &amp; \frac{1}{2} {\lVert x - y \rVert}_{2}^{2} \\</span>
<span class="sd">                \text{subject to } &amp; x \in X, \, \text{where }X\text{ is a convex set}</span>
<span class="sd">            \end{align}</span>
<span class="sd">            </span>
<span class="sd">        Args:</span>
<span class="sd">            vector (np.array): Vector to be projected</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            np.array: Projected vector</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">P_positive</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">vector</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span>
            <span class="n">vector</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">vector</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="p">)</span>  <span class="c1"># Positive projection operator on a point</span>
        <span class="k">if</span> <span class="n">constraints</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">P_positive</span><span class="p">(</span>
                <span class="n">vector</span>
            <span class="p">)</span>  <span class="c1"># Return positive projection if there isnt a convex polytope / set constraint</span>

        <span class="n">proj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">vector</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">nonneg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Projected Vector</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span>
            <span class="n">cp</span><span class="o">.</span><span class="n">norm2</span><span class="p">(</span><span class="n">proj</span> <span class="o">-</span> <span class="n">vector</span><span class="p">)</span>
        <span class="p">)</span>  <span class="c1"># Minimize euclidean norm of difference between y and projection</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">constraints</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">proj</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">projection_dykstra</span><span class="p">(</span><span class="n">projections</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dykstra&#39;s Projection algorithm to find the orthogonal</span>
<span class="sd">        projection of a point onto a convex polytope (intersection</span>
<span class="sd">        of affine halfspaces). The algorithm below is adapted from</span>
<span class="sd">        https://github.com/mjhough/Dykstra/blob/main/dykstra/Dykstra.py</span>

<span class="sd">        Args:</span>
<span class="sd">            projections</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">x0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;x0 must be a vector&quot;</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">projections</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">cI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">max_iter</span> <span class="ow">and</span> <span class="n">cI</span> <span class="o">&gt;=</span> <span class="n">tol</span><span class="p">:</span>
            <span class="n">cI</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">projections</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>

                <span class="c1"># Update iterate</span>
                <span class="n">prev_x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">projections</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">prev_x</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>

                <span class="c1"># Update increment</span>
                <span class="n">prev_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">prev_x</span> <span class="o">-</span> <span class="n">prev_y</span><span class="p">)</span>

                <span class="c1"># Stop condition</span>
                <span class="n">cI</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">prev_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span> <span class="o">**</span> <span class="mi">2</span>

                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">x</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">first_stage_constraints</span><span class="p">,</span> <span class="n">s_gen</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">α</span><span class="o">=</span><span class="mf">1e0</span><span class="p">,</span> <span class="n">ε</span><span class="o">=</span><span class="mf">1e-04</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The Stochastic Gradient Descent method implemented here</span>
<span class="sd">        is used to optimize the Two-Stage Stochastic Linear Program</span>
<span class="sd">        with second-stage variables following a discrete distribution</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>  <span class="c1"># First-stage decision coefficient</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="n">x0</span>  <span class="c1"># Initial first-stage decision variable values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_stage_constraints</span> <span class="o">=</span> <span class="n">first_stage_constraints</span>  <span class="c1"># Function that gives a list of the constraints for first-stage problem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s_gen</span> <span class="o">=</span> <span class="n">s_gen</span>  <span class="c1"># Function to generate scenario specific entities</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>  <span class="c1"># Number of scenarios to generate using s_gen</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_iter</span> <span class="o">=</span> <span class="n">n_iter</span>  <span class="c1"># Number of iterations of sgd</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">α</span> <span class="o">=</span> <span class="n">α</span>  <span class="c1"># Learning rate for gradient descent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ε</span> <span class="o">=</span> <span class="n">ε</span> <span class="c1"># Tolerance for how close subgradient is to 0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log</span>  <span class="c1"># Whether or not to log progress</span>

    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Solves the Two-stage Stochastic Optimization&quot;&quot;&quot;</span>
        <span class="n">f_primal_optimal</span><span class="p">,</span> <span class="n">x_star</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_stage</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Optimal primal objective of first stage problem: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">f_primal_optimal</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal first-stage decision variables: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_star</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of iterations for convergence: </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f_primal_optimal</span><span class="p">,</span> <span class="n">x_star</span><span class="p">,</span> <span class="n">k</span>

    <span class="k">def</span> <span class="nf">first_stage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;First-stage Optimization&quot;&quot;&quot;</span>
        <span class="n">f_primal_optimal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>  <span class="c1"># First-stage primal optimal objective value</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="p">)</span>  <span class="c1"># First-stage decision variables</span>

<span class="c1">#         # Fix number of iterations</span>
<span class="c1">#         for k in range(self.n_iter):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            
            <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s_gen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>  <span class="c1"># Random Scenarios and associated variables</span>

            <span class="c1"># Initialize subgradient of f</span>
            <span class="n">ν</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="c1"># Initialize expectation of h</span>
            <span class="n">expected_h</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># Accumulating subgradients</span>
            <span class="k">for</span> <span class="n">p_s</span><span class="p">,</span> <span class="n">d_s</span><span class="p">,</span> <span class="n">C_s</span><span class="p">,</span> <span class="n">D_s</span><span class="p">,</span> <span class="n">ξ_s</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>

                <span class="n">π_s</span><span class="p">,</span> <span class="n">h_primal_optimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second_stage</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d_s</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="n">C_s</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D_s</span><span class="p">,</span> <span class="n">ξ</span><span class="o">=</span><span class="n">ξ_s</span>
                <span class="p">)</span>

                <span class="n">ν</span> <span class="o">-=</span> <span class="n">p_s</span> <span class="o">*</span> <span class="n">π_s</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">C_s</span>  <span class="c1"># Update subgradient</span>
                <span class="n">expected_h</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="n">p_s</span> <span class="o">*</span> <span class="n">h_primal_optimal</span>
                <span class="p">)</span>  <span class="c1"># Update expected second-stage optimal value</span>
                
            <span class="c1"># Early stopping condition</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">ν</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">atol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ε</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Early Stopping condition satisfied.&quot;</span><span class="p">)</span>
                <span class="k">break</span>
            
            <span class="c1"># The current f primal optimal found</span>
            <span class="n">current_f_primal_optimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">x</span> <span class="o">+</span> <span class="n">expected_h</span>

            <span class="c1"># Updated x value [WHY TF is it a + and not a -]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">StochasticGradientDescent</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span>
                <span class="n">vector</span><span class="o">=</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">α</span> <span class="o">*</span> <span class="n">ν</span><span class="p">),</span> <span class="n">constraints</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">first_stage_constraints</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; Iteration </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Current Primal Objective Found:&quot;</span><span class="p">,</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">current_f_primal_optimal</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                    <span class="s2">&quot;|&quot;</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;Best Primal Objective Found:&quot;</span><span class="p">,</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">f_primal_optimal</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                <span class="p">)</span>

            <span class="c1"># If minimized value is better, update</span>
            <span class="k">if</span> <span class="n">f_primal_optimal</span> <span class="o">&gt;</span> <span class="n">current_f_primal_optimal</span><span class="p">:</span>
                <span class="n">f_primal_optimal</span> <span class="o">=</span> <span class="n">current_f_primal_optimal</span>
                
            <span class="c1"># Update k</span>
            <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">f_primal_optimal</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">k</span>

    <span class="k">def</span> <span class="nf">second_stage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">ξ</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Second-stage Optimization&quot;&quot;&quot;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nonneg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Second-stage decision variables</span>
        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="n">C</span> <span class="o">@</span> <span class="n">x</span> <span class="o">+</span> <span class="n">D</span> <span class="o">@</span> <span class="n">y</span> <span class="o">==</span> <span class="n">ξ</span><span class="p">]</span>  <span class="c1"># Second-stage constraints</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">d</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">constraints</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">constraints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dual_value</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="l-shaped-bender-s-method">
<h2>3. L-Shaped / Bender’s Method<a class="headerlink" href="#l-shaped-bender-s-method" title="Permalink to this headline">¶</a></h2>
<p>Master Problem:</p>
<div class="amsmath math notranslate nohighlight" id="equation-633c1a26-fbe0-4fc4-889b-a7c7edf45389">
<span class="eqno">(53)<a class="headerlink" href="#equation-633c1a26-fbe0-4fc4-889b-a7c7edf45389" title="Permalink to this equation">¶</a></span>\[\begin{align}
  \underset{S \geq 0}{\min} \mu &amp; \\
\end{align}\]</div>
<p>Sub Problem:</p>
<div class="amsmath math notranslate nohighlight" id="equation-5c122083-3d0b-458f-ab62-a5ccc5cd0543">
<span class="eqno">(54)<a class="headerlink" href="#equation-5c122083-3d0b-458f-ab62-a5ccc5cd0543" title="Permalink to this equation">¶</a></span>\[\begin{align}
  \underset{F}{\min} h(S=S^* = \underset{S \geq 0}{\arg\min}\,\mu, d=\tilde{d}) &amp;= \underset{F}{\min} \sum^N_{i=1} h_i F_{B_i E_i} + \sum^N_{i=1} \sum^N_{j=1} c_{ij} F_{B_i M_j} + \sum^N_i p_i F_{RM_i} \\
  \text{subject to } &amp;S_i = F_{B_i M_i} + \sum^N_{j =1 \\ i \not= 1} F_{B_i M_j} + F_{B_i E_i}\qquad i = 1, \cdots , N, \\
  &amp;F_{B_i M_i} + \sum^N_{j = 1 \\ j \not= i} F_{B_j M_i} + F_{RM_i} = {d}_i\qquad i = 1, \cdots , N, \\
  &amp;\sum^N_{i=1} {d}_i = \sum^N_{i=1} F_{RM_i} + \sum^N_{i = 1} F_{RE_i}, \\
  &amp;F_{B_i E_i} + F_{RE_i} = S_i\qquad i = 1, \cdots , N, \\
  &amp;F_{B_i E_i}, F_{B_i M_j}, F_{RM_i}, F_{RE_i} \geq 0\qquad i = 1, \cdots , N, \\
  &amp;j = 1, \cdots , N.
\end{align}\]</div>
<p>Sp:</p>
<div class="amsmath math notranslate nohighlight" id="equation-ce9a290c-1616-4313-a63e-6eee02c12844">
<span class="eqno">(55)<a class="headerlink" href="#equation-ce9a290c-1616-4313-a63e-6eee02c12844" title="Permalink to this equation">¶</a></span>\[\begin{align}
  h_s(x) &amp;= \underset{y_s}{\min} d^\top y_s \\
  \text{subject to } Dy_s &amp;= \xi_s - C_s x \\
  y_s &amp;\geq 0 \\
\end{align}\]</div>
<p>Dual Sp:</p>
<div class="amsmath math notranslate nohighlight" id="equation-3cb7c030-17f4-49b0-b66b-df8a4dc06707">
<span class="eqno">(56)<a class="headerlink" href="#equation-3cb7c030-17f4-49b0-b66b-df8a4dc06707" title="Permalink to this equation">¶</a></span>\[\begin{align}
  \underset{\pi_s, \lambda_s}{\max} &amp; \left[\xi_s - C_s x\right]^\top \left(\pi_s, \lambda_s\right) \\
  \text{subject to } &amp; \pi_s \text{ free} \\
  &amp; \lambda_s \geq 0 \\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Benders</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">first_stage_constraints</span><span class="p">,</span> <span class="n">s_gen</span><span class="p">,</span> <span class="n">ε</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The Bender&#39;s method implemented here</span>
<span class="sd">        is used to optimize the Two-Stage Stochastic Linear Program</span>
<span class="sd">        with second-stage variables following a discrete distribution</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>  <span class="c1"># First-stage decision coefficient</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_stage_constraints</span> <span class="o">=</span> <span class="n">first_stage_constraints</span>  <span class="c1"># Function that gives a list of the constraints for first-stage problem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s_gen</span> <span class="o">=</span> <span class="n">s_gen</span>  <span class="c1"># Function to generate scenario specific entities</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ε</span> <span class="o">=</span> <span class="n">ε</span>  <span class="c1"># Tolerance between Upper Bound and Lower Bound</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log</span>  <span class="c1"># Whether or not to log progress</span>

    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Solves the Two-stage Stochastic Optimization&quot;&quot;&quot;</span>
        <span class="c1"># 1. Initialize UB = infinity, LB = -infinity</span>
        <span class="n">UB</span><span class="p">,</span> <span class="n">LB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">nonneg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># First-stage decision variables</span>

        <span class="c1"># Master Problem</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nonneg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">MP_obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="c1"># Bender cuts that we will be adding to the master problem</span>
        <span class="n">cuts</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">first_stage_constraints</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_stage_constraints</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="p">[]</span>
        <span class="p">)</span>

        <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># 2. While UB - LB &gt; ε, we will continue adding cuts</span>
        <span class="k">while</span> <span class="n">UB</span> <span class="o">-</span> <span class="n">LB</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ε</span><span class="p">:</span>

            <span class="n">expected_h</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">α</span><span class="p">,</span> <span class="n">β</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>  <span class="c1"># Hyperplane of cut coefficients</span>

            <span class="c1"># Go through all the scenarios possible</span>
            <span class="k">for</span> <span class="n">p_s</span><span class="p">,</span> <span class="n">d_s</span><span class="p">,</span> <span class="n">C_s</span><span class="p">,</span> <span class="n">D_s</span><span class="p">,</span> <span class="n">ξ_s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_gen</span><span class="p">():</span>

                <span class="c1"># 3a. Solve the Dual of the Sub-problem for all combinations of demand \tilde{d}</span>
                <span class="c1"># [Equivalent to solving primal since LPs have 0 duality gap]</span>
                <span class="n">π_optimal</span><span class="p">,</span> <span class="n">h_dual_optimal</span><span class="p">,</span> <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second_stage</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d_s</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="n">C_s</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D_s</span><span class="p">,</span> <span class="n">ξ</span><span class="o">=</span><span class="n">ξ_s</span>
                <span class="p">)</span>

                <span class="c1">#                 # 4a. If dual variables are unbounded, add cut</span>
                <span class="c1">#                 if status == &quot;infeasible&quot;:</span>
                <span class="c1">#                     cuts += [(ξ_s - C_s @ x).T @ π_optimal &lt;= 0]</span>

                <span class="c1">#                 # 4b. Else set UB and add cut on first stage primal optimal value</span>
                <span class="c1">#                 else:</span>
                <span class="c1">#                     expected_h += p_s * h_dual_optimal</span>
                <span class="c1">#                     cuts += [z &gt;= (ξ_s - C_s @ x).T @ π_optimal]</span>

                <span class="n">expected_h</span> <span class="o">+=</span> <span class="n">p_s</span> <span class="o">*</span> <span class="n">h_dual_optimal</span>
                <span class="n">α</span> <span class="o">+=</span> <span class="n">p_s</span> <span class="o">*</span> <span class="n">ξ_s</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">π_optimal</span>
                <span class="n">β</span> <span class="o">+=</span> <span class="o">-</span><span class="n">p_s</span> <span class="o">*</span> <span class="n">C_s</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">π_optimal</span>

            <span class="c1"># 3b. Add a new halfspace constraint </span>
            <span class="n">cuts</span> <span class="o">+=</span> <span class="p">[</span><span class="n">z</span> <span class="o">&gt;=</span> <span class="n">α</span> <span class="o">+</span> <span class="n">β</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">x</span><span class="p">]</span>

            <span class="c1"># 4. Update UB</span>
            <span class="n">UB</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                <span class="n">UB</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">expected_h</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">expected_h</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># 5. Solve Master Problem</span>
            <span class="n">MP_prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">MP_obj</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">cuts</span><span class="p">)</span>
            <span class="n">MP_prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

            <span class="c1"># 6. Update LB</span>
            <span class="n">LB</span> <span class="o">=</span> <span class="n">MP_prob</span><span class="o">.</span><span class="n">value</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; Iteration </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Lower Bound:&quot;</span><span class="p">,</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">LB</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                    <span class="s2">&quot;|&quot;</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;Upper Bound:&quot;</span><span class="p">,</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">UB</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal primal objective of first stage problem: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">LB</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal first-stage decision variables: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of iterations for convergence: </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">LB</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="n">k</span>

    <span class="k">def</span> <span class="nf">second_stage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">ξ</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dual Form of Second-stage Optimization&quot;&quot;&quot;</span>

        <span class="n">π</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span>
            <span class="n">ξ</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">nonneg</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>  <span class="c1"># Second-stage dual variables are Free since they are dual of the equality constraints</span>
        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="n">D</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">π</span> <span class="o">&lt;=</span> <span class="n">d</span><span class="p">]</span>  <span class="c1"># Second-stage dual constraints</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span>
            <span class="p">(</span><span class="n">ξ</span> <span class="o">-</span> <span class="n">C</span> <span class="o">@</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">))</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">π</span>
        <span class="p">)</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">constraints</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">π</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">status</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="two-stage-multi-location-transshipment-problem">
<h2>4. Two-stage Multi-location Transshipment Problem<a class="headerlink" href="#two-stage-multi-location-transshipment-problem" title="Permalink to this headline">¶</a></h2>
<div class="section" id="problem-setup">
<h3>4.1. Problem Setup<a class="headerlink" href="#problem-setup" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id1">
<h4>4.1.1 First Stage Stochastic Linear Program<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>In the first stage problem, we want to figure out what the optimal order-up-to quantity <span class="math notranslate nohighlight">\(S\)</span> is. We formulate the first stage LP as follows, minimizing the expected (stochastic demand) transshipment cost with the order-up-to quantities <span class="math notranslate nohighlight">\(S\)</span> as our primal variables:</p>
<div class="amsmath math notranslate nohighlight" id="equation-4110bb3d-fcc9-4c91-b3b7-06738876fbfa">
<span class="eqno">(57)<a class="headerlink" href="#equation-4110bb3d-fcc9-4c91-b3b7-06738876fbfa" title="Permalink to this equation">¶</a></span>\[\begin{align}
\underset{S \geq 0}{\min}\,&amp; \mathbb{E}_{\tilde{d} \sim D}\left[h(S, d = \tilde{d})\right] \qquad \text{, where }D\text{ is the demand distribution} \\
\end{align}\]</div>
</div>
<div class="section" id="id2">
<h4>4.1.2 Second Stage Stochastic Linear Program<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>In our second stage problem, given a specific order-up-to quantity <span class="math notranslate nohighlight">\(\tilde{S}\)</span>, and a fixed demand <span class="math notranslate nohighlight">\(\tilde{d}\)</span>, we want to solve the following constrained linear program over the primal variables <span class="math notranslate nohighlight">\(F\)</span> (flow to and from each node), minimziing the transshipment cost for the specific instance of <span class="math notranslate nohighlight">\(\tilde{S}\)</span> and <span class="math notranslate nohighlight">\(\tilde{d}\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-e499579a-1f0f-47d3-8cea-5881754a6939">
<span class="eqno">(58)<a class="headerlink" href="#equation-e499579a-1f0f-47d3-8cea-5881754a6939" title="Permalink to this equation">¶</a></span>\[\begin{align}
    h(S = \tilde{S}, d=\tilde{d}) = \underset{F}{\min} &amp;\sum^N_{i=1} h_i F_{B_i E_i} + \sum^N_{i=1} \sum^N_{j=1} c_{ij} F_{B_i M_j} + \sum^N_i p_i F_{RM_i} \\
  \text{subject to } &amp; S_i = F_{B_i M_i} + \sum^N_{j =1 \\ i \not= 1} F_{B_i M_j} + F_{B_i E_i} \,\,\,\, i = 1, \cdots , N, \\
  &amp;F_{B_i M_i} + \sum^N_{j = 1 \\ j \not= i} F_{B_j M_i} + F_{RM_i} = {d}_i \,\,\,\, i = 1, \cdots , N, \\
  &amp;\sum^N_{i=1} {d}_i = \sum^N_{i=1} F_{RM_i} + \sum^N_{i = 1} F_{RE_i}, \\
  &amp;F_{B_i E_i} + F_{RE_i} = S_i \,\,\,\, i = 1, \cdots , N, \\
  &amp;F_{B_i E_i}, F_{B_i M_j}, F_{RM_i}, F_{RE_i} \geq 0 \,\,\,\, i = 1, \cdots , N, \\
  &amp;j = 1, \cdots , N.
\end{align}\]</div>
<p>Reformulate objective and constraints into standard form:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_transshipment_variables</span><span class="p">():</span>

    <span class="c1"># Number of retailers</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="c1"># Holding cost Vector</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span>

    <span class="c1"># Shortage cost Vector</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span>

    <span class="c1"># Cost of transshipment from retailer i to retailer j Matrix</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># PMF of Retailer Demand distribution</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.020</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.68</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.020</span><span class="p">])</span>

    <span class="c1"># Each Retailer&#39;s Demand distribution associated with probabilities above</span>
    <span class="n">RETAILER_DEMANDS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">210</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">270</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">N</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">RETAILER_DEMANDS</span>


<span class="k">def</span> <span class="nf">random_demand</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">retailer_demands</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Samples a random demand vector according to demand pmf</span>
<span class="sd">    parameters given</span>

<span class="sd">    Args:</span>
<span class="sd">        P (numpy.array): Array of probabilities for each demand, shape: (Number of probabilities)</span>
<span class="sd">        retailer_demands (numpy.array): Matrix of retailer demands, shape: (Number of retailers, Number of discrete demands)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[np.array, float]: A tuple of the (sampled Demand Vector, probability of the Sampled Demand Vector)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">P</span><span class="p">),</span> <span class="mi">1</span>
    <span class="p">),</span> <span class="s2">&quot;p must sum to 1 to be a valid probability distribution.&quot;</span>
    <span class="n">sampled_demand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">retailer_demand</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">retailer_demand</span> <span class="ow">in</span> <span class="n">retailer_demands</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">p_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">P</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">retailer_demand</span> <span class="o">==</span> <span class="n">D_i</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">for</span> <span class="n">retailer_demand</span><span class="p">,</span> <span class="n">D_i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">retailer_demands</span><span class="p">,</span> <span class="n">sampled_demand</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">sampled_demand</span><span class="p">,</span> <span class="n">p_s</span>


<span class="k">def</span> <span class="nf">get_second_stage_variables</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>

    <span class="n">N</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">RETAILER_DEMANDS</span> <span class="o">=</span> <span class="n">get_transshipment_variables</span><span class="p">()</span>

    <span class="c1"># Coefficient of Second-stage decision variables</span>
    <span class="n">d_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">h</span><span class="p">,</span>  <span class="c1"># Coefficient of Amount of inventory that moves from begining to ending (FBE)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>  <span class="c1"># Coefficient of Amount of inventory to ship from current retailer to other retailers (FBM)</span>
            <span class="n">p</span><span class="p">,</span>  <span class="c1"># Coefficient of Amount to ship from supplier to retailer&#39;s middle inventory (FRM)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span>
            <span class="p">),</span>  <span class="c1"># Coefficient of Amount to ship from supplier to retailer&#39;s ending inventory (FRE)</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Second-stage C(s) matrix</span>
    <span class="n">C_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">)),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Second-stage D(s) matrix</span>
    <span class="n">D_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))[</span><span class="o">-</span><span class="n">N</span> <span class="o">*</span> <span class="n">idx</span> <span class="p">:]</span>
                            <span class="o">+</span> <span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))[:</span> <span class="o">-</span><span class="n">N</span> <span class="o">*</span> <span class="n">idx</span><span class="p">]</span>
                            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
                        <span class="p">]</span>
                    <span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">)),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">)),</span>
                <span class="p">),</span>
                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">)),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                                <span class="p">[</span>
                                    <span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))[</span><span class="o">-</span><span class="n">idx</span><span class="p">:]</span>
                                    <span class="o">+</span> <span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))[:</span><span class="o">-</span><span class="n">idx</span><span class="p">]</span>
                                <span class="p">]</span>
                                <span class="o">*</span> <span class="n">N</span>
                            <span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
                        <span class="p">]</span>
                    <span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">)),</span>
                <span class="p">),</span>
                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span><span class="p">]),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span> <span class="o">*</span> <span class="n">N</span><span class="p">)),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">)),</span>
                    <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">),</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># ξ(s) vector</span>
    <span class="n">ξ_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
            <span class="n">s</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">s</span><span class="p">)]),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">d_s</span><span class="p">,</span> <span class="n">C_s</span><span class="p">,</span> <span class="n">D_s</span><span class="p">,</span> <span class="n">ξ_s</span>


<span class="k">def</span> <span class="nf">s_gen_sgd</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function that generates the scenario dependent</span>
<span class="sd">    second-stage variables by sampling demand</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">N</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">RETAILER_DEMANDS</span> <span class="o">=</span> <span class="n">get_transshipment_variables</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>

        <span class="c1"># Get Second-stage variables</span>
        <span class="n">s</span><span class="p">,</span> <span class="n">p_s</span> <span class="o">=</span> <span class="n">random_demand</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">retailer_demands</span><span class="o">=</span><span class="n">RETAILER_DEMANDS</span><span class="p">)</span>

        <span class="c1"># Get scenario-dependent variables</span>
        <span class="n">d_s</span><span class="p">,</span> <span class="n">C_s</span><span class="p">,</span> <span class="n">D_s</span><span class="p">,</span> <span class="n">ξ_s</span> <span class="o">=</span> <span class="n">get_second_stage_variables</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

        <span class="k">yield</span> <span class="n">p_s</span><span class="p">,</span> <span class="n">d_s</span><span class="p">,</span> <span class="n">C_s</span><span class="p">,</span> <span class="n">D_s</span><span class="p">,</span> <span class="n">ξ_s</span>


<span class="k">def</span> <span class="nf">s_gen_benders</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Function that generates the scenario dependent</span>
<span class="sd">    second-stage variables by enumerating all combinations of demand</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">N</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">RETAILER_DEMANDS</span> <span class="o">=</span> <span class="n">get_transshipment_variables</span><span class="p">()</span>

    <span class="c1"># Get Second-stage variables</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">RETAILER_DEMANDS</span><span class="p">):</span>

        <span class="n">p_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">P</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">retailer_demand</span> <span class="o">==</span> <span class="n">D_i</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">for</span> <span class="n">retailer_demand</span><span class="p">,</span> <span class="n">D_i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">RETAILER_DEMANDS</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># Get scenario-dependent variables</span>
        <span class="n">d_s</span><span class="p">,</span> <span class="n">C_s</span><span class="p">,</span> <span class="n">D_s</span><span class="p">,</span> <span class="n">ξ_s</span> <span class="o">=</span> <span class="n">get_second_stage_variables</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

        <span class="k">yield</span> <span class="n">p_s</span><span class="p">,</span> <span class="n">d_s</span><span class="p">,</span> <span class="n">C_s</span><span class="p">,</span> <span class="n">D_s</span><span class="p">,</span> <span class="n">ξ_s</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="stochastic-gradient-descent">
<h3>4.2. Stochastic Gradient Descent<a class="headerlink" href="#stochastic-gradient-descent" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sgd</span> <span class="o">=</span> <span class="n">StochasticGradientDescent</span><span class="p">(</span>
    <span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
    <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
    <span class="n">first_stage_constraints</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">s_gen</span><span class="o">=</span><span class="n">s_gen_sgd</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">α</span><span class="o">=</span><span class="mf">1e-01</span><span class="p">,</span>
    <span class="n">ε</span><span class="o">=</span><span class="mf">1e-01</span>
<span class="p">)</span>

<span class="n">sgd</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==================== Iteration 0====================
Current Primal Objective Found: 15740.704 | Best Primal Objective Found: inf
==================== Iteration 50====================
Current Primal Objective Found: 2404.495 | Best Primal Objective Found: 2729.085
==================== Iteration 100====================
Current Primal Objective Found: 289.641 | Best Primal Objective Found: 264.472
==================== Iteration 150====================
Current Primal Objective Found: 262.191 | Best Primal Objective Found: 229.16
==================== Iteration 200====================
Current Primal Objective Found: 292.347 | Best Primal Objective Found: 197.497
==================== Iteration 250====================
Current Primal Objective Found: 290.276 | Best Primal Objective Found: 197.497
==================== Iteration 300====================
Current Primal Objective Found: 177.405 | Best Primal Objective Found: 167.574
==================== Iteration 350====================
Current Primal Objective Found: 165.722 | Best Primal Objective Found: 156.476
==================== Iteration 400====================
Current Primal Objective Found: 182.0 | Best Primal Objective Found: 130.407
==================== Iteration 450====================
Current Primal Objective Found: 199.385 | Best Primal Objective Found: 130.407
Early Stopping condition satisfied.
Optimal primal objective of first stage problem: 130.407
Optimal first-stage decision variables: [100.661 200.54  150.724 170.486]
Number of iterations for convergence: 499
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(130.407359788351,
 array([100.66088181, 200.53971283, 150.72409382, 170.48564625]),
 499)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="benders">
<h3>4.3. Benders<a class="headerlink" href="#benders" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">benders</span> <span class="o">=</span> <span class="n">Benders</span><span class="p">(</span>
    <span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
    <span class="n">first_stage_constraints</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">s_gen</span><span class="o">=</span><span class="n">s_gen_benders</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">benders</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==================== Iteration 0====================
Lower Bound: 0.0 | Upper Bound: 2480.0
==================== Iteration 1====================
Lower Bound: 0.0 | Upper Bound: 1041.897
==================== Iteration 2====================
Lower Bound: 0.0 | Upper Bound: 115.972
==================== Iteration 3====================
Lower Bound: 0.0 | Upper Bound: 115.972
==================== Iteration 4====================
Lower Bound: 0.0 | Upper Bound: 115.972
==================== Iteration 5====================
Lower Bound: 48.645 | Upper Bound: 115.972
==================== Iteration 6====================
Lower Bound: 49.022 | Upper Bound: 115.972
==================== Iteration 7====================
Lower Bound: 51.52 | Upper Bound: 115.972
==================== Iteration 8====================
Lower Bound: 66.869 | Upper Bound: 92.555
==================== Iteration 9====================
Lower Bound: 67.483 | Upper Bound: 92.555
==================== Iteration 10====================
Lower Bound: 70.326 | Upper Bound: 92.555
==================== Iteration 11====================
Lower Bound: 71.874 | Upper Bound: 82.007
==================== Iteration 12====================
Lower Bound: 73.429 | Upper Bound: 82.007
==================== Iteration 13====================
Lower Bound: 79.194 | Upper Bound: 80.918
==================== Iteration 14====================
Lower Bound: 79.771 | Upper Bound: 80.918
==================== Iteration 15====================
Lower Bound: 80.473 | Upper Bound: 80.918
==================== Iteration 16====================
Lower Bound: 80.523 | Upper Bound: 80.918
==================== Iteration 17====================
Lower Bound: 80.523 | Upper Bound: 80.523
Optimal primal objective of first stage problem: 80.523
Optimal first-stage decision variables: [108.508 214.065 159.724 187.702]
Number of iterations for convergence: 18
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(80.52286246994309,
 array([108.50808924, 214.06507897, 159.7243887 , 187.70244296]),
 18)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="stochastic-gradient-descent-vs-benders">
<h3>4.4. Stochastic Gradient Descent Vs. Benders<a class="headerlink" href="#stochastic-gradient-descent-vs-benders" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_experiment_sgd</span><span class="p">(</span><span class="n">n_scenario</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">ε</span><span class="p">):</span>

    <span class="n">optimal_obj_val</span><span class="p">,</span> <span class="n">optimal_order_up_to_quantity</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">StochasticGradientDescent</span><span class="p">(</span>
        <span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
        <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
        <span class="n">first_stage_constraints</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">s_gen</span><span class="o">=</span><span class="n">s_gen_sgd</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="n">n_scenario</span><span class="p">,</span>
        <span class="n">α</span><span class="o">=</span><span class="n">α</span><span class="p">,</span>
        <span class="n">ε</span><span class="o">=</span><span class="n">ε</span><span class="p">,</span>
        <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">optimal_obj_val</span><span class="p">,</span> <span class="n">optimal_order_up_to_quantity</span><span class="p">,</span> <span class="n">k</span>


<span class="k">def</span> <span class="nf">run_experiment_grid_sgd</span><span class="p">(</span>
    <span class="n">n_experiments</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_scenarios</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="n">αs</span><span class="o">=</span><span class="p">[</span><span class="mf">1e0</span><span class="p">,</span> <span class="mf">1e-01</span><span class="p">,</span> <span class="mf">1e-02</span><span class="p">],</span> <span class="n">εs</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-03</span><span class="p">,</span> <span class="mf">1e-04</span><span class="p">,</span> <span class="mf">1e-05</span><span class="p">]</span>
<span class="p">):</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">n_scenario</span> <span class="ow">in</span> <span class="n">n_scenarios</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">α</span> <span class="ow">in</span> <span class="n">αs</span><span class="p">:</span>
            
            <span class="k">for</span> <span class="n">ε</span> <span class="ow">in</span> <span class="n">εs</span><span class="p">:</span>

                <span class="p">(</span>
                    <span class="n">optimal_obj_vals_sgd</span><span class="p">,</span>
                    <span class="n">optimal_order_up_to_quantities_sgd</span><span class="p">,</span>
                    <span class="n">n_iterations_sgd</span><span class="p">,</span>
                    <span class="n">experiment_times</span><span class="p">,</span>
                <span class="p">)</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[])</span>

                <span class="c1"># Run Experiments</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_experiments</span><span class="p">):</span>

                    <span class="k">if</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Experimenting with n_scenario=</span><span class="si">{</span><span class="n">n_scenario</span><span class="si">}</span><span class="s2"> | α=</span><span class="si">{</span><span class="n">α</span><span class="si">}</span><span class="s2"> | ε=</span><span class="si">{</span><span class="n">ε</span><span class="si">}</span><span class="s2"> | k=</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">...&quot;</span>
                        <span class="p">)</span>

                    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                    <span class="n">optimal_obj_val</span><span class="p">,</span> <span class="n">optimal_order_up_to_quantity</span><span class="p">,</span> <span class="n">n_iterations</span> <span class="o">=</span> <span class="n">run_experiment_sgd</span><span class="p">(</span>
                        <span class="n">n_scenario</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">ε</span>
                    <span class="p">)</span>
                    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

                    <span class="n">optimal_obj_vals_sgd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optimal_obj_val</span><span class="p">)</span>
                    <span class="n">optimal_order_up_to_quantities_sgd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optimal_order_up_to_quantity</span><span class="p">)</span>
                    <span class="n">n_iterations_sgd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">)</span>
                    <span class="n">experiment_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>

                <span class="n">optimal_obj_vals_sgd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">optimal_obj_vals_sgd</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">optimal_order_up_to_quantities_sgd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="n">optimal_order_up_to_quantities_sgd</span>
                <span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">n_iterations_sgd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">n_iterations_sgd</span><span class="p">)</span>
                <span class="n">experiment_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">experiment_times</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">n_scenario</span><span class="p">,</span>
                        <span class="n">α</span><span class="p">,</span>
                        <span class="n">ε</span><span class="p">,</span>
                        <span class="n">optimal_obj_vals_sgd</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">optimal_obj_vals_sgd</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">optimal_obj_vals_sgd</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">optimal_obj_vals_sgd</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">optimal_order_up_to_quantities_sgd</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">optimal_order_up_to_quantities_sgd</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">optimal_order_up_to_quantities_sgd</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">optimal_order_up_to_quantities_sgd</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">n_iterations_sgd</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">n_iterations_sgd</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">n_iterations_sgd</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">n_iterations_sgd</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">experiment_times</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">experiment_times</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">experiment_times</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">experiment_times</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="p">)</span>

                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                    <span class="n">results</span><span class="p">,</span>
                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
                        <span class="s2">&quot;Number of Scenarios&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Learning rate α&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Tolerance for Subgradient Early Stopping ε&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Mean(Objective Value)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Std(Objective Value)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Max(Objective Value)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Min(Objective Value)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Mean(Optimal Order-Up-To Quantitites)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Std(Optimal Order-Up-To Quantitites)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Max(Optimal Order-Up-To Quantitites)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Min(Optimal Order-Up-To Quantitites)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Mean(Number of Iterations)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Std(Number of Iterations)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Max(Number of Iterations)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Min(Number of Iterations)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Mean(Experiment Times)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Std(Experiment Times)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Max(Experiment Times)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Min(Experiment Times)&quot;</span><span class="p">,</span>
                    <span class="p">],</span>
                <span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;sgd_results.csv&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">results</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
            <span class="s2">&quot;Number of Scenarios&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Learning rate α&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Tolerance for Subgradient Early Stopping ε&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Mean(Objective Value)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Std(Objective Value)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Max(Objective Value)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Min(Objective Value)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Mean(Optimal Order-Up-To Quantitites)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Std(Optimal Order-Up-To Quantitites)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Max(Optimal Order-Up-To Quantitites)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Min(Optimal Order-Up-To Quantitites)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Mean(Number of Iterations)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Std(Number of Iterations)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Max(Number of Iterations)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Min(Number of Iterations)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Mean(Experiment Times)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Std(Experiment Times)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Max(Experiment Times)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Min(Experiment Times)&quot;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">)</span>


<span class="n">sgd_results</span> <span class="o">=</span> <span class="n">run_experiment_grid_sgd</span><span class="p">(</span>
    <span class="n">n_experiments</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_scenarios</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="n">αs</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-01</span><span class="p">],</span> <span class="n">εs</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-01</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">sgd_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Experimenting with n_scenario=10 | α=0.1 | ε=0.1 | k=0...
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Experimenting with n_scenario=10 | α=0.1 | ε=0.1 | k=10...
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Experimenting with n_scenario=10 | α=0.1 | ε=0.1 | k=20...
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Experimenting with n_scenario=10 | α=0.1 | ε=0.1 | k=30...
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Experimenting with n_scenario=10 | α=0.1 | ε=0.1 | k=40...
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Experimenting with n_scenario=10 | α=0.1 | ε=0.1 | k=50...
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Experimenting with n_scenario=10 | α=0.1 | ε=0.1 | k=60...
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Experimenting with n_scenario=10 | α=0.1 | ε=0.1 | k=70...
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Experimenting with n_scenario=10 | α=0.1 | ε=0.1 | k=80...
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Experimenting with n_scenario=10 | α=0.1 | ε=0.1 | k=90...
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Experimenting with n_scenario=50 | α=0.1 | ε=0.1 | k=0...
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
Early Stopping condition satisfied.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./sgd_results.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Number of Scenarios</th>
      <th>Learning rate α</th>
      <th>Tolerance for Subgradient Early Stopping ε</th>
      <th>Mean(Objective Value)</th>
      <th>Std(Objective Value)</th>
      <th>Max(Objective Value)</th>
      <th>Min(Objective Value)</th>
      <th>Mean(Optimal Order-Up-To Quantitites)</th>
      <th>Std(Optimal Order-Up-To Quantitites)</th>
      <th>Max(Optimal Order-Up-To Quantitites)</th>
      <th>Min(Optimal Order-Up-To Quantitites)</th>
      <th>Mean(Number of Iterations)</th>
      <th>Std(Number of Iterations)</th>
      <th>Max(Number of Iterations)</th>
      <th>Min(Number of Iterations)</th>
      <th>Mean(Experiment Times)</th>
      <th>Std(Experiment Times)</th>
      <th>Max(Experiment Times)</th>
      <th>Min(Experiment Times)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>16.5198</td>
      <td>6.759651</td>
      <td>55.55</td>
      <td>8.53</td>
      <td>[148.4059 157.5988 154.6814 157.4469]</td>
      <td>[1.96487307 2.73314115 2.02832641 2.73398928]</td>
      <td>[150.08 162.47 156.3  162.31]</td>
      <td>[138.58 144.07 143.93 143.92]</td>
      <td>684.31</td>
      <td>78.390267</td>
      <td>980</td>
      <td>560</td>
      <td>28.8340</td>
      <td>3.309319</td>
      <td>41.45</td>
      <td>23.71</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>53.6970</td>
      <td>4.858717</td>
      <td>64.30</td>
      <td>43.98</td>
      <td>[100.6798 200.597  150.6084 170.606 ]</td>
      <td>[0.37629504 0.35315011 0.34831227 0.34898424]</td>
      <td>[101.65 201.48 151.52 171.53]</td>
      <td>[100.02 200.01 150.02 170.03]</td>
      <td>786.58</td>
      <td>40.985163</td>
      <td>915</td>
      <td>729</td>
      <td>166.0559</td>
      <td>8.613365</td>
      <td>193.08</td>
      <td>153.22</td>
    </tr>
    <tr>
      <th>2</th>
      <td>100</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>127.4597</td>
      <td>9.509603</td>
      <td>152.36</td>
      <td>103.51</td>
      <td>[101.2032 201.0891 151.1315 171.1326]</td>
      <td>[0.74875481 0.63293459 0.63881668 0.62607926]</td>
      <td>[104.29 202.48 152.68 172.56]</td>
      <td>[100.04 200.01 150.03 170.04]</td>
      <td>598.64</td>
      <td>205.785933</td>
      <td>1469</td>
      <td>360</td>
      <td>253.2370</td>
      <td>87.046833</td>
      <td>620.72</td>
      <td>152.10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_experiment_grid_benders</span><span class="p">(</span><span class="n">n_experiments</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="p">(</span>
        <span class="n">optimal_obj_vals_benders</span><span class="p">,</span>
        <span class="n">optimal_order_up_to_quantities_benders</span><span class="p">,</span>
        <span class="n">n_iterations_benders</span><span class="p">,</span>
        <span class="n">experiment_times</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[])</span>

    <span class="c1"># Run Experiments</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_experiments</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Experimenting with k=</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">optimal_obj_val</span><span class="p">,</span> <span class="n">optimal_order_up_to_quantity</span><span class="p">,</span> <span class="n">n_iterations</span> <span class="o">=</span> <span class="n">Benders</span><span class="p">(</span>
            <span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
            <span class="n">first_stage_constraints</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">s_gen</span><span class="o">=</span><span class="n">s_gen_benders</span><span class="p">,</span>
            <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="n">optimal_obj_vals_benders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optimal_obj_val</span><span class="p">)</span>
        <span class="n">optimal_order_up_to_quantities_benders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optimal_order_up_to_quantity</span><span class="p">)</span>
        <span class="n">n_iterations_benders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">)</span>
        <span class="n">experiment_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>

    <span class="n">optimal_obj_vals_benders</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">optimal_obj_vals_benders</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">optimal_order_up_to_quantities_benders</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="n">optimal_order_up_to_quantities_benders</span>
    <span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">n_iterations_benders</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">n_iterations_benders</span><span class="p">)</span>
    <span class="n">experiment_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">experiment_times</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="mi">5</span> <span class="o">**</span> <span class="mi">4</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="n">optimal_obj_vals_benders</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">optimal_obj_vals_benders</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">optimal_obj_vals_benders</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">optimal_obj_vals_benders</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">optimal_order_up_to_quantities_benders</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">optimal_order_up_to_quantities_benders</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">optimal_order_up_to_quantities_benders</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">optimal_order_up_to_quantities_benders</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">n_iterations_benders</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">n_iterations_benders</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">n_iterations_benders</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">n_iterations_benders</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">experiment_times</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">experiment_times</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">experiment_times</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">experiment_times</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">results</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
            <span class="s2">&quot;Number of Scenarios&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Number of Iterations&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Mean(Objective Value)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Std(Objective Value)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Max(Objective Value)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Min(Objective Value)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Mean(Optimal Order-Up-To Quantitites)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Std(Optimal Order-Up-To Quantitites)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Max(Optimal Order-Up-To Quantitites)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Min(Optimal Order-Up-To Quantitites)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Mean(Number of Iterations)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Std(Number of Iterations)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Max(Number of Iterations)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Min(Number of Iterations)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Mean(Experiment Times)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Std(Experiment Times)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Max(Experiment Times)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Min(Experiment Times)&quot;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">)</span>


<span class="n">benders_results</span> <span class="o">=</span> <span class="n">run_experiment_grid_benders</span><span class="p">(</span><span class="n">n_experiments</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">benders_results</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;benders_results.csv&quot;</span><span class="p">)</span>
<span class="n">benders_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Experimenting with k=0...
Experimenting with k=10...
Experimenting with k=20...
Experimenting with k=30...
Experimenting with k=40...
Experimenting with k=50...
Experimenting with k=60...
Experimenting with k=70...
Experimenting with k=80...
Experimenting with k=90...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Number of Scenarios</th>
      <th>Number of Iterations</th>
      <th>Mean(Objective Value)</th>
      <th>Std(Objective Value)</th>
      <th>Max(Objective Value)</th>
      <th>Min(Objective Value)</th>
      <th>Mean(Optimal Order-Up-To Quantitites)</th>
      <th>Std(Optimal Order-Up-To Quantitites)</th>
      <th>Max(Optimal Order-Up-To Quantitites)</th>
      <th>Min(Optimal Order-Up-To Quantitites)</th>
      <th>Mean(Number of Iterations)</th>
      <th>Std(Number of Iterations)</th>
      <th>Max(Number of Iterations)</th>
      <th>Min(Number of Iterations)</th>
      <th>Mean(Experiment Times)</th>
      <th>Std(Experiment Times)</th>
      <th>Max(Experiment Times)</th>
      <th>Min(Experiment Times)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>625</td>
      <td>1</td>
      <td>80.52</td>
      <td>1.421085e-14</td>
      <td>80.52</td>
      <td>80.52</td>
      <td>[108.51000000000016, 214.0699999999998, 159.71...</td>
      <td>[1.5631940186722204e-13, 1.9895196601282805e-1...</td>
      <td>[108.51, 214.07, 159.72, 187.7]</td>
      <td>[108.51, 214.07, 159.72, 187.7]</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>18</td>
      <td>18</td>
      <td>38.7504</td>
      <td>0.110408</td>
      <td>39.2</td>
      <td>38.53</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="comparing-mean-optimal-order-up-to-quantities">
<h4>4.4.1 Comparing Mean(Optimal Order-Up-To Quantities)<a class="headerlink" href="#comparing-mean-optimal-order-up-to-quantities" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_colwidth</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./sgd_results.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Number of Scenarios</th>
      <th>Learning rate α</th>
      <th>Tolerance for Subgradient Early Stopping ε</th>
      <th>Mean(Objective Value)</th>
      <th>Std(Objective Value)</th>
      <th>Max(Objective Value)</th>
      <th>Min(Objective Value)</th>
      <th>Mean(Optimal Order-Up-To Quantitites)</th>
      <th>Std(Optimal Order-Up-To Quantitites)</th>
      <th>Max(Optimal Order-Up-To Quantitites)</th>
      <th>Min(Optimal Order-Up-To Quantitites)</th>
      <th>Mean(Number of Iterations)</th>
      <th>Std(Number of Iterations)</th>
      <th>Max(Number of Iterations)</th>
      <th>Min(Number of Iterations)</th>
      <th>Mean(Experiment Times)</th>
      <th>Std(Experiment Times)</th>
      <th>Max(Experiment Times)</th>
      <th>Min(Experiment Times)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>16.5198</td>
      <td>6.759651</td>
      <td>55.55</td>
      <td>8.53</td>
      <td>[148.4059 157.5988 154.6814 157.4469]</td>
      <td>[1.96487307 2.73314115 2.02832641 2.73398928]</td>
      <td>[150.08 162.47 156.3  162.31]</td>
      <td>[138.58 144.07 143.93 143.92]</td>
      <td>684.31</td>
      <td>78.390267</td>
      <td>980</td>
      <td>560</td>
      <td>28.8340</td>
      <td>3.309319</td>
      <td>41.45</td>
      <td>23.71</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>53.6970</td>
      <td>4.858717</td>
      <td>64.30</td>
      <td>43.98</td>
      <td>[100.6798 200.597  150.6084 170.606 ]</td>
      <td>[0.37629504 0.35315011 0.34831227 0.34898424]</td>
      <td>[101.65 201.48 151.52 171.53]</td>
      <td>[100.02 200.01 150.02 170.03]</td>
      <td>786.58</td>
      <td>40.985163</td>
      <td>915</td>
      <td>729</td>
      <td>166.0559</td>
      <td>8.613365</td>
      <td>193.08</td>
      <td>153.22</td>
    </tr>
    <tr>
      <th>2</th>
      <td>100</td>
      <td>0.1</td>
      <td>0.1</td>
      <td>127.4597</td>
      <td>9.509603</td>
      <td>152.36</td>
      <td>103.51</td>
      <td>[101.2032 201.0891 151.1315 171.1326]</td>
      <td>[0.74875481 0.63293459 0.63881668 0.62607926]</td>
      <td>[104.29 202.48 152.68 172.56]</td>
      <td>[100.04 200.01 150.03 170.04]</td>
      <td>598.64</td>
      <td>205.785933</td>
      <td>1469</td>
      <td>360</td>
      <td>253.2370</td>
      <td>87.046833</td>
      <td>620.72</td>
      <td>152.10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./benders_results.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Number of Scenarios</th>
      <th>Number of Iterations</th>
      <th>Mean(Objective Value)</th>
      <th>Std(Objective Value)</th>
      <th>Max(Objective Value)</th>
      <th>Min(Objective Value)</th>
      <th>Mean(Optimal Order-Up-To Quantitites)</th>
      <th>Std(Optimal Order-Up-To Quantitites)</th>
      <th>Max(Optimal Order-Up-To Quantitites)</th>
      <th>Min(Optimal Order-Up-To Quantitites)</th>
      <th>Mean(Number of Iterations)</th>
      <th>Std(Number of Iterations)</th>
      <th>Max(Number of Iterations)</th>
      <th>Min(Number of Iterations)</th>
      <th>Mean(Experiment Times)</th>
      <th>Std(Experiment Times)</th>
      <th>Max(Experiment Times)</th>
      <th>Min(Experiment Times)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>625</td>
      <td>1</td>
      <td>80.52</td>
      <td>1.421085e-14</td>
      <td>80.52</td>
      <td>80.52</td>
      <td>[108.51 214.07 159.72 187.7 ]</td>
      <td>[1.56319402e-13 1.98951966e-13 2.84217094e-13 ...</td>
      <td>[108.51 214.07 159.72 187.7 ]</td>
      <td>[108.51 214.07 159.72 187.7 ]</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>18</td>
      <td>18</td>
      <td>38.7504</td>
      <td>0.110408</td>
      <td>39.2</td>
      <td>38.53</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="conclusion">
<h4>4.4.2 Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h4>
<p>We observe that benders goes through fewer iterations, and overall has a more accurate result.</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-env-ml-py"
        },
        kernelOptions: {
            kernelName: "conda-env-ml-py",
            path: "./course-work/ise-533"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-env-ml-py'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="project1.html" title="previous page">Project 1: Group Restaurants Choice</a>
    <a class='right-next' id="next-link" href="../ise-537/intro.html" title="next page">ISE-537: Financial Analytics</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Chengyi (Jeff) Chen<br/>
        
            &copy; Copyright 2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>